<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The GenJAX cookbook - 2&nbsp; Generative functions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./inference_libraries.html" rel="next">
<link href="./index.html" rel="prev">
<link href="./small_logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Generative functions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./small_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The GenJAX cookbook</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/probcomp/genjax/tree/main/notebooks/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Generative functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Standard inference libraries</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#generative-functions" id="toc-generative-functions" class="nav-link active" data-scroll-target="#generative-functions"><span class="header-section-number">2.1</span> Generative functions</a></li>
  <li><a href="#composition-of-generative-functions" id="toc-composition-of-generative-functions" class="nav-link" data-scroll-target="#composition-of-generative-functions"><span class="header-section-number">2.2</span> Composition of generative functions</a></li>
  <li><a href="#inference-in-generative-functions" id="toc-inference-in-generative-functions" class="nav-link" data-scroll-target="#inference-in-generative-functions"><span class="header-section-number">2.3</span> Inference in generative functions</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/probcomp/genjax/edit/main/notebooks/intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/probcomp/genjax/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/probcomp/genjax/blob/main/notebooks/intro.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Generative functions</span></h1>
<p class="subtitle lead">Morning coffee &amp; steps from the machine learning base camp</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>GenJAX is a swiss army knife for probabilistic machine learning: it’s designed to support probabilistic modeling workflows via concise idioms, and to the resulting code extremely fast and parallelizable via JAX.</p>
<p>In this introduction, we’ll focus on one such workflow: writing a latent variable model (we often say: a generative model) which describes a probability distribution over latent variables and data, and then asking questions about the conditional distribution over the latent variables given data.</p>
<p>In the following, we’ll often shorten GenJAX to Gen – because <a href="https://www.gen.dev/">GenJAX implements Gen</a>.</p>
<div id="33bf0bd3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> genjax</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> genjax <span class="im">import</span> pretty</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> genjax <span class="im">import</span> gen, normal</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> jax <span class="im">import</span> random <span class="im">as</span> jrand</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> jax <span class="im">import</span> vmap, jit</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">'svg'</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>pretty() <span class="co"># pretty print the types</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generative-functions" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="generative-functions"><span class="header-section-number">2.1</span> Generative functions</h2>
<div id="e36a23d5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="at">@gen</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model():</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> normal(<span class="fl">0.0</span>, <span class="fl">1.0</span>) <span class="op">@</span> <span class="st">"x"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> normal(x, <span class="fl">1.0</span>) <span class="op">@</span> <span class="st">"y"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="output_2a8d9a9a2aa04eb5bde3b4a38a35ce90"><script> /* penzai.treescope rendering of a Python object (compressed) */ (()=>{ let observer; let lastStep = new Promise((resolve, reject) => { observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); }); window.treescope_decompress_enqueue = (encoded, destId) => { const previous = lastStep; const destElt = document.getElementById(destId); lastStep = (async () => { await previous; let blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); let reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); let parts = []; while (true) { let step = await reader.read(); if (step.done) { break; } parts.push(step.value); } let newElt = document.createElement("div"); newElt.innerHTML = parts.join(""); destElt.parentNode.replaceChild(newElt, destElt); for (let oldScript of newElt.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } })(); requestAnimationFrame(() => { observer.observe(destElt); }); } })(); </script><div id="compress_html_a3a4c8bba2b046b0853e808a9975221e"><script>window.treescope_decompress_enqueue("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", "compress_html_a3a4c8bba2b046b0853e808a9975221e");</script><span style="color: #aaaaaa; font-family: monospace">(Loading...)</span></div></div>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div id="output_dest_2a8d9a9a2aa04eb5bde3b4a38a35ce90"><script> (()=>{ const output = document.getElementById("output_2a8d9a9a2aa04eb5bde3b4a38a35ce90"); const dest = document.getElementById("output_dest_2a8d9a9a2aa04eb5bde3b4a38a35ce90"); dest.parentNode.replaceChild(output, dest); })(); </script></div>
</div>
</div>
<p>In Gen, probabilistic models are represented by a computational object called <em>a generative function</em>. Once we create one of these objects, we can use one of several interfaces to gain access to probabilistic effects.</p>
<p>Here’s one interface: <code>simulate</code> – this samples from the probability distribution which the program represents, and stores the result, along with other data about the invocation of the function, in a data structure called a <code>Trace</code>.</p>
<div id="f4767867" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>key <span class="op">=</span> jrand.PRNGKey(<span class="dv">0</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> model.simulate(key, ())</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>tr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="output_b2bb272d9df04c449c5b2001803e61fd"><script> /* penzai.treescope rendering of a Python object (compressed) */ (()=>{ let observer; let lastStep = new Promise((resolve, reject) => { observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); }); window.treescope_decompress_enqueue = (encoded, destId) => { const previous = lastStep; const destElt = document.getElementById(destId); lastStep = (async () => { await previous; let blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); let reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); let parts = []; while (true) { let step = await reader.read(); if (step.done) { break; } parts.push(step.value); } let newElt = document.createElement("div"); newElt.innerHTML = parts.join(""); destElt.parentNode.replaceChild(newElt, destElt); for (let oldScript of newElt.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } })(); requestAnimationFrame(() => { observer.observe(destElt); }); } })(); </script><div id="compress_html_9e76102b590a4ed5a240bbe71626ff21"><script>window.treescope_decompress_enqueue("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", "compress_html_9e76102b590a4ed5a240bbe71626ff21");</script><span style="color: #aaaaaa; font-family: monospace">(Loading...)</span></div></div>
</div>
<div class="cell-output cell-output-display">
<div id="compress_html_7179c63c98fc4303aec465ef13aa763b"><script>window.treescope_decompress_enqueue("eNrtXAtz2kgS/isTpWoN64Al9ACB7TqBeTnBjo0TO97bokaakRijl6UBjK/y368lHga/4mS92buKSJVBmu6efk1PfyjMLmETFPOZS/cEwuLQxbMq8gOfCoiRPcEOogGhNo0iSgZlXRZVS5FltSIpkkYxVnW1REm5rNsa0U1hfzcOsQ9/E3n7RStwgR2bZkQn6D8ovayit1qlhEWxhr4uCKzA86jPB9Mh9Qf0BiQQSqp+wHNFO3AJNl068ANCq0Mc5/ZdbFJ3f3NkwAPHcWnKU7WG1BpRks+j3/Nrs+L0lcwac5wQDKwhc0lE/bkacMMMIkIjtI82SV5NlZV/TTewRjXk4chhfsGlNq8iC7tWrmQNUQGJRcUa5kFV9C1d/zbV5uIXqsWBy8hcKzTBUa5QSKkKqS6gZ4gJYb5T4EG4sEMsqu4Q/Y5yEpizzrKQGwMVzefzKx/csRZezruc1ww4D7wqSjlXIpd3C4vbP9GbC03BqNSDhQgTNo4XBkrUA+ueNizV9K8p8c0UX1dxGV8pvHk0ugvKpTufJ/76LzvwecHGFoVJFp895kJmbfUwpxHDLurPPDNwY3Q85i7zKUENoIMKAO/hbKs2Z0trSFKKIg+7i3tTypwhJKSSlI84sqpoHLk5gjmuJuM708C2SzUTx1RT3hFRb/cco26kr+6JYQTpp/rpFP52WobRNJ571T3DcEbBe9Jt1hvTL4Zx9qVxaPS69YbRcm66nQ9DHtd7jDpy6+Ci9KGrfZn0wzH72FPPpMOL7unn3uS8d8s/zlqtxva5Mzpj9QNxyA5OxodN0r4SO+aOPemS8Pq9Nrw+Z+xk3PPbw479iRuftPpRpBitrj9qatan8djfPlWvrXg0ndgtd+f6xmkGFcc8nLYrUsfY8Y1T9UMUHUqn286teEpE49CWnKNyY9q+KjliMBuflsteU9KmnQv92HFCejaaKbRr3qqWGR23OTack+7R9ADHs/hk3O1enDdbU+PjSdj9Qj7t7Gw75bPyhcxF+/3Ha2OigswPxlHZ6E0Nz7k97W+PL/u0eXFTsjXr9kg57czUcd14f1u/CluhzDonjaZ4Of6o9Mu+Xf/Q7LR6nsG2K5NmaehLw/K2+Xl6cTXtRJOD9qeGf2U3mw7fPrYuXbes6o3Dab0y1JVer92X25eG43XVq/qJzs/atKM36/VuWz5wlNOdL9bMNNoQ08/vd4yTNjZor+EandvmsXPJHa3+0Tk+7h7UR+xEpa36RaPespgYDqMg9CE3wsvmgXQrjfp2w+bD2Xu/Q3Ar7tjikdduHml1Ylx//hxiHvcvPUIw00v2ra58YlfXWuhF2nHwpdFnUdubHLbl/nlfbjVLVv3EPtvuuEHYVlrxVMXOtVZhl7R/5Ibnfr3TpaQX0fH5dbvhSeetaNTv36gl7fw8nhqgUR5yHnKf57bStN56lcJgwQozx7CS/fWin+z3qfS74WrVpDA/TXfQdHVWkYCEe1SwVyY7/qPE/6aSQoTajxYBWOzmiAFnWgy8IOBDqPVVhH0O7AzWOKmtNncqJv/gehzFyY0wYCAsWpYSdkuT3UGn3n0rh8Ek3fEfWJHKJTgaxRQ7EaX+Pc7iFMcDy2WJY1f82OZpcV2qZaWv5+e8x7M55brrF/U2qXYF7ENgMWeBn1+/nUwCacIj7McsGa3OxSIpRhQ8VoBtMRjz7zNlpQEEhlHyZlOTdEr0hnlhEHGIzX3ZZhSMoK1L7iwMf5F319jW/LkM89fdnXmLuRtbEQv5/pT5JJgWOYiKgYcWh9BEwlJI+OemoT0E1c23UG4+Qx7t7c/NizlKLDkLksQDsoUGyb2Y8lSpxKWJHniKGUc+njAH8yAqguTQDHBEitOIcXpGb3juTlayd85lWS6O4w8s5kXoWHLCmr8FIIJZzphHITC53EKtB3wR9cB5D1i/vkMlURTT0mBhDv1ZjuYf40/nXXOqcKccB62Xa28P5SC8b1ELMxeSgQcoIX6Trknoq/wxdt0ZYuAzikmSE9vrvkvV+FqD4MyjkqIBlCqxJ6TdfRSMfcJhcAEVlshjo42AQBOzoqi49liDVEVSTdgUvVH5YGxeEHeZH4454rMQJkhLoBncCI/yLKolsO6kTJvihyAhgho1GnDoLCkXUpsLIzqD/WC4J9zTZtlqJVUNPBim70NrOAAiiw6ShlB4iWsWg9fgcx97dBBG1GY3wn5I/VvM1nI9CVGIISQDG8JjQudXhBCkQGz+dhTw06X0MDE6tzm+u7Pw2Nq8W3eLcQsFfiPJub2tZxZYDupznN9Cq6qwJ+Rc7JkEowiKdzX9mxfuIr4ihF3hEcpkC7hf7IAyTbTE7/B5hTc3rVn33v1GGG02wsIz1A9Ig4gBrsDuIKJhtPddKVLc4H0sYQYxRMd3hP3f3t6UyjUjivAsV5CKJVVS5Yr+DpE0kW03wFwu5edUm4a/e5hUINrFIWyVwj56zD0bkFv4CQmw6YiXp8M9vh9PjhemytPBZ+RHQ8/Io4H3x56ZzKCJolSpiLpU+n8OKyM/ElTg+gdDmq6sHwxqwvtzt6NnvjQTnk2Dt4/myoP95QrfLPePtAo9s0k8l2gCtGSg4FrtfXZc2H+9AKx/7wgF1eW1dADNi2ZiX2rY/PI3h9eeSaF/cCkllv3IYkr5Xms5vXSp3fPTu8yXL3LbRrM4/4rtXr8YJV95Cfv574sEqPlkR/lweayWxHMdx8N1snwjbLK/+x3PESiVZbmCNd0sq4pe1rAqahVsQsevYq1sSXfPETL8kOGHDD/8FfxQFkuSJMsZfvgF8INa1tSyWM7wQ4YfMvyQ4YcMP2T44R/AD091HK+HHySADTKVNEx1WyGqaYqiLMmmRiuKpdOK/DfjB/FZ/IBYPLBZFPNB4KdhyQBFBiiyBxIZoMgeSGSAIgMUGaDIAEUGKDJA8T/1QMLENpVFy8IypYqoSDoRxTKhlgLwwlJUkj2QyPBDhh9eBz9U5IpU0ZUMP/wSDyTKEOySkuGHDD9k+CHDDxl+yPDDz8cPT3Ucr4cfNCqVTVHWFSyJSkUuY1EjJa1EKqIq2iVdzfBDhh8y/PA6+EHUJVGqZPDhF4EPJVUTM/iQwYcMPmTwIYMPGXz4+fDhiYbjFdGDSSSq2VSraJqiK9Dpy2XZLFFFt2TLss0MPWToIUMPr4EeSsWyLkuylD19+EXggyIr2c8hMviQwYcMPmTwIYMPPx8+PN1xfAM/LI5QWp4INT+nar54uyRGe+gP4eXnsr5Dwst/fL1O/M1fWqwTf/N/Ua0Tf/ORyQbxtxDSn7W5g5JsA988OA4MvDZYXQ0SqhwigTVOan4y2HRp8rE+65Lcysl/iH8mp3HOJdsRdrz5EVkrRiuimNODxWVrQZFb8STzNFwAfcC05C/iEBAHaSRFOpcuDiuhOIJ9KsejcXr+J6BDlHMpRwwYxRq87d6FvuhS3+FDuLu9nRz1ldDNB9dnedIm9idMkPDEwTiy6AHA1L0nXZHi1OSQr3v888si9I4urKlzxoe5lbhi+uOXhZTUzOSIs9Xo4iCz9Kiw1Px1ISuHJcP5hGjtLLEnTnqj/vWYjunBIlfOqAfyOI1z+RXvfwHt3WCm", "compress_html_7179c63c98fc4303aec465ef13aa763b");</script></div>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div id="output_dest_b2bb272d9df04c449c5b2001803e61fd"><script> (()=>{ const output = document.getElementById("output_b2bb272d9df04c449c5b2001803e61fd"); const dest = document.getElementById("output_dest_b2bb272d9df04c449c5b2001803e61fd"); dest.parentNode.replaceChild(output, dest); })(); </script></div>
</div>
</div>
<p>We can dig around in this object uses its interfaces:</p>
<div id="8dd3d7c9" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>chm <span class="op">=</span> tr.get_sample()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>chm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="output_8e3cceee6b004d1e89c4b2994efff74f"><script> /* penzai.treescope rendering of a Python object (compressed) */ (()=>{ let observer; let lastStep = new Promise((resolve, reject) => { observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); }); window.treescope_decompress_enqueue = (encoded, destId) => { const previous = lastStep; const destElt = document.getElementById(destId); lastStep = (async () => { await previous; let blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); let reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); let parts = []; while (true) { let step = await reader.read(); if (step.done) { break; } parts.push(step.value); } let newElt = document.createElement("div"); newElt.innerHTML = parts.join(""); destElt.parentNode.replaceChild(newElt, destElt); for (let oldScript of newElt.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } })(); requestAnimationFrame(() => { observer.observe(destElt); }); } })(); </script><div id="compress_html_03cfc2b05a9447c1b99152018fd12215"><script>window.treescope_decompress_enqueue("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", "compress_html_03cfc2b05a9447c1b99152018fd12215");</script><span style="color: #aaaaaa; font-family: monospace">(Loading...)</span></div></div>
</div>
<div class="cell-output cell-output-display">
<div id="compress_html_0f49575ec2704fa29c275e0604378095"><script>window.treescope_decompress_enqueue("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", "compress_html_0f49575ec2704fa29c275e0604378095");</script></div>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div id="output_dest_8e3cceee6b004d1e89c4b2994efff74f"><script> (()=>{ const output = document.getElementById("output_8e3cceee6b004d1e89c4b2994efff74f"); const dest = document.getElementById("output_dest_8e3cceee6b004d1e89c4b2994efff74f"); dest.parentNode.replaceChild(output, dest); })(); </script></div>
</div>
</div>
<p>A <code>ChoiceMap</code> is a representation of <em>the sample</em> from the probability distribution which the generative function represents. We can ask <em>what values were sampled</em> at the addresses (the <code>"x"</code> and <code>"y"</code> syntax in our model):</p>
<div id="d91e3402" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(chm[<span class="st">"x"</span>], chm[<span class="st">"y"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="output_bfd5e5bdfefa4f4d86449b0c62e1d405"><script> /* penzai.treescope rendering of a Python object (compressed) */ (()=>{ let observer; let lastStep = new Promise((resolve, reject) => { observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); }); window.treescope_decompress_enqueue = (encoded, destId) => { const previous = lastStep; const destElt = document.getElementById(destId); lastStep = (async () => { await previous; let blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); let reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); let parts = []; while (true) { let step = await reader.read(); if (step.done) { break; } parts.push(step.value); } let newElt = document.createElement("div"); newElt.innerHTML = parts.join(""); destElt.parentNode.replaceChild(newElt, destElt); for (let oldScript of newElt.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } })(); requestAnimationFrame(() => { observer.observe(destElt); }); } })(); </script><div id="compress_html_d5794fa660a64a5d9f5059932c044836"><script>window.treescope_decompress_enqueue("eNrdWY1T4sgS/1dmc1VrWBcEBFRYrBeQL1d0FXd1vbuiJskkGUkycTIB8cr//fVMQD5Ed/fevn1XD6oMmfTHr3u6e7rjh1hMfXKYE5yQ2GIRGXLGBPoLRSymgrKwijjxsaBjUkMOC0XWwQH1p1UUsJDFEbZgfeJRQbLqpooiDis+jUVWic6KaQSrIQth2cTWyOUsCe2sxXzGqylrDc3uTB8IQB61hVdFDhVAFgoSihoKMHdpmPWJI6qoaHlSR0iyHqGuByuFXLmGHj/spOZ8iC1OI3GIqIP0CQ1tNllYiOr1OgIIxAEBdgZsfU6B/nqsPVvODSMS2jR0DUt6Jgay3//8JlkXh7YvRYaJ72+gdokYrnm/jvS504eCZVD9EEDuvEMnjI1gEzgSHkGKMmQ2yaF3O8gnAs14l1jV1oByPX32po5sZiUBODRnMnuK3r5Fb+STnOXjOD6BTctJh2Maxrq2CkrLIOmquQ7JFGEOklo+CdQOPYJmkfBQPYTbDbbyJBwwFkoDJ4yPZpaBylgAsitYko9WlgW15GJEOBge4NAiuZBN9MyTac+eoGzK9AHtFiXkTTGwvpU5n4Su8CA0UH5TRLy+p6nd0gPEj8kCupeEEvs3lccedYQ0SXHIH4/w/V4M+pySk7uExMIIaYAlRZvjgOipXzOZzTuyDiVKYi/dm9r3OG4Oop664kdc9/2wNwInIXAl5Ig4hHNiX5IggrAn8fMAiny5+BT4wManA+ITSzBu+D4E+ox3uQgm4TCGSNUyNZVwuswvkISYowRKQ+G6lDecBGxMVrJmScZLmaDPsUr5DmcPRCaHkpwWvlW4upYWNilScsDdsmkWJ2DGLCGXaeFXTtZhIE6VqLvZOrkXzVTZ0uPFYk3BSXP9VJYbTsBbFmlC+tk6SHgvCeQ+vbhXgrmun5aRoar+AoCpKgcrxBfvERmD9JkrZNip+9yITGVGalyblx4gXvJ5KlfXnmQOAwCozXE8IjgP0oPgg03HSDHW1+saEtgEwOS+ruU1xEJQCujDJbrN+HXh0XiOXIMjJz1I7VlADpWTPObbhKtYVAfcb3hPfmdHqWKpIiqwTy3Am3OAHJugStb1Fw7hR7RKNkzRAbVNY1A6nR+264ToEPnYJH61ahKIabKEylKf2kZ96YmbLcgjd3Yw52sLXTRU57DpM3lyv6jTg+TgzzXbmI9igl1wdficuxoyoa8teTjWD5XMw41+UDxVyyPWCA73DHqXWWCQrJuZ5vQrCFX4V9HWH8WyaW39L+GtMr0IsvILQMp9lIoTHssNjBgFBHyDXhr/PLUqFZSirMq3+KUY/zlaF+bJOvhcS47GQ4fyWAxZOJThvyG1XkulXLEss2njVqH/GH664+sQpVUrPbRK6MecLH3gWHtoyXr+k6JlqRbNCsOKagv7lg49PHRqheheles1HHDY/NegmIxDTZ5BsZkApRIG+o3k5Vc6ZeKRcAglysdRDE+/WVp/GNgrGtKCqnQoInIfQcv0Is3PwLFJxczQf81mPkvG9Mr8t9WHXoNT7KPBNDAZNFlniZCwbDRvJ5osmm6tnnWhbNX92dpkNryV8uD1mFtVlHBft7HAVfl8Z8Icp1gzcUwqpfd2/qDTd42GoT69c8Ng6lfjYgJ/u23DaBmvfRqBYbgj9tHutRrNyVfDuPzaPDb6vUbTaLv3ve6JJ+JGnxJ3t310XTzpVb6OB1FCP/XLl4Xj697Fl/74qv8gPk3b7eb2lTu6pI2jvEePzpPjlt25zXfNHWfcs6O7jxXv7orS86Qfdryu81kYnyuNU14y2r1w1KpYn5Mk3L4o31nxaDJ22v7O3b3bYvuueTzp7Be6xk5oXJRPOD8uXGy7D/kLO28cOwX3dK856dwW3TybJhd7e0GrUJl0rw/OXDcil6NpifTMh7Jl8rOOwIZ73judHOF4Gp8nvd71Vas9MT6dR72v9uednW1373LvelfknY+f7oxxGWSeGKd7Rn9iBO7DxWA7uRmQ1vV90alYD6eli+60nDSMjw+N26gd7dLuebOVv0k+lQZ7odM4aXXb/cCg2/vjVtELC97etvllcn076fLxUedzM7x1Wi1XbJ9ZN76/Vz5oHk8a+95Bqd/vDHY7N4Yb9Mq3jfMDcdkh3YNWo9Hr7B65pYudr9bUNDqwp18+7hjnHWyQftM3ug+tM/dGuJXGJ/fsrHfUGNHzMmk3rpuNtkXzkcdZFEJsRDeto8JDYTRwmo7wph/Dro3bcdfJnwad1mmlYRt3X75EWMSDm8C2MT0oOg8Hpc/09q4SBbxyxr42B5R3gvFxZ3dwNdhtt4pW49y53O76LOqU2vGkjN27yj69IYNTP7oKG90esfucJFd3nWZQuGrz0WBwXy5Wrq7iiQGIMkiNqULfUmG9lfkZ6Qvt6dRMhICZelORWjze1DNoSFujgnMshlKwkfgPUijZWu3vFgFIdnNEgVMVgwBaaQ9mwirCoQB2CjluP70GeqrEz7qMlJs+QCXJ5w5IsG5l2p5ssGJzt7ngzE1wPLSgDQfHPvFjR6w07/M2+TWdazyrKpddj8aY69msrHZZHMLGquE3s7wslci3AhyH82ZCiUWFGBHwWBZOVJaIHzPlCQFsDCX2m1UkSiV6Q4OIcYHDZ7JNzkbq5Iqmi17w295dYlvy59OBu/7e7tkE6am3Boo/NQ2mR6huoYX0VMPqqySw5JLJwAOyGQK5FhOhQEmXShx4gqlAIR5TF8N0DZMljUyGuZ2bcCrIJTR/+kIW7MRM1mICxbata0v+VsM2EZc0ILAxT9P9M77524I11sf3qJjP51VpsLCADklXjdtmvUtO1RbgVud5Hbb3N9TG1IdgEAxJ4jcqJ6ElCxPs+1PoJmJBsC1jYnvZd7M5ejFEy1CaT9GrY956twnzcFrGPtAwSgSSrxvqmipcJrvXNgqZ1Thg3VFMq/o8kMBB9GgooJUkMLereIVpHaq4V9e0Qx2AAgOwz1QvsW8tYnELZvymdHl965X4UtN9Zgs9JUVd030cmDZW7yGq6m9GQypu69pS9kBR3EApK+B6rgOl8rM0AH5rKeLDJzPSy7ITnjXJ2mvP5w+pXdeeXkuUC1Zld79cwZU8Lu2b+/t7doVYRXu3crCPCwWi/fpt3rBf2qbXKNrhW1/UbvF9zuAcT5HjMyx2i5BkuVwOvXVFbc116eX9iuDVxls7RJv8vNIVa78gkn7P//n9wSSJ/348fW90bYyefH4vX4FgMe0SKVVKzn55167gsnlQ2C2UDir4/y96XouL9/+M2Cn8SOwUfl7spJfMP8IJv6QUzy82Hb/cqrz0jwk983SQ/ht71VZ6", "compress_html_d5794fa660a64a5d9f5059932c044836");</script><span style="color: #aaaaaa; font-family: monospace">(Loading...)</span></div></div>
</div>
<div class="cell-output cell-output-display">
<div id="compress_html_49b7f31b09874bcea4fa729da25771d6"><script>window.treescope_decompress_enqueue("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", "compress_html_49b7f31b09874bcea4fa729da25771d6");</script></div>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div id="output_dest_bfd5e5bdfefa4f4d86449b0c62e1d405"><script> (()=>{ const output = document.getElementById("output_bfd5e5bdfefa4f4d86449b0c62e1d405"); const dest = document.getElementById("output_dest_bfd5e5bdfefa4f4d86449b0c62e1d405"); dest.parentNode.replaceChild(output, dest); })(); </script></div>
</div>
</div>
<p>Neat – all of our interfaces are JAX compatible, so we could sample 1000 times just by using <code>jax.vmap</code>:</p>
<div id="31bf4b36" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sub_keys <span class="op">=</span> jrand.split(jrand.PRNGKey(<span class="dv">0</span>), <span class="dv">1000</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> jit(vmap(model.simulate, in_axes<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>)))(sub_keys, ())</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>tr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="output_1acde7287ec1435293c2e78ac97afc4b"><script> /* penzai.treescope rendering of a Python object (compressed) */ (()=>{ let observer; let lastStep = new Promise((resolve, reject) => { observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); }); window.treescope_decompress_enqueue = (encoded, destId) => { const previous = lastStep; const destElt = document.getElementById(destId); lastStep = (async () => { await previous; let blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); let reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); let parts = []; while (true) { let step = await reader.read(); if (step.done) { break; } parts.push(step.value); } let newElt = document.createElement("div"); newElt.innerHTML = parts.join(""); destElt.parentNode.replaceChild(newElt, destElt); for (let oldScript of newElt.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } })(); requestAnimationFrame(() => { observer.observe(destElt); }); } })(); </script><div id="compress_html_ee062661d183400480d8ba2e6766043a"><script>window.treescope_decompress_enqueue("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", "compress_html_ee062661d183400480d8ba2e6766043a");</script><span style="color: #aaaaaa; font-family: monospace">(Loading...)</span></div></div>
</div>
<div class="cell-output cell-output-display">
<div id="compress_html_4ab5ee63ffc9458ea88a57502e9edb26"><script>window.treescope_decompress_enqueue("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", "compress_html_4ab5ee63ffc9458ea88a57502e9edb26");</script></div>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div id="output_dest_1acde7287ec1435293c2e78ac97afc4b"><script> (()=>{ const output = document.getElementById("output_1acde7287ec1435293c2e78ac97afc4b"); const dest = document.getElementById("output_dest_1acde7287ec1435293c2e78ac97afc4b"); dest.parentNode.replaceChild(output, dest); })(); </script></div>
</div>
</div>
<p>Let’s plot our samples to get a sense of the distribution we wrote down.</p>
<div id="bf945bb1" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>chm <span class="op">=</span> tr.get_sample()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(chm[<span class="st">"x"</span>], chm[<span class="st">"y"</span>], marker<span class="op">=</span><span class="st">"."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="output_73d43bb54fab496ebd9f47f283054443"><script> /* penzai.treescope rendering of a Python object (compressed) */ (()=>{ let observer; let lastStep = new Promise((resolve, reject) => { observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); }); window.treescope_decompress_enqueue = (encoded, destId) => { const previous = lastStep; const destElt = document.getElementById(destId); lastStep = (async () => { await previous; let blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); let reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); let parts = []; while (true) { let step = await reader.read(); if (step.done) { break; } parts.push(step.value); } let newElt = document.createElement("div"); newElt.innerHTML = parts.join(""); destElt.parentNode.replaceChild(newElt, destElt); for (let oldScript of newElt.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } })(); requestAnimationFrame(() => { observer.observe(destElt); }); } })(); </script><div id="compress_html_b33051f889424e27a5b32cc0749b6d65"><script>window.treescope_decompress_enqueue("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", "compress_html_b33051f889424e27a5b32cc0749b6d65");</script><span style="color: #aaaaaa; font-family: monospace">(Loading...)</span></div></div>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div id="output_dest_73d43bb54fab496ebd9f47f283054443"><script> (()=>{ const output = document.getElementById("output_73d43bb54fab496ebd9f47f283054443"); const dest = document.getElementById("output_dest_73d43bb54fab496ebd9f47f283054443"); dest.parentNode.replaceChild(output, dest); })(); </script></div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_files/figure-html/cell-8-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Traces also keep track of other data, like <em>the score</em> of the execution (which is a value which estimates the joint probability of the random choices under the distribution):</p>
<div id="3d9c1d8f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tr.get_score()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="output_4d1f10ed2e2f4f6da0cbf29c89a8ba58"><script> /* penzai.treescope rendering of a Python object (compressed) */ (()=>{ let observer; let lastStep = new Promise((resolve, reject) => { observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); }); window.treescope_decompress_enqueue = (encoded, destId) => { const previous = lastStep; const destElt = document.getElementById(destId); lastStep = (async () => { await previous; let blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); let reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); let parts = []; while (true) { let step = await reader.read(); if (step.done) { break; } parts.push(step.value); } let newElt = document.createElement("div"); newElt.innerHTML = parts.join(""); destElt.parentNode.replaceChild(newElt, destElt); for (let oldScript of newElt.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } })(); requestAnimationFrame(() => { observer.observe(destElt); }); } })(); </script><div id="compress_html_2ac99cbebe8945aa81476a53afe5f65a"><script>window.treescope_decompress_enqueue("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", "compress_html_2ac99cbebe8945aa81476a53afe5f65a");</script><span style="color: #aaaaaa; font-family: monospace">(Loading...)</span></div></div>
</div>
<div class="cell-output cell-output-display">
<div id="compress_html_bf852214932046c4939cdbff23fa086f"><script>window.treescope_decompress_enqueue("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", "compress_html_bf852214932046c4939cdbff23fa086f");</script></div>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div id="output_dest_4d1f10ed2e2f4f6da0cbf29c89a8ba58"><script> (()=>{ const output = document.getElementById("output_4d1f10ed2e2f4f6da0cbf29c89a8ba58"); const dest = document.getElementById("output_dest_4d1f10ed2e2f4f6da0cbf29c89a8ba58"); dest.parentNode.replaceChild(output, dest); })(); </script></div>
</div>
</div>
</section>
<section id="composition-of-generative-functions" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="composition-of-generative-functions"><span class="header-section-number">2.2</span> Composition of generative functions</h2>
<p>Generative functions are probabilistic building blocks. You can combine them into larger probability distributions:</p>
<div id="c9c51a35" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A regression distribution. </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">@gen</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regression(x, coefficients, sigma):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    basis_value <span class="op">=</span> jnp.array([<span class="fl">1.0</span>, x, x<span class="op">**</span><span class="dv">2</span>])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    polynomial_value <span class="op">=</span> jnp.<span class="bu">sum</span>(basis_value <span class="op">*</span> coefficients)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> genjax.normal(polynomial_value, sigma) <span class="op">@</span> <span class="st">"value"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression, with an outlier random variable.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">@gen</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regression_with_outlier(x, coefficients):</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    is_outlier <span class="op">=</span> genjax.flip(<span class="fl">0.1</span>) <span class="op">@</span> <span class="st">"outlier"</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> jnp.select(is_outlier, <span class="fl">0.3</span>, <span class="fl">30.0</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    is_outlier <span class="op">=</span> jnp.array(is_outlier, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> regression(x, coefficients, sigma) <span class="op">@</span> <span class="st">"y"</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># The full model, sample coefficients for a curve, and then use</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># them in independent draws from the regression submodel.</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="at">@gen</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model(xs):</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    coefficients <span class="op">=</span> (</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        genjax.mv_normal(np.zeros(<span class="dv">3</span>, dtype<span class="op">=</span><span class="bu">float</span>), </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                         <span class="fl">2.0</span> <span class="op">*</span> np.identity(<span class="dv">3</span>)) <span class="op">@</span> <span class="st">"alpha"</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    ys <span class="op">=</span> regression_with_outlier(in_axes<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>))(xs, coefficients) <span class="op">@</span> <span class="st">"ys"</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inference-in-generative-functions" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="inference-in-generative-functions"><span class="header-section-number">2.3</span> Inference in generative functions</h2>
<p>Now that we’ve seen a few ways to build up larger generative functions from smaller ones, we should tackle…</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Getting started">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./inference_libraries.html" class="pagination-link" aria-label="Standard inference libraries">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Standard inference libraries</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/probcomp/genjax/edit/main/notebooks/intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/probcomp/genjax/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/probcomp/genjax/blob/main/notebooks/intro.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div></div></footer></body></html>

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://genjax.gen.dev/library/core.html">
      
      
        <link rel="prev" href="../cookbook/inactive/library_author/dimap_combinator.html">
      
      
        <link rel="next" href="generative_functions.html">
      
      
      <link rel="icon" href="../assets/img/small_logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Core - GenJAX</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CBerkeley+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Berkeley Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/custom.css">
    
      <link rel="stylesheet" href="../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#journey-to-the-center-of-genjaxcore" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="GenJAX" class="md-header__button md-logo" aria-label="GenJAX" data-md-component="logo">
      
  <img src="../assets/img/small_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GenJAX
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Core
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/genjax-dev/genjax-chi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    genjax-dev/genjax-chi
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../cookbook/active/jax_basics.html" class="md-tabs__link">
          
  
  
    
  
  Cookbook

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="core.html" class="md-tabs__link">
          
  
  
    
  
  Library reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../developing.html" class="md-tabs__link">
          
  
  
    
  
  For developers

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="GenJAX" class="md-nav__button md-logo" aria-label="GenJAX" data-md-component="logo">
      
  <img src="../assets/img/small_logo.png" alt="logo">

    </a>
    GenJAX
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/genjax-dev/genjax-chi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    genjax-dev/genjax-chi
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../cookbook/active/jax_basics.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Cookbook
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Library reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Library reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="core.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GenerativeFunction
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" GenerativeFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.__abstract_call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__abstract_call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.accumulate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;accumulate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.assess" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;assess
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.contramap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;contramap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.dimap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;dimap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.edit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;edit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.get_zero_trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_zero_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.handle_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;handle_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.importance" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.iterate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;iterate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.iterate_final" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;iterate_final
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.map" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.mask" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.masked_iterate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;masked_iterate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.masked_iterate_final" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;masked_iterate_final
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.mix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.or_else" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;or_else
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.propose" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;propose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.reduce" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reduce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.repeat" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;repeat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.scan" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.simulate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;simulate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.switch" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;switch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.vmap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;vmap
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Trace
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Trace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.edit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;edit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_choices" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_choices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_gen_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_gen_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_inner_trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_inner_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_retval" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_retval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_score" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_score
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_subtrace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_subtrace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.update" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.EditRequest" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EditRequest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generative-functions-with-addressed-random-choices" class="md-nav__link">
    <span class="md-ellipsis">
      Generative functions with addressed random choices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ChoiceMap
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ChoiceMap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.at" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;at
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.choice" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;choice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.d" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;d
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.empty" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.entry" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;entry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.extend" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.filter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.from_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.get_selection" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.invalid_subset" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;invalid_subset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.kw" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;kw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.mask" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.merge" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;merge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.simplify" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;simplify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.static_is_empty" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;static_is_empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.switch" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;switch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Selection" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Selection
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.at" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;at
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.all" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;all
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.extend" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.filter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.leaf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;leaf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.none" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;none
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jax-compatible-data-via-pytree" class="md-nav__link">
    <span class="md-ellipsis">
      JAX compatible data via Pytree
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Pytree" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Pytree
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Pytree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Pytree.dataclass" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;dataclass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Pytree.static" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;static
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Pytree.field" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;field
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Const" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Const
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Const">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Const.unwrap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;unwrap
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Closure" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Closure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamism-in-jax-masks-and-sum-types" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamism in JAX: masks and sum types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamism in JAX: masks and sum types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jax-is-a-two-phase-system" class="md-nav__link">
    <span class="md-ellipsis">
      JAX is a two-phase system
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Mask" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Mask
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Mask">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Mask.unmask" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;unmask
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-typing-with-genjaxtyping-aka-beartype" class="md-nav__link">
    <span class="md-ellipsis">
      Static typing with genjax.typing a.k.a 🐻beartype🐻
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static typing with genjax.typing a.k.a 🐻beartype🐻">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generative-interface-types" class="md-nav__link">
    <span class="md-ellipsis">
      Generative interface types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Arguments" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Arguments
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Score" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Score
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Weight" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Weight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Retdiff" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Retdiff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Argdiffs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Argdiffs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="generative_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generative functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="combinators.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Combinators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../developing.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    For developers
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GenerativeFunction
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" GenerativeFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.__abstract_call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__abstract_call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.accumulate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;accumulate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.assess" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;assess
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.contramap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;contramap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.dimap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;dimap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.edit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;edit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.get_zero_trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_zero_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.handle_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;handle_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.importance" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.iterate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;iterate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.iterate_final" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;iterate_final
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.map" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.mask" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.masked_iterate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;masked_iterate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.masked_iterate_final" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;masked_iterate_final
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.mix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.or_else" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;or_else
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.propose" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;propose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.reduce" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reduce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.repeat" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;repeat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.scan" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.simulate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;simulate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.switch" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;switch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.GenerativeFunction.vmap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;vmap
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Trace
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Trace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.edit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;edit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_choices" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_choices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_gen_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_gen_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_inner_trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_inner_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_retval" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_retval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_score" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_score
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.get_subtrace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_subtrace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Trace.update" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.EditRequest" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EditRequest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generative-functions-with-addressed-random-choices" class="md-nav__link">
    <span class="md-ellipsis">
      Generative functions with addressed random choices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ChoiceMap
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ChoiceMap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.at" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;at
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.choice" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;choice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.d" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;d
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.empty" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.entry" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;entry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.extend" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.filter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.from_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.get_selection" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.invalid_subset" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;invalid_subset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.kw" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;kw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.mask" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.merge" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;merge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.simplify" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;simplify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.static_is_empty" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;static_is_empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.ChoiceMap.switch" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;switch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Selection" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Selection
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.at" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;at
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.all" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;all
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.extend" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.filter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.leaf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;leaf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Selection.none" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;none
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jax-compatible-data-via-pytree" class="md-nav__link">
    <span class="md-ellipsis">
      JAX compatible data via Pytree
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Pytree" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Pytree
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Pytree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Pytree.dataclass" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;dataclass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Pytree.static" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;static
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genjax.core.Pytree.field" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;field
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Const" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Const
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Const">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Const.unwrap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;unwrap
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Closure" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Closure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamism-in-jax-masks-and-sum-types" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamism in JAX: masks and sum types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamism in JAX: masks and sum types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jax-is-a-two-phase-system" class="md-nav__link">
    <span class="md-ellipsis">
      JAX is a two-phase system
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Mask" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Mask
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Mask">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#genjax.core.Mask.unmask" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;unmask
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-typing-with-genjaxtyping-aka-beartype" class="md-nav__link">
    <span class="md-ellipsis">
      Static typing with genjax.typing a.k.a 🐻beartype🐻
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static typing with genjax.typing a.k.a 🐻beartype🐻">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generative-interface-types" class="md-nav__link">
    <span class="md-ellipsis">
      Generative interface types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Arguments" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Arguments
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Score" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Score
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Weight" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Weight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Retdiff" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Retdiff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genjax.core.Argdiffs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Argdiffs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/genjax-dev/genjax-chi/edit/main/docs/library/core.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/genjax-dev/genjax-chi/raw/main/docs/library/core.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="journey-to-the-center-of-genjaxcore">Journey to the center of <code>genjax.core</code><a class="headerlink" href="#journey-to-the-center-of-genjaxcore" title="Permanent link">&para;</a></h1>
<p>This page describes the set of core concepts and datatypes in GenJAX, including Gen's generative datatypes and concepts (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a>, <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>, <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt;" href="#genjax.core.ChoiceMap"><code>ChoiceMap</code></a>, and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a>), the core JAX compatibility datatypes (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt;" href="#genjax.core.Pytree"><code>Pytree</code></a>, <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Const&lt;/span&gt;" href="#genjax.core.Const"><code>Const</code></a>, and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Closure&lt;/span&gt;" href="#genjax.core.Closure"><code>Closure</code></a>), as well as functionally inspired <code>Pytree</code> extensions (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Mask&lt;/span&gt;" href="#genjax.core.Mask"><code>Mask</code></a>), and GenJAX's approach to "static" (JAX tracing time) typechecking.</p>


<div class="doc doc-object doc-class">



<h2 id="genjax.core.GenerativeFunction" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.GenerativeFunction</span>


<a href="#genjax.core.GenerativeFunction" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="genjax._src.core.typing.Generic">Generic</span>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt; (&lt;code&gt;genjax._src.core.pytree.Pytree&lt;/code&gt;)" href="#genjax.core.Pytree">Pytree</a></code></p>


        <p><code>GenerativeFunction</code> is the type of <em>generative functions</em>, the main computational object in Gen.</p>
<p>Generative functions are a type of probabilistic program. In terms of their mathematical specification, they come equipped with a few ingredients:</p>
<ul>
<li>(<strong>Distribution over samples</strong>) <span class="arithmatex">\(P(\cdot_t, \cdot_r; a)\)</span> - a probability distribution over samples <span class="arithmatex">\(t\)</span> and untraced randomness <span class="arithmatex">\(r\)</span>, indexed by arguments <span class="arithmatex">\(a\)</span>. This ingredient is involved in all the interfaces and specifies the distribution over samples which the generative function represents.</li>
<li>(<strong>Family of K/L proposals</strong>) <span class="arithmatex">\((K(\cdot_t, \cdot_{K_r}; u, t), L(\cdot_t, \cdot_{L_r}; u, t)) = \mathcal{F}(u, t)\)</span> - a family of pairs of probabilistic programs (referred to as K and L), indexed by <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a> <span class="arithmatex">\(u\)</span> and an existing sample <span class="arithmatex">\(t\)</span>. This ingredient supports the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a> and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;importance&lt;/span&gt;" href="#genjax.core.GenerativeFunction.importance"><code>importance</code></a> interface, and is used to specify an SMCP3 move which the generative function must provide in response to an edit request. K and L must satisfy additional properties, described further in <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a>.</li>
<li>(<strong>Return value function</strong>) <span class="arithmatex">\(f(t, r, a)\)</span> - a deterministic return value function, which maps samples and untraced randomness to return values.</li>
</ul>
<p>Generative functions also support a family of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.inference.Target&lt;/span&gt;" href="inference.html#genjax.inference.Target"><code>Target</code></a> distributions - a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.inference.Target&lt;/span&gt;" href="inference.html#genjax.inference.Target"><code>Target</code></a> distribution is a (possibly unnormalized) distribution, typically induced by inference problems.</p>
<ul>
<li><span class="arithmatex">\(\delta_\emptyset\)</span> - the empty target, whose only possible value is the empty sample, with density 1.</li>
<li>(<strong>Family of targets induced by <span class="arithmatex">\(P\)</span></strong>) <span class="arithmatex">\(T_P(a, c)\)</span> - a family of targets indexed by arguments <span class="arithmatex">\(a\)</span> and constraints (<code>ChoiceMap</code>), created by pairing the distribution over samples <span class="arithmatex">\(P\)</span> with arguments and constraint.</li>
</ul>
<p>Generative functions expose computations using these ingredients through the <em>generative function interface</em> (the methods which are documented below).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>The interface methods can be used to implement inference algorithms directly - here's a simple example using bootstrap importance sampling directly:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">jax.scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">logsumexp</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.tree_util</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jtu</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">flip</span><span class="p">,</span> <span class="n">categorical</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nd">@gen</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">():</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">p</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;p&quot;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">f1</span> <span class="o">=</span> <span class="n">flip</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;f1&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">f2</span> <span class="o">=</span> <span class="n">flip</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;f2&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c1"># Bootstrap importance sampling.</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">importance_sampling</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">key</span><span class="p">,</span> <span class="n">sub_key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">sub_keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sub_key</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">tr</span><span class="p">,</span> <span class="n">log_weights</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">importance</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="n">sub_keys</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="p">()</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">logits</span> <span class="o">=</span> <span class="n">log_weights</span> <span class="o">-</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">log_weights</span><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">categorical</span><span class="p">(</span><span class="n">logits</span><span class="p">)(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="k">return</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_choices</span><span class="p">())</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="n">sub_keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">importance_sampling</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)))(</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="n">sub_keys</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">kw</span><span class="p">(</span><span class="n">f1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">f2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="p">)</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_ae61d45b7cd14b4991720d15f89dd7f6" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_ae61d45b7cd14b4991720d15f89dd7f6")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_ae61d45b7cd14b4991720d15f89dd7f6")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__abstract_call__&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.__abstract_call__&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.__abstract_call__">__abstract_call__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Used to support JAX tracing, although this default implementation involves no</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;accumulate&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.accumulate&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.accumulate">accumulate</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>When called on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, a) -&gt; c</code>, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, [a]) -&gt; [c]</code> where</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;assess&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.assess&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.assess">assess</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Return <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_score">the score</a> and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_retval&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_retval">the return value</a> when the generative function is invoked with the provided arguments, and constrained to take the provided sample as the sampled value.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;contramap&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.contramap&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.contramap">contramap</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Specialized version of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;dimap&lt;/span&gt;" href="#genjax.core.GenerativeFunction.dimap"><code>genjax.GenerativeFunction.dimap</code></a> where only the pre-processing function is applied.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;dimap&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.dimap&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.dimap">dimap</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> and applies pre- and post-processing functions to its arguments and return value.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.edit&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.edit">edit</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Update a trace in response to an <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a>, returning a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>, an incremental <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Weight"><code>Weight</code></a> for the new target, a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Retdiff&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Retdiff"><code>Retdiff</code></a> return value tagged with change information, and a backward <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a> which requests the reverse move (to go back to the original trace).</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_zero_trace&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.get_zero_trace&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.get_zero_trace">get_zero_trace</a></code></td>
              <td>
                <div class="doc-md-description">
                  <div class="language-text highlight"><pre><span></span><code>    Returns a trace with zero values for all leaves, generated without executing the generative function.
</code></pre></div>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;handle_kwargs&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.handle_kwargs&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.handle_kwargs">handle_kwargs</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a new GenerativeFunction like <code>self</code>, but where all GFI methods accept a tuple of arguments and a dictionary of keyword arguments.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;importance&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.importance&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.importance">importance</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a properly weighted pair, a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a> and a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Weight"><code>Weight</code></a>, properly weighted for the target induced by the generative function for the provided constraint and arguments.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;iterate&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.iterate&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.iterate">iterate</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>When called on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>a -&gt; a</code>, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>a -&gt; [a]</code> where</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;iterate_final&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.iterate_final&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.iterate_final">iterate_final</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a decorator that wraps a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>a -&gt; a</code> and returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>a -&gt; a</code> where</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;map&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.map&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.map">map</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Specialized version of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;genjax.dimap&lt;/span&gt;" href="combinators.html#genjax.dimap"><code>genjax.dimap</code></a> where only the post-processing function is applied.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;mask&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.mask&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.mask">mask</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Enables dynamic masking of generative functions. Returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> like <code>self</code>, but which accepts an additional boolean first argument.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;masked_iterate&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.masked_iterate&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.masked_iterate">masked_iterate</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Transforms a generative function that takes a single argument of type <code>a</code> and returns a value of type <code>a</code>, into a function that takes a tuple of arguments <code>(a, [mask])</code> and returns a list of values of type <code>a</code>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;masked_iterate_final&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.masked_iterate_final&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.masked_iterate_final">masked_iterate_final</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Transforms a generative function that takes a single argument of type <code>a</code> and returns a value of type <code>a</code>, into a function that takes a tuple of arguments <code>(a, [mask])</code> and returns a value of type <code>a</code>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;mix&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.mix&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.mix">mix</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Takes any number of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a>s and returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that represents a mixture model.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;or_else&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.or_else&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.or_else">or_else</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> that accepts</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;propose&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.propose&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.propose">propose</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Samples a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt;" href="#genjax.core.ChoiceMap"><code>ChoiceMap</code></a> and any untraced randomness <span class="arithmatex">\(r\)</span> from the generative function's distribution over samples (<span class="arithmatex">\(P\)</span>), and returns the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Score"><code>Score</code></a> of that sample under the distribution, and the <code>R</code> of the generative function's return value function <span class="arithmatex">\(f(r, t, a)\)</span> for the sample and untraced randomness.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;reduce&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.reduce&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.reduce">reduce</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>When called on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, a) -&gt; c</code>, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, [a]) -&gt; c</code> where</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;repeat&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.repeat&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.repeat">repeat</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that samples from <code>self</code> <code>n</code> times, returning a vector of <code>n</code> results.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;scan&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.scan&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.scan">scan</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>When called on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, a) -&gt; (c, b)</code>, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, [a]) -&gt; (c, [b])</code> where</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;simulate&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.simulate&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.simulate">simulate</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Execute the generative function, sampling from its distribution over samples, and return a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;switch&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.switch&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.switch">switch</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Given <code>n</code> <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> inputs, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that accepts <code>n+2</code> arguments:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;vmap&lt;/span&gt; (&lt;code&gt;genjax.core.GenerativeFunction.vmap&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.vmap">vmap</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> that performs a vectorized map over the argument specified by <code>in_axes</code>. Traced values are nested under an index, and the retval is vectorized.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="k">class</span><span class="w"> </span><span class="nc">GenerativeFunction</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    `GenerativeFunction` is the type of _generative functions_, the main computational object in Gen.</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Generative functions are a type of probabilistic program. In terms of their mathematical specification, they come equipped with a few ingredients:</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    * (**Distribution over samples**) $P(\\cdot_t, \\cdot_r; a)$ - a probability distribution over samples $t$ and untraced randomness $r$, indexed by arguments $a$. This ingredient is involved in all the interfaces and specifies the distribution over samples which the generative function represents.</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    * (**Family of K/L proposals**) $(K(\\cdot_t, \\cdot_{K_r}; u, t), L(\\cdot_t, \\cdot_{L_r}; u, t)) = \\mathcal{F}(u, t)$ - a family of pairs of probabilistic programs (referred to as K and L), indexed by [`EditRequest`][genjax.core.EditRequest] $u$ and an existing sample $t$. This ingredient supports the [`edit`][genjax.core.GenerativeFunction.edit] and [`importance`][genjax.core.GenerativeFunction.importance] interface, and is used to specify an SMCP3 move which the generative function must provide in response to an edit request. K and L must satisfy additional properties, described further in [`edit`][genjax.core.GenerativeFunction.edit].</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    * (**Return value function**) $f(t, r, a)$ - a deterministic return value function, which maps samples and untraced randomness to return values.</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Generative functions also support a family of [`Target`][genjax.inference.Target] distributions - a [`Target`][genjax.inference.Target] distribution is a (possibly unnormalized) distribution, typically induced by inference problems.</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    * $\\delta_\\emptyset$ - the empty target, whose only possible value is the empty sample, with density 1.</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    * (**Family of targets induced by $P$**) $T_P(a, c)$ - a family of targets indexed by arguments $a$ and constraints (`ChoiceMap`), created by pairing the distribution over samples $P$ with arguments and constraint.</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    Generative functions expose computations using these ingredients through the _generative function interface_ (the methods which are documented below).</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        The interface methods can be used to implement inference algorithms directly - here&#39;s a simple example using bootstrap importance sampling directly:</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        import jax</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        from jax.scipy.special import logsumexp</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        import jax.tree_util as jtu</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        from genjax import gen, uniform, flip, categorical</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        @gen</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        def model():</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            p = uniform(0.0, 1.0) @ &quot;p&quot;</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            f1 = flip(p) @ &quot;f1&quot;</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            f2 = flip(p) @ &quot;f2&quot;</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        # Bootstrap importance sampling.</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        def importance_sampling(key, constraint):</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            key, sub_key = jax.random.split(key)</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            sub_keys = jax.random.split(sub_key, 5)</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">            tr, log_weights = jax.vmap(model.importance, in_axes=(0, None, None))(</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">                sub_keys, constraint, ()</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            )</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            logits = log_weights - logsumexp(log_weights)</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            idx = categorical(logits)(key)</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            return jtu.tree_map(lambda v: v[idx], tr.get_choices())</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        sub_keys = jax.random.split(jax.random.key(0), 50)</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        samples = jax.jit(jax.vmap(importance_sampling, in_axes=(0, None)))(</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            sub_keys, C.kw(f1=True, f2=True)</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        )</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        print(samples.render_html())</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        ```</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunctionClosure[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="k">return</span> <span class="n">GenerativeFunctionClosure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__abstract_call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Used to support JAX tracing, although this default implementation involves no</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        JAX operations (it takes a fixed-key sample from the return value).</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        Generative functions may customize this to improve compilation time.</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_zero_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">get_retval</span><span class="p">()</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">handle_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        Returns a new GenerativeFunction like `self`, but where all GFI methods accept a tuple of arguments and a dictionary of keyword arguments.</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        The returned GenerativeFunction can be invoked with `__call__` with no special argument handling (just like the original).</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        In place of `args` tuples in GFI methods, the new GenerativeFunction expects a 2-tuple containing:</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        1. A tuple containing the original positional arguments.</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        2. A dictionary containing the keyword arguments.</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        This allows for more flexible argument passing, especially useful in contexts where</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        keyword arguments need to be handled separately or passed through multiple layers.</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            A new GenerativeFunction that accepts (args_tuple, kwargs_dict) for all GFI methods.</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        Example:</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            import jax</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">            def model(x, y, z=1.0):</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">                _ = genjax.normal(x + y, z) @ &quot;v&quot;</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">                return x + y + z</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">            kw_model = model.handle_kwargs()</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            tr = kw_model.simulate(key, ((1.0, 2.0), {&quot;z&quot;: 3.0}))</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            ```</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="k">return</span> <span class="n">IgnoreKwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_zero_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">]:</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        Returns a trace with zero values for all leaves, generated without executing the generative function.</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        This method is useful for static analysis and shape inference without executing the generative function. It returns a trace with the same structure as a real trace, but filled with zero or default values.</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        Args:</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">            *args: The arguments to the generative function.</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">            **_kwargs: Ignored keyword arguments.</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">            A trace with zero values, matching the structure of a real trace.</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        Note:</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            This method uses the `empty_trace` utility function, which creates a trace without spending any FLOPs. The resulting trace has the correct structure but contains placeholder zero values.</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        Example:</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            def weather_model():</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">                temperature = genjax.normal(20.0, 5.0) @ &quot;temperature&quot;</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">                is_sunny = genjax.bernoulli(0.7) @ &quot;is_sunny&quot;</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">                return {&quot;temperature&quot;: temperature, &quot;is_sunny&quot;: is_sunny}</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            zero_trace = weather_model.get_zero_trace()</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">            print(&quot;Zero trace structure:&quot;)</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            print(zero_trace.render_html())</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">            print(&quot;\nActual simulation:&quot;)</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">            actual_trace = weather_model.simulate(key, ())</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">            print(actual_trace.render_html())</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">            ```</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="k">return</span> <span class="n">empty_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">]:</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        Execute the generative function, sampling from its distribution over samples, and return a [`Trace`][genjax.core.Trace].</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        ## More on traces</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">        The [`Trace`][genjax.core.Trace] returned by `simulate` implements its own interface.</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        It is responsible for storing the arguments of the invocation ([`genjax.Trace.get_args`][]), the return value of the generative function ([`genjax.Trace.get_retval`][]), the identity of the generative function which produced the trace ([`genjax.Trace.get_gen_fn`][]), the sample of traced random choices produced during the invocation ([`genjax.Trace.get_choices`][]) and _the score_ of the sample ([`genjax.Trace.get_score`][]).</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">            import jax</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            from jax import vmap, jit</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            from jax.random import split</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">            def model():</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">                x = genjax.normal(0.0, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">                return x</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">            tr = model.simulate(key, ())</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">            ```</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">            Another example, using the same model, composed into [`genjax.repeat`](combinators.md#genjax.repeat) - which creates a new generative function, which has the same interface:</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            def model():</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">                x = genjax.normal(0.0, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">                return x</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            tr = model.repeat(n=10).simulate(key, ())</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            ```</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">            (**Fun, flirty, fast ... parallel?**) Feel free to use `jax.jit` and `jax.vmap`!</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            sub_keys = split(key, 10)</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            sim = model.repeat(n=10).simulate</span>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">            tr = jit(vmap(sim, in_axes=(0, None)))(sub_keys, ())</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">            ```</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assess</span><span class="p">(</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="n">sample</span><span class="p">:</span> <span class="n">ChoiceMap</span><span class="p">,</span>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Score</span><span class="p">,</span> <span class="n">R</span><span class="p">]:</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        Return [the score][genjax.core.Trace.get_score] and [the return value][genjax.core.Trace.get_retval] when the generative function is invoked with the provided arguments, and constrained to take the provided sample as the sampled value.</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        It is an error if the provided sample value is off the support of the distribution over the `ChoiceMap` type, or otherwise induces a partial constraint on the execution of the generative function (which would require the generative function to provide an `edit` implementation which responds to the `EditRequest` induced by the [`importance`][genjax.core.GenerativeFunction.importance] interface).</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">            This method is similar to density evaluation interfaces for distributions.</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">            from genjax import normal</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">            from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">            sample = C.v(1.0)</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">            score, retval = normal.assess(sample, (1.0, 1.0))</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">            print((score, retval))</span>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">            ```</span>
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456"></a>
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            But it also works with generative functions that sample from spaces with more structure:</span>
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458"></a>
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">            from genjax import gen</span>
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">            from genjax import normal</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">            @gen</span>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">            def model():</span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">                v1 = normal(0.0, 1.0) @ &quot;v1&quot;</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">                v2 = normal(v1, 1.0) @ &quot;v2&quot;</span>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">            sample = C.kw(v1=1.0, v2=0.0)</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">            score, retval = model.assess(sample, ())</span>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">            print((score, retval))</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            ```</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">constraint</span><span class="p">:</span> <span class="n">ChoiceMap</span><span class="p">,</span>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Weight</span><span class="p">]:</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="k">pass</span>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">trace</span><span class="p">:</span> <span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="n">selection</span><span class="p">:</span> <span class="n">Selection</span><span class="p">,</span>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Weight</span><span class="p">:</span>
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="k">pass</span>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494"></a>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">edit</span><span class="p">(</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">trace</span><span class="p">:</span> <span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span>
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="n">edit_request</span><span class="p">:</span> <span class="n">EditRequest</span><span class="p">,</span>
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">argdiffs</span><span class="p">:</span> <span class="n">Argdiffs</span><span class="p">,</span>
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Weight</span><span class="p">,</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">EditRequest</span><span class="p">]:</span>
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        Update a trace in response to an [`EditRequest`][genjax.core.EditRequest], returning a new [`Trace`][genjax.core.Trace], an incremental [`Weight`][genjax.core.Weight] for the new target, a [`Retdiff`][genjax.core.Retdiff] return value tagged with change information, and a backward [`EditRequest`][genjax.core.EditRequest] which requests the reverse move (to go back to the original trace).</span>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505"></a>
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        The specification of this interface is parametric over the kind of `EditRequest` -- responding to an `EditRequest` instance requires that the generative function provides an implementation of a sequential Monte Carlo move in the [SMCP3](https://proceedings.mlr.press/v206/lew23a.html) framework. Users of inference algorithms are not expected to understand the ingredients, but inference algorithm developers are.</span>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507"></a>
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">            Updating a trace in response to a request for a [`Target`][genjax.inference.Target] change induced by a change to the arguments:</span>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">            ```python exec=&quot;yes&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">            import jax</span>
</span><span id="__span-0-512"><a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">            from genjax import gen, normal, Diff, Update, ChoiceMap as C</span>
</span><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            @gen</span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">            def model(var):</span>
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">                v1 = normal(0.0, 1.0) @ &quot;v1&quot;</span>
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">                v2 = normal(v1, var) @ &quot;v2&quot;</span>
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">                return v2</span>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">            # Generating an initial trace properly weighted according</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            # to the target induced by the constraint.</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            constraint = C.kw(v2=1.0)</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">            initial_tr, w = model.importance(key, constraint, (1.0,))</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            # Updating the trace to a new target.</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">            new_tr, inc_w, retdiff, bwd_prob = model.edit(</span>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">                key,</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">                initial_tr,</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">                Update(</span>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">                    C.empty(),</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">                ),</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">                Diff.unknown_change((3.0,)),</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            )</span>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">            ```</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">            Now, let&#39;s inspect the trace:</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            # Inspect the trace, the sampled values should not have changed!</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">            sample = new_tr.get_choices()</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">            print(sample[&quot;v1&quot;], sample[&quot;v2&quot;])</span>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">            ```</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">            And the return value diff:</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">            # The return value also should not have changed!</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">            print(retdiff.render_html())</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">            ```</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            As expected, neither have changed -- but the weight is non-zero:</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">            print(w)</span>
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">            ```</span>
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557"></a>
</span><span id="__span-0-558"><a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        ## Mathematical ingredients behind edit</span>
</span><span id="__span-0-559"><a id="__codelineno-0-559" name="__codelineno-0-559"></a>
</span><span id="__span-0-560"><a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">        The `edit` interface exposes [SMCP3 moves](https://proceedings.mlr.press/v206/lew23a.html). Here, we omit the measure theoretic description, and refer interested readers to [the paper](https://proceedings.mlr.press/v206/lew23a.html). Informally, the ingredients of such a move are:</span>
</span><span id="__span-0-561"><a id="__codelineno-0-561" name="__codelineno-0-561"></a>
</span><span id="__span-0-562"><a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">        * The previous target $T$.</span>
</span><span id="__span-0-563"><a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">        * The new target $T&#39;$.</span>
</span><span id="__span-0-564"><a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">        * A pair of kernel probabilistic programs, called $K$ and $L$:</span>
</span><span id="__span-0-565"><a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">            * The K kernel is a kernel probabilistic program which accepts a previous sample $x_{t-1}$ from $T$ as an argument, may sample auxiliary randomness $u_K$, and returns a new sample $x_t$ approximately distributed according to $T&#39;$, along with transformed randomness $u_L$.</span>
</span><span id="__span-0-566"><a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">            * The L kernel is a kernel probabilistic program which accepts the new sample $x_t$, and provides a density evaluator for the auxiliary randomness $u_L$ which K returns, and an inverter $x_t \\mapsto x_{t-1}$ which is _almost everywhere_ the identity function.</span>
</span><span id="__span-0-567"><a id="__codelineno-0-567" name="__codelineno-0-567"></a>
</span><span id="__span-0-568"><a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">        The specification of these ingredients are encapsulated in the type signature of the `edit` interface.</span>
</span><span id="__span-0-569"><a id="__codelineno-0-569" name="__codelineno-0-569"></a>
</span><span id="__span-0-570"><a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        ## Understanding the `edit` interface</span>
</span><span id="__span-0-571"><a id="__codelineno-0-571" name="__codelineno-0-571"></a>
</span><span id="__span-0-572"><a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">        The `edit` interface uses the mathematical ingredients described above to perform probability-aware mutations and incremental [`Weight`][genjax.core.Weight] computations on [`Trace`][genjax.core.Trace] instances, which allows Gen to provide automation to support inference agorithms like importance sampling, SMC, MCMC and many more.</span>
</span><span id="__span-0-573"><a id="__codelineno-0-573" name="__codelineno-0-573"></a>
</span><span id="__span-0-574"><a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">        An `EditRequest` denotes a function $tr \\mapsto (T, T&#39;)$ from traces to a pair of targets (the previous [`Target`][genjax.inference.Target] $T$, and the final [`Target`][genjax.inference.Target] $T&#39;$).</span>
</span><span id="__span-0-575"><a id="__codelineno-0-575" name="__codelineno-0-575"></a>
</span><span id="__span-0-576"><a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        Several common types of moves can be requested via the `Update` type:</span>
</span><span id="__span-0-577"><a id="__codelineno-0-577" name="__codelineno-0-577"></a>
</span><span id="__span-0-578"><a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        ```python exec=&quot;yes&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-579"><a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        from genjax import Update</span>
</span><span id="__span-0-580"><a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        from genjax import ChoiceMap</span>
</span><span id="__span-0-581"><a id="__codelineno-0-581" name="__codelineno-0-581"></a>
</span><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        g = Update(</span>
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">            ChoiceMap.empty(),  # Constraint</span>
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        )</span>
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        ```</span>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        `Update` contains information about changes to the arguments of the generative function ([`Argdiffs`][genjax.core.Argdiffs]) and a constraint which specifies an additional move to be performed.</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        new_tr, inc_w, retdiff, bwd_prob = model.edit(</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">            key,</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">            initial_tr,</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">            Update(</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">                C.kw(v1=3.0),</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">            ),</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">            Diff.unknown_change((3.0,)),</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">        )</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">        print((new_tr.get_choices()[&quot;v1&quot;], w))</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">        ```</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">        **Additional notes on [`Argdiffs`][genjax.core.Argdiffs]**</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        Argument changes induce changes to the distribution over samples, internal K and L proposals, and (by virtue of changes to $P$) target distributions. The [`Argdiffs`][genjax.core.Argdiffs] type denotes the type of values attached with a _change type_, a piece of data which indicates how the value has changed from the arguments which created the trace. Generative functions can utilize change type information to inform efficient [`edit`][genjax.core.GenerativeFunction.edit] implementations.</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="k">pass</span>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="c1">######################</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="c1"># Derived interfaces #</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a>    <span class="c1">######################</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">trace</span><span class="p">:</span> <span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="n">constraint</span><span class="p">:</span> <span class="n">ChoiceMap</span><span class="p">,</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="n">argdiffs</span><span class="p">:</span> <span class="n">Argdiffs</span><span class="p">,</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Weight</span><span class="p">,</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">ChoiceMap</span><span class="p">]:</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="n">request</span> <span class="o">=</span> <span class="n">Update</span><span class="p">(</span>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="n">constraint</span><span class="p">,</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="p">)</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="n">tr</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">rd</span><span class="p">,</span> <span class="n">bwd</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a>            <span class="n">trace</span><span class="p">,</span>
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624"></a>            <span class="n">argdiffs</span><span class="p">,</span>
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="p">)</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bwd</span><span class="p">,</span> <span class="n">Update</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">bwd</span><span class="p">)</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="k">return</span> <span class="n">tr</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">rd</span><span class="p">,</span> <span class="n">bwd</span><span class="o">.</span><span class="n">constraint</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">importance</span><span class="p">(</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="n">constraint</span><span class="p">:</span> <span class="n">ChoiceMap</span><span class="p">,</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Weight</span><span class="p">]:</span>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">        Returns a properly weighted pair, a [`Trace`][genjax.core.Trace] and a [`Weight`][genjax.core.Weight], properly weighted for the target induced by the generative function for the provided constraint and arguments.</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">            (**Full constraints**) A simple example using the `importance` interface on distributions:</span>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            import jax</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            from genjax import normal</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">            tr, w = normal.importance(key, C.v(1.0), (0.0, 1.0))</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">            print(tr.get_choices().render_html())</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">            ```</span>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            (**Internal proposal for partial constraints**) Specifying a _partial_ constraint on a [`StaticGenerativeFunction`][genjax.StaticGenerativeFunction]:</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">            from genjax import flip, uniform, gen</span>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">            @gen</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">            def model():</span>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">                p = uniform(0.0, 1.0) @ &quot;p&quot;</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">                f1 = flip(p) @ &quot;f1&quot;</span>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">                f2 = flip(p) @ &quot;f2&quot;</span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">            tr, w = model.importance(key, C.kw(f1=True, f2=True), ())</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">            print(tr.get_choices().render_html())</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">            ```</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        Under the hood, creates an [`EditRequest`][genjax.core.EditRequest] which requests that the generative function respond with a move from the _empty_ trace (the only possible value for _empty_ target $\\delta_\\emptyset$) to the target induced by the generative function for constraint $C$ with arguments $a$.</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="n">constraint</span><span class="p">,</span>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="n">args</span><span class="p">,</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="p">)</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">propose</span><span class="p">(</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ChoiceMap</span><span class="p">,</span> <span class="n">Score</span><span class="p">,</span> <span class="n">R</span><span class="p">]:</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">        Samples a [`ChoiceMap`][genjax.core.ChoiceMap] and any untraced randomness $r$ from the generative function&#39;s distribution over samples ($P$), and returns the [`Score`][genjax.core.Score] of that sample under the distribution, and the `R` of the generative function&#39;s return value function $f(r, t, a)$ for the sample and untraced randomness.</span>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-685"><a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</span><span id="__span-0-686"><a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="n">sample</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span>
</span><span id="__span-0-687"><a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="n">score</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_score</span><span class="p">()</span>
</span><span id="__span-0-688"><a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="n">retval</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_retval</span><span class="p">()</span>
</span><span id="__span-0-689"><a id="__codelineno-0-689" name="__codelineno-0-689"></a>        <span class="k">return</span> <span class="n">sample</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">retval</span>
</span><span id="__span-0-690"><a id="__codelineno-0-690" name="__codelineno-0-690"></a>
</span><span id="__span-0-691"><a id="__codelineno-0-691" name="__codelineno-0-691"></a>    <span class="c1">######################################################</span>
</span><span id="__span-0-692"><a id="__codelineno-0-692" name="__codelineno-0-692"></a>    <span class="c1"># Convenience: postfix syntax for combinators / DSLs #</span>
</span><span id="__span-0-693"><a id="__codelineno-0-693" name="__codelineno-0-693"></a>    <span class="c1">######################################################</span>
</span><span id="__span-0-694"><a id="__codelineno-0-694" name="__codelineno-0-694"></a>
</span><span id="__span-0-695"><a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="c1">###############</span>
</span><span id="__span-0-696"><a id="__codelineno-0-696" name="__codelineno-0-696"></a>    <span class="c1"># Combinators #</span>
</span><span id="__span-0-697"><a id="__codelineno-0-697" name="__codelineno-0-697"></a>    <span class="c1">###############</span>
</span><span id="__span-0-698"><a id="__codelineno-0-698" name="__codelineno-0-698"></a>
</span><span id="__span-0-699"><a id="__codelineno-0-699" name="__codelineno-0-699"></a>    <span class="c1"># TODO think through, or note, that the R that comes out will have to be bounded by pytree.</span>
</span><span id="__span-0-700"><a id="__codelineno-0-700" name="__codelineno-0-700"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">vmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">in_axes</span><span class="p">:</span> <span class="n">InAxes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-701"><a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-702"><a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">        Returns a [`GenerativeFunction`][genjax.GenerativeFunction] that performs a vectorized map over the argument specified by `in_axes`. Traced values are nested under an index, and the retval is vectorized.</span>
</span><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703"></a>
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">        Args:</span>
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">            in_axes: Selector specifying which input arguments (or index into them) should be vectorized. Defaults to 0, i.e., the first argument. See [this link](https://jax.readthedocs.io/en/latest/pytrees.html#applying-optional-parameters-to-pytrees) for more detail.</span>
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706"></a>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">            A new [`GenerativeFunction`][genjax.GenerativeFunction] that accepts an argument of one-higher dimension at the position specified by `in_axes`.</span>
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709"></a>
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;gen-fn&quot;</span>
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">            import jax</span>
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">            import jax.numpy as jnp</span>
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715"></a>
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716"></a>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">            def model(x):</span>
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">                v = genjax.normal(x, 1.0) @ &quot;v&quot;</span>
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">                return genjax.normal(v, 0.01) @ &quot;q&quot;</span>
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721"></a>
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722"></a>
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">            vmapped = model.vmap(in_axes=0)</span>
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724"></a>
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">            arr = jnp.ones(100)</span>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727"></a>
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">            # `vmapped` accepts an array if numbers instead of the original</span>
</span><span id="__span-0-729"><a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">            # single number that `model` accepted.</span>
</span><span id="__span-0-730"><a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">            tr = jax.jit(vmapped.simulate)(key, (arr,))</span>
</span><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731"></a>
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">            ```</span>
</span><span id="__span-0-734"><a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-735"><a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-736"><a id="__codelineno-0-736" name="__codelineno-0-736"></a>
</span><span id="__span-0-737"><a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">in_axes</span><span class="o">=</span><span class="n">in_axes</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-738"><a id="__codelineno-0-738" name="__codelineno-0-738"></a>
</span><span id="__span-0-739"><a id="__codelineno-0-739" name="__codelineno-0-739"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-740"><a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-741"><a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">        Returns a [`genjax.GenerativeFunction`][] that samples from `self` `n` times, returning a vector of `n` results.</span>
</span><span id="__span-0-742"><a id="__codelineno-0-742" name="__codelineno-0-742"></a>
</span><span id="__span-0-743"><a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">        The values traced by each call `gen_fn` will be nested under an integer index that matches the loop iteration index that generated it.</span>
</span><span id="__span-0-744"><a id="__codelineno-0-744" name="__codelineno-0-744"></a>
</span><span id="__span-0-745"><a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">        This combinator is useful for creating multiple samples from `self` in a batched manner.</span>
</span><span id="__span-0-746"><a id="__codelineno-0-746" name="__codelineno-0-746"></a>
</span><span id="__span-0-747"><a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">        Args:</span>
</span><span id="__span-0-748"><a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">            n: The number of times to sample from the generative function.</span>
</span><span id="__span-0-749"><a id="__codelineno-0-749" name="__codelineno-0-749"></a>
</span><span id="__span-0-750"><a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-751"><a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">            A new [`genjax.GenerativeFunction`][] that samples from the original function `n` times.</span>
</span><span id="__span-0-752"><a id="__codelineno-0-752" name="__codelineno-0-752"></a>
</span><span id="__span-0-753"><a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-754"><a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;repeat&quot;</span>
</span><span id="__span-0-755"><a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">            import genjax, jax</span>
</span><span id="__span-0-756"><a id="__codelineno-0-756" name="__codelineno-0-756"></a>
</span><span id="__span-0-757"><a id="__codelineno-0-757" name="__codelineno-0-757"></a>
</span><span id="__span-0-758"><a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-759"><a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">            def normal_draw(mean):</span>
</span><span id="__span-0-760"><a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">                return genjax.normal(mean, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-761"><a id="__codelineno-0-761" name="__codelineno-0-761"></a>
</span><span id="__span-0-762"><a id="__codelineno-0-762" name="__codelineno-0-762"></a>
</span><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">            normal_draws = normal_draw.repeat(n=10)</span>
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764"></a>
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766"></a>
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">            # Generate 10 draws from a normal distribution with mean 2.0</span>
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">            tr = jax.jit(normal_draws.simulate)(key, (2.0,))</span>
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">            ```</span>
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773"></a>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-775"><a id="__codelineno-0-775" name="__codelineno-0-775"></a>
</span><span id="__span-0-776"><a id="__codelineno-0-776" name="__codelineno-0-776"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scan</span><span class="p">(</span>
</span><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;GenerativeFunction[tuple[Carry, Y]]&quot;</span><span class="p">,</span>
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[tuple[Carry, Y]]&quot;</span><span class="p">:</span>
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">        When called on a [`genjax.GenerativeFunction`][] of type `(c, a) -&gt; (c, b)`, returns a new [`genjax.GenerativeFunction`][] of type `(c, [a]) -&gt; (c, [b])` where</span>
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784"></a>
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">        - `c` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">        - `a` may be a primitive, an array type or a pytree (container) type with array leaves</span>
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">        - `b` may be a primitive, an array type or a pytree (container) type with array leaves.</span>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788"></a>
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">        The values traced by each call to the original generative function will be nested under an integer index that matches the loop iteration index that generated it.</span>
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790"></a>
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">        For any array type specifier `t`, `[t]` represents the type with an additional leading axis, and if `t` is a pytree (container) type with array leaves then `[t]` represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</span>
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792"></a>
</span><span id="__span-0-793"><a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">        When the type of `xs` in the snippet below (denoted `[a]` above) is an array type or None, and the type of `ys` in the snippet below (denoted `[b]` above) is an array type, the semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation:</span>
</span><span id="__span-0-794"><a id="__codelineno-0-794" name="__codelineno-0-794"></a>
</span><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        ```python</span>
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">        def scan(f, init, xs, length=None):</span>
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">            if xs is None:</span>
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">                xs = [None] * length</span>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">            carry = init</span>
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">            ys = []</span>
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">            for x in xs:</span>
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">                carry, y = f(carry, x)</span>
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">                ys.append(y)</span>
</span><span id="__span-0-804"><a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">            return carry, np.stack(ys)</span>
</span><span id="__span-0-805"><a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">        ```</span>
</span><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806"></a>
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">        Unlike that Python version, both `xs` and `ys` may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays. `None` is actually a special case of this, as it represents an empty pytree.</span>
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808"></a>
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">        The loop-carried value `c` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `c` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810"></a>
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">        Args:</span>
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">            n: optional integer specifying the number of loop iterations, which (if supplied) must agree with the sizes of leading axes of the arrays in the returned function&#39;s second argument. If supplied then the returned generative function can take `None` as its second argument.</span>
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813"></a>
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">            A new [`genjax.GenerativeFunction`][] that takes a loop-carried value and a new input, and returns a new loop-carried value along with either `None` or an output to be collected into the second return value.</span>
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816"></a>
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">            Scan for 1000 iterations with no array input:</span>
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">            import jax</span>
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822"></a>
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823"></a>
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">            def random_walk_step(prev, _):</span>
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">                x = genjax.normal(prev, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">                return x, None</span>
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828"></a>
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829"></a>
</span><span id="__span-0-830"><a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">            random_walk = random_walk_step.scan(n=1000)</span>
</span><span id="__span-0-831"><a id="__codelineno-0-831" name="__codelineno-0-831"></a>
</span><span id="__span-0-832"><a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">            init = 0.5</span>
</span><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834"></a>
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">            tr = jax.jit(random_walk.simulate)(key, (init, None))</span>
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">            ```</span>
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838"></a>
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">            Scan across an input array:</span>
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">            import jax.numpy as jnp</span>
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842"></a>
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843"></a>
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">            def add_and_square_step(sum, x):</span>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">                new_sum = sum + x</span>
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">                return new_sum, sum * sum</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">            # notice no `n` parameter supplied:</span>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">            add_and_square_all = add_and_square_step.scan()</span>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">            init = 0.0</span>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">            xs = jnp.ones(10)</span>
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">            tr = jax.jit(add_and_square_all.simulate)(key, (init, xs))</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">            # The retval has the final carry and an array of all `sum*sum` returned.</span>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">            ```</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862"></a>
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-864"><a id="__codelineno-0-864" name="__codelineno-0-864"></a>
</span><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-866"><a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-867"><a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">        When called on a [`genjax.GenerativeFunction`][] of type `(c, a) -&gt; c`, returns a new [`genjax.GenerativeFunction`][] of type `(c, [a]) -&gt; [c]` where</span>
</span><span id="__span-0-868"><a id="__codelineno-0-868" name="__codelineno-0-868"></a>
</span><span id="__span-0-869"><a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">        - `c` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-870"><a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">        - `[c]` is an array of all loop-carried values seen during iteration (including the first)</span>
</span><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">        - `a` may be a primitive, an array type or a pytree (container) type with array leaves</span>
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872"></a>
</span><span id="__span-0-873"><a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">        All traced values are nested under an index.</span>
</span><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874"></a>
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">        For any array type specifier `t`, `[t]` represents the type with an additional leading axis, and if `t` is a pytree (container) type with array leaves then `[t]` represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</span>
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876"></a>
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        The semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation (note the similarity to [`itertools.accumulate`](https://docs.python.org/3/library/itertools.html#itertools.accumulate)):</span>
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878"></a>
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">        ```python</span>
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        def accumulate(f, init, xs):</span>
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">            carry = init</span>
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">            carries = [init]</span>
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">            for x in xs:</span>
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">                carry = f(carry, x)</span>
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">                carries.append(carry)</span>
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">            return carries</span>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        ```</span>
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888"></a>
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">        Unlike that Python version, both `xs` and `carries` may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays.</span>
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890"></a>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">        The loop-carried value `c` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `c` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892"></a>
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">            import jax</span>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">            import jax.numpy as jnp</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">            @genjax.accumulate()</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">            def add(sum, x):</span>
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">                new_sum = sum + x</span>
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">                return new_sum</span>
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">            init = 0.0</span>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">            xs = jnp.ones(10)</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">            tr = jax.jit(add.simulate)(key, (init, xs))</span>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">            ```</span>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916"></a>
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">accumulate</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918"></a>
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        When called on a [`genjax.GenerativeFunction`][] of type `(c, a) -&gt; c`, returns a new [`genjax.GenerativeFunction`][] of type `(c, [a]) -&gt; c` where</span>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        - `c` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        - `a` may be a primitive, an array type or a pytree (container) type with array leaves</span>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">        All traced values are nested under an index.</span>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        For any array type specifier `t`, `[t]` represents the type with an additional leading axis, and if `t` is a pytree (container) type with array leaves then `[t]` represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</span>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        The semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation (note the similarity to [`functools.reduce`](https://docs.python.org/3/library/itertools.html#functools.reduce)):</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a>
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">        ```python</span>
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">        def reduce(f, init, xs):</span>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            carry = init</span>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            for x in xs:</span>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">                carry = f(carry, x)</span>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            return carry</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">        ```</span>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        Unlike that Python version, both `xs` and `carry` may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays.</span>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        The loop-carried value `c` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `c` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            sum an array of numbers:</span>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">            import jax</span>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            import jax.numpy as jnp</span>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a>
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">            @genjax.reduce()</span>
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">            def add(sum, x):</span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">                new_sum = sum + x</span>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">                return new_sum</span>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">            init = 0.0</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">            xs = jnp.ones(10)</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">            tr = jax.jit(add.simulate)(key, (init, xs))</span>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">            ```</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968"></a>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">reduce</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">iterate</span><span class="p">(</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        When called on a [`genjax.GenerativeFunction`][] of type `a -&gt; a`, returns a new [`genjax.GenerativeFunction`][] of type `a -&gt; [a]` where</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">        - `a` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">        - `[a]` is an array of all `a`, `f(a)`, `f(f(a))` etc. values seen during iteration.</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a>
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        All traced values are nested under an index.</span>
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        The semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation:</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        ```python</span>
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">        def iterate(f, n, init):</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">            input = init</span>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">            seen = [init]</span>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">            for _ in range(n):</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">                input = f(input)</span>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">                seen.append(input)</span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">            return seen</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">        ```</span>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">        `init` may be an arbitrary pytree value, and so multiple arrays can be iterated over at once and produce multiple output arrays.</span>
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998"></a>
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        The iterated value `a` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `a` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">            n: the number of iterations to run.</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">            iterative addition, returning all intermediate sums:</span>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">            import jax</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">            @genjax.iterate(n=100)</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">            def inc(x):</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">                return x + 1</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">            init = 0.0</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">            tr = jax.jit(inc.simulate)(key, (init,))</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">            ```</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">iterate_final</span><span class="p">(</span>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        Returns a decorator that wraps a [`genjax.GenerativeFunction`][] of type `a -&gt; a` and returns a new [`genjax.GenerativeFunction`][] of type `a -&gt; a` where</span>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">        - `a` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">        - the original function is invoked `n` times with each input coming from the previous invocation&#39;s output, so that the new function returns $f^n(a)$</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">        All traced values are nested under an index.</span>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">        The semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation:</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">        ```python</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">        def iterate_final(f, n, init):</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">            ret = init</span>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">            for _ in range(n):</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">                ret = f(ret)</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">            return ret</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">        ```</span>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        `init` may be an arbitrary pytree value, and so multiple arrays can be iterated over at once and produce multiple output arrays.</span>
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        The iterated value `a` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `a` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">            n: the number of iterations to run.</span>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">            iterative addition:</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">            import jax</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>
</span><span id="__span-0-1066"><a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">            @genjax.iterate_final(n=100)</span>
</span><span id="__span-0-1067"><a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1068"><a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">            def inc(x):</span>
</span><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">                return x + 1</span>
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">            init = 0.0</span>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">            tr = jax.jit(inc.simulate)(key, (init,))</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">            ```</span>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">iterate_final</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">masked_iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        Transforms a generative function that takes a single argument of type `a` and returns a value of type `a`, into a function that takes a tuple of arguments `(a, [mask])` and returns a list of values of type `a`.</span>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">        The original function is modified to accept an additional argument `mask`, which is a boolean value indicating whether the operation should be masked or not. The function returns a Masked list of results of the original operation with the input [mask] as mask.</span>
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        All traced values from the kernel generative function are traced (with an added axis due to the scan) but only those indices from [mask] with a flag of True will accounted for in inference, notably for score computations.</span>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">            import jax</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">            masks = jnp.array([True, False, True])</span>
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">            # Create a kernel generative function</span>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">            def step(x):</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">                _ = (</span>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">                    genjax.normal.mask().vmap(in_axes=(0, None, None))(masks, x, 1.0)</span>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">                    @ &quot;rats&quot;</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">                )</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">                return x</span>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">            # Create a model using masked_iterate</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">            model = step.masked_iterate()</span>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">            # Simulate from the model</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">            mask_steps = jnp.arange(10) &lt; 5</span>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            tr = model.simulate(key, (0.0, mask_steps))</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">            ```</span>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">masked_iterate</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">masked_iterate_final</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">        Transforms a generative function that takes a single argument of type `a` and returns a value of type `a`, into a function that takes a tuple of arguments `(a, [mask])` and returns a value of type `a`.</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">        The original function is modified to accept an additional argument `mask`, which is a boolean value indicating whether the operation should be masked or not. The function returns the result of the original operation if `mask` is `True`, and the original input if `mask` is `False`.</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">        All traced values from the kernel generative function are traced (with an added axis due to the scan) but only those indices from [mask] with a flag of True will accounted for in inference, notably for score computations.</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">            import jax</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">            masks = jnp.array([True, False, True])</span>
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">            # Create a kernel generative function</span>
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">            def step(x):</span>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">                _ = (</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">                    genjax.normal.mask().vmap(in_axes=(0, None, None))(masks, x, 1.0)</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">                    @ &quot;rats&quot;</span>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">                )</span>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">                return x</span>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">            # Create a model using masked_iterate_final</span>
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">            model = step.masked_iterate_final()</span>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">            # Simulate from the model</span>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">            mask_steps = jnp.arange(10) &lt; 5</span>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">            tr = model.simulate(key, (0.0, mask_steps))</span>
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">            ```</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">masked_iterate_final</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[genjax.Mask[R]]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">        Enables dynamic masking of generative functions. Returns a new [`genjax.GenerativeFunction`][] like `self`, but which accepts an additional boolean first argument.</span>
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">        If `True`, the invocation of `self` is masked, and its contribution to the score is ignored. If `False`, it has the same semantics as if one was invoking `self` without masking.</span>
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">        The return value type is a `Mask`, with a flag value equal to the supplied boolean.</span>
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="sd">            The masked version of the original [`genjax.GenerativeFunction`][].</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">            Masking a normal draw:</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;mask&quot;</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">            import genjax, jax</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><span class="sd">            def normal_draw(mean):</span>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">                return genjax.normal(mean, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">            masked_normal_draw = normal_draw.mask()</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">            tr = jax.jit(masked_normal_draw.simulate)(</span>
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">                key,</span>
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">                (</span>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">                    False,</span>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">                    2.0,</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">                ),</span>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">            )</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">            ```</span>
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">or_else</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gen_fn</span><span class="p">:</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">        Returns a [`GenerativeFunction`][genjax.GenerativeFunction] that accepts</span>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">        - a boolean argument</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">        - an argument tuple for `self`</span>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">        - an argument tuple for the supplied `gen_fn`</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">        and acts like `self` when the boolean is `True` or like `gen_fn` otherwise.</span>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">            gen_fn: called when the boolean argument is `False`.</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;gen-fn&quot;</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">            import jax</span>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">            import jax.numpy as jnp</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">            def if_model(x):</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">                return genjax.normal(x, 1.0) @ &quot;if_value&quot;</span>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">            def else_model(x):</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">                return genjax.normal(x, 5.0) @ &quot;else_value&quot;</span>
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">            def model(toss: bool):</span>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">                # Note that the returned model takes a new boolean predicate in</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">                # addition to argument tuples for each branch.</span>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">                return if_model.or_else(else_model)(toss, (1.0,), (10.0,)) @ &quot;tossed&quot;</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">            tr = jax.jit(model.simulate)(key, (True,))</span>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">            ```</span>
</span><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">or_else</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gen_fn</span><span class="p">)</span>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">switch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">branches</span><span class="p">:</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;genjax.Switch[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">        Given `n` [`genjax.GenerativeFunction`][] inputs, returns a new [`genjax.GenerativeFunction`][] that accepts `n+2` arguments:</span>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">        - an index in the range $[0, n+1)$</span>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">        - a tuple of arguments for `self` and each of the input generative functions (`n+1` total tuples)</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">        and executes the generative function at the supplied index with its provided arguments.</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">        If `index` is out of bounds, `index` is clamped to within bounds.</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;switch&quot;</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">            import jax, genjax</span>
</span><span id="__span-0-1264"><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
</span><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1267"><a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">            def branch_1():</span>
</span><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">                x = genjax.normal(0.0, 1.0) @ &quot;x1&quot;</span>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">            def branch_2():</span>
</span><span id="__span-0-1273"><a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">                x = genjax.bernoulli(0.3) @ &quot;x2&quot;</span>
</span><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">            switch = branch_1.switch(branch_2)</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-1279"><a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">            jitted = jax.jit(switch.simulate)</span>
</span><span id="__span-0-1280"><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>
</span><span id="__span-0-1281"><a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">            # Select `branch_2` by providing 1:</span>
</span><span id="__span-0-1282"><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">            tr = jitted(key, (1, (), ()))</span>
</span><span id="__span-0-1283"><a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>
</span><span id="__span-0-1284"><a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">            print(tr.render_html())</span>
</span><span id="__span-0-1285"><a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">            ```</span>
</span><span id="__span-0-1286"><a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1287"><a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1288"><a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
</span><span id="__span-0-1289"><a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">branches</span><span class="p">)</span>
</span><span id="__span-0-1290"><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>
</span><span id="__span-0-1291"><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fns</span><span class="p">:</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1292"><a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1293"><a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">        Takes any number of [`genjax.GenerativeFunction`][]s and returns a new [`genjax.GenerativeFunction`][] that represents a mixture model.</span>
</span><span id="__span-0-1294"><a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>
</span><span id="__span-0-1295"><a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">        The returned generative function takes the following arguments:</span>
</span><span id="__span-0-1296"><a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>
</span><span id="__span-0-1297"><a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="sd">        - `mixture_logits`: Logits for the categorical distribution used to select a component.</span>
</span><span id="__span-0-1298"><a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><span class="sd">        - `*args`: Argument tuples for `self` and each of the input generative functions</span>
</span><span id="__span-0-1299"><a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>
</span><span id="__span-0-1300"><a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">        and samples from `self` or one of the input generative functions based on a draw from a categorical distribution defined by the provided mixture logits.</span>
</span><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><span class="sd">            *fns: Variable number of [`genjax.GenerativeFunction`][]s to be mixed with `self`.</span>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">            A new [`genjax.GenerativeFunction`][] representing the mixture model.</span>
</span><span id="__span-0-1307"><a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>
</span><span id="__span-0-1308"><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1309"><a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;mix&quot;</span>
</span><span id="__span-0-1310"><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">            import jax</span>
</span><span id="__span-0-1311"><a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-1312"><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>
</span><span id="__span-0-1313"><a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>
</span><span id="__span-0-1314"><a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">            # Define component generative functions</span>
</span><span id="__span-0-1315"><a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1316"><a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="sd">            def component1(x):</span>
</span><span id="__span-0-1317"><a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="sd">                return genjax.normal(x, 1.0) @ &quot;y&quot;</span>
</span><span id="__span-0-1318"><a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>
</span><span id="__span-0-1319"><a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
</span><span id="__span-0-1320"><a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1321"><a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">            def component2(x):</span>
</span><span id="__span-0-1322"><a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">                return genjax.normal(x, 2.0) @ &quot;y&quot;</span>
</span><span id="__span-0-1323"><a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
</span><span id="__span-0-1324"><a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>
</span><span id="__span-0-1325"><a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">            # Create mixture model</span>
</span><span id="__span-0-1326"><a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">            mixture = component1.mix(component2)</span>
</span><span id="__span-0-1327"><a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
</span><span id="__span-0-1328"><a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">            # Use the mixture model</span>
</span><span id="__span-0-1329"><a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-1330"><a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">            logits = jax.numpy.array([0.3, 0.7])  # Favors component2</span>
</span><span id="__span-0-1331"><a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">            trace = mixture.simulate(key, (logits, (0.0,), (7.0,)))</span>
</span><span id="__span-0-1332"><a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="sd">            print(trace.render_html())</span>
</span><span id="__span-0-1333"><a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">                ```</span>
</span><span id="__span-0-1334"><a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1335"><a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1336"><a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>
</span><span id="__span-0-1337"><a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">mix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fns</span><span class="p">)</span>
</span><span id="__span-0-1338"><a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>
</span><span id="__span-0-1339"><a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dimap</span><span class="p">(</span>
</span><span id="__span-0-1340"><a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1341"><a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-1342"><a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-1343"><a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>        <span class="n">pre</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">ArgTuple</span><span class="p">],</span>
</span><span id="__span-0-1344"><a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>        <span class="n">post</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">ArgTuple</span><span class="p">,</span> <span class="n">R</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
</span><span id="__span-0-1345"><a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[S]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1346"><a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1347"><a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">        Returns a new [`genjax.GenerativeFunction`][] and applies pre- and post-processing functions to its arguments and return value.</span>
</span><span id="__span-0-1348"><a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>
</span><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">        !!! info</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="sd">            Prefer [`genjax.GenerativeFunction.map`][] if you only need to transform the return value, or [`genjax.GenerativeFunction.contramap`][] if you only need to transform the arguments.</span>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="sd">            pre: A callable that preprocesses the arguments before passing them to the wrapped function. Note that `pre` must return a _tuple_ of arguments, not a bare argument. Default is the identity function.</span>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="sd">            post: A callable that postprocesses the return value of the wrapped function. Default is the identity function.</span>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1357"><a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="sd">            A new [`genjax.GenerativeFunction`][] with `pre` and `post` applied.</span>
</span><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;dimap&quot;</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="sd">            import jax, genjax</span>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">            # Define pre- and post-processing functions</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">            def pre_process(x, y):</span>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">                return (x + 1, y * 2)</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
</span><span id="__span-0-1369"><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">            def post_process(args, xformed, retval):</span>
</span><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">                return retval**2</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1374"><a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">            def model(x, y):</span>
</span><span id="__span-0-1375"><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><span class="sd">                return genjax.normal(x, y) @ &quot;z&quot;</span>
</span><span id="__span-0-1376"><a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>
</span><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>
</span><span id="__span-0-1378"><a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="sd">            dimap_model = model.dimap(pre=pre_process, post=post_process)</span>
</span><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">            # Use the dimap model</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a><span class="sd">            trace = dimap_model.simulate(key, (2.0, 3.0))</span>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">            print(trace.render_html())</span>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">            ```</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="n">post</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1390"><a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>
</span><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">R</span><span class="p">],</span> <span class="n">S</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[S]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">        Specialized version of [`genjax.dimap`][] where only the post-processing function is applied.</span>
</span><span id="__span-0-1394"><a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>
</span><span id="__span-0-1395"><a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1396"><a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">            f: A callable that postprocesses the return value of the wrapped function.</span>
</span><span id="__span-0-1397"><a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>
</span><span id="__span-0-1398"><a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1399"><a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="sd">            A [`genjax.GenerativeFunction`][] that acts like `self` with a post-processing function to its return value.</span>
</span><span id="__span-0-1400"><a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>
</span><span id="__span-0-1401"><a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1402"><a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;map&quot;</span>
</span><span id="__span-0-1403"><a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><span class="sd">            import jax, genjax</span>
</span><span id="__span-0-1404"><a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>
</span><span id="__span-0-1405"><a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>
</span><span id="__span-0-1406"><a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><span class="sd">            # Define a post-processing function</span>
</span><span id="__span-0-1407"><a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><span class="sd">            def square(x):</span>
</span><span id="__span-0-1408"><a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><span class="sd">                return x**2</span>
</span><span id="__span-0-1409"><a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>
</span><span id="__span-0-1410"><a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>
</span><span id="__span-0-1411"><a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1412"><a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><span class="sd">            def model(x):</span>
</span><span id="__span-0-1413"><a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><span class="sd">                return genjax.normal(x, 1.0) @ &quot;z&quot;</span>
</span><span id="__span-0-1414"><a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>
</span><span id="__span-0-1415"><a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>
</span><span id="__span-0-1416"><a id="__codelineno-0-1416" name="__codelineno-0-1416"></a><span class="sd">            map_model = model.map(square)</span>
</span><span id="__span-0-1417"><a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>
</span><span id="__span-0-1418"><a id="__codelineno-0-1418" name="__codelineno-0-1418"></a><span class="sd">            # Use the map model</span>
</span><span id="__span-0-1419"><a id="__codelineno-0-1419" name="__codelineno-0-1419"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-1420"><a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><span class="sd">            trace = map_model.simulate(key, (2.0,))</span>
</span><span id="__span-0-1421"><a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>
</span><span id="__span-0-1422"><a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><span class="sd">            print(trace.render_html())</span>
</span><span id="__span-0-1423"><a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="sd">            ```</span>
</span><span id="__span-0-1424"><a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1425"><a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1426"><a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>
</span><span id="__span-0-1427"><a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1428"><a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>
</span><span id="__span-0-1429"><a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">contramap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">ArgTuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1430"><a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1431"><a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><span class="sd">        Specialized version of [`genjax.GenerativeFunction.dimap`][] where only the pre-processing function is applied.</span>
</span><span id="__span-0-1432"><a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>
</span><span id="__span-0-1433"><a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1434"><a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">            f: A callable that preprocesses the arguments of the wrapped function. Note that `f` must return a _tuple_ of arguments, not a bare argument.</span>
</span><span id="__span-0-1435"><a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>
</span><span id="__span-0-1436"><a id="__codelineno-0-1436" name="__codelineno-0-1436"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1437"><a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="sd">            A [`genjax.GenerativeFunction`][] that acts like `self` with a pre-processing function to its arguments.</span>
</span><span id="__span-0-1438"><a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>
</span><span id="__span-0-1439"><a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-1440"><a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;contramap&quot;</span>
</span><span id="__span-0-1441"><a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">            import jax, genjax</span>
</span><span id="__span-0-1442"><a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>
</span><span id="__span-0-1443"><a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>
</span><span id="__span-0-1444"><a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><span class="sd">            # Define a pre-processing function.</span>
</span><span id="__span-0-1445"><a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="sd">            # Note that this function must return a tuple of arguments!</span>
</span><span id="__span-0-1446"><a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="sd">            def add_one(x):</span>
</span><span id="__span-0-1447"><a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><span class="sd">                return (x + 1,)</span>
</span><span id="__span-0-1448"><a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>
</span><span id="__span-0-1449"><a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>
</span><span id="__span-0-1450"><a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1451"><a id="__codelineno-0-1451" name="__codelineno-0-1451"></a><span class="sd">            def model(x):</span>
</span><span id="__span-0-1452"><a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><span class="sd">                return genjax.normal(x, 1.0) @ &quot;z&quot;</span>
</span><span id="__span-0-1453"><a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>
</span><span id="__span-0-1454"><a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>
</span><span id="__span-0-1455"><a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">            contramap_model = model.contramap(add_one)</span>
</span><span id="__span-0-1456"><a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>
</span><span id="__span-0-1457"><a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><span class="sd">            # Use the contramap model</span>
</span><span id="__span-0-1458"><a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><span class="sd">            key = jax.random.key(0)</span>
</span><span id="__span-0-1459"><a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><span class="sd">            trace = contramap_model.simulate(key, (2.0,))</span>
</span><span id="__span-0-1460"><a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>
</span><span id="__span-0-1461"><a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="sd">            print(trace.render_html())</span>
</span><span id="__span-0-1462"><a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">            ```</span>
</span><span id="__span-0-1463"><a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1464"><a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1465"><a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>
</span><span id="__span-0-1466"><a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>        <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">contramap</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1467"><a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>
</span><span id="__span-0-1468"><a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>    <span class="c1">#####################</span>
</span><span id="__span-0-1469"><a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>    <span class="c1"># GenSP / inference #</span>
</span><span id="__span-0-1470"><a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>    <span class="c1">#####################</span>
</span><span id="__span-0-1471"><a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>
</span><span id="__span-0-1472"><a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">marginal</span><span class="p">(</span>
</span><span id="__span-0-1473"><a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1474"><a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-1475"><a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-1476"><a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>        <span class="n">selection</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-1477"><a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>        <span class="n">algorithm</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-1478"><a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;genjax.Marginal[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1479"><a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">marginal</span>
</span><span id="__span-0-1480"><a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>
</span><span id="__span-0-1481"><a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>        <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1482"><a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>            <span class="n">selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="__span-0-1483"><a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>
</span><span id="__span-0-1484"><a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>        <span class="k">return</span> <span class="n">marginal</span><span class="p">(</span><span class="n">selection</span><span class="o">=</span><span class="n">selection</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">algorithm</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.__abstract_call__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__abstract_call__</span>


<a href="#genjax.core.GenerativeFunction.__abstract_call__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__abstract_call__</span><span class="p">(</span><span class="o">*</span><span class="n"><span title="genjax.core.GenerativeFunction.__abstract_call__(*args)">args</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Used to support JAX tracing, although this default implementation involves no
JAX operations (it takes a fixed-key sample from the return value).</p>
<p>Generative functions may customize this to improve compilation time.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="k">def</span><span class="w"> </span><span class="nf">__abstract_call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to support JAX tracing, although this default implementation involves no</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    JAX operations (it takes a fixed-key sample from the return value).</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    Generative functions may customize this to improve compilation time.</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_zero_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">get_retval</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.accumulate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">accumulate</span>


<a href="#genjax.core.GenerativeFunction.accumulate" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">accumulate</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>When called on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, a) -&gt; c</code>, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, [a]) -&gt; [c]</code> where</p>
<ul>
<li><code>c</code> is a loop-carried value, which must hold a fixed shape and dtype across all iterations</li>
<li><code>[c]</code> is an array of all loop-carried values seen during iteration (including the first)</li>
<li><code>a</code> may be a primitive, an array type or a pytree (container) type with array leaves</li>
</ul>
<p>All traced values are nested under an index.</p>
<p>For any array type specifier <code>t</code>, <code>[t]</code> represents the type with an additional leading axis, and if <code>t</code> is a pytree (container) type with array leaves then <code>[t]</code> represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</p>
<p>The semantics of the returned <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> are given roughly by this Python implementation (note the similarity to <a href="https://docs.python.org/3/library/itertools.html#itertools.accumulate"><code>itertools.accumulate</code></a>):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">accumulate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">xs</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">carry</span> <span class="o">=</span> <span class="n">init</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">carries</span> <span class="o">=</span> <span class="p">[</span><span class="n">init</span><span class="p">]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">:</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="n">carry</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">carry</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="n">carries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">carry</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">return</span> <span class="n">carries</span>
</span></code></pre></div>
<p>Unlike that Python version, both <code>xs</code> and <code>carries</code> may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays.</p>
<p>The loop-carried value <code>c</code> must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type <code>c</code> in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">accumulate</span><span class="p">()</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="nb">sum</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">new_sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">x</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">return</span> <span class="n">new_sum</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">init</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">xs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">xs</span><span class="p">))</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_f5205950719b41e39277ec8c26519531" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_f5205950719b41e39277ec8c26519531")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_f5205950719b41e39277ec8c26519531")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="k">def</span><span class="w"> </span><span class="nf">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-866"><a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-867"><a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">    When called on a [`genjax.GenerativeFunction`][] of type `(c, a) -&gt; c`, returns a new [`genjax.GenerativeFunction`][] of type `(c, [a]) -&gt; [c]` where</span>
</span><span id="__span-0-868"><a id="__codelineno-0-868" name="__codelineno-0-868"></a>
</span><span id="__span-0-869"><a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">    - `c` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-870"><a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">    - `[c]` is an array of all loop-carried values seen during iteration (including the first)</span>
</span><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">    - `a` may be a primitive, an array type or a pytree (container) type with array leaves</span>
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872"></a>
</span><span id="__span-0-873"><a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">    All traced values are nested under an index.</span>
</span><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874"></a>
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">    For any array type specifier `t`, `[t]` represents the type with an additional leading axis, and if `t` is a pytree (container) type with array leaves then `[t]` represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</span>
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876"></a>
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    The semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation (note the similarity to [`itertools.accumulate`](https://docs.python.org/3/library/itertools.html#itertools.accumulate)):</span>
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878"></a>
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    ```python</span>
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">    def accumulate(f, init, xs):</span>
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        carry = init</span>
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">        carries = [init]</span>
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">        for x in xs:</span>
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">            carry = f(carry, x)</span>
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">            carries.append(carry)</span>
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">        return carries</span>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">    ```</span>
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888"></a>
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    Unlike that Python version, both `xs` and `carries` may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays.</span>
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890"></a>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">    The loop-carried value `c` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `c` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892"></a>
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">        import jax</span>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">        import jax.numpy as jnp</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        @genjax.accumulate()</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">        def add(sum, x):</span>
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">            new_sum = sum + x</span>
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">            return new_sum</span>
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">        init = 0.0</span>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">        xs = jnp.ones(10)</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">        tr = jax.jit(add.simulate)(key, (init, xs))</span>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">        ```</span>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916"></a>
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">accumulate</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.assess" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">assess</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.GenerativeFunction.assess" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">assess</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax.core.GenerativeFunction.assess(sample)">sample</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span><span class="p">,</span> <span class="n"><span title="genjax.core.GenerativeFunction.assess(args)">args</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Arguments&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Arguments&lt;/code&gt;)" href="#genjax.core.Arguments">Arguments</a></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Score&lt;/code&gt;)" href="#genjax.core.Score">Score</a></span><span class="p">,</span> <span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Return <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_score">the score</a> and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_retval&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_retval">the return value</a> when the generative function is invoked with the provided arguments, and constrained to take the provided sample as the sampled value.</p>
<p>It is an error if the provided sample value is off the support of the distribution over the <code>ChoiceMap</code> type, or otherwise induces a partial constraint on the execution of the generative function (which would require the generative function to provide an <code>edit</code> implementation which responds to the <code>EditRequest</code> induced by the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;importance&lt;/span&gt;" href="#genjax.core.GenerativeFunction.importance"><code>importance</code></a> interface).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>This method is similar to density evaluation interfaces for distributions.
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">normal</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">sample</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">v</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">score</span><span class="p">,</span> <span class="n">retval</span> <span class="o">=</span> <span class="n">normal</span><span class="o">.</span><span class="n">assess</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nb">print</span><span class="p">((</span><span class="n">score</span><span class="p">,</span> <span class="n">retval</span><span class="p">))</span>
</span></code></pre></div>
<div class="result">
(Array(-0.9189385, dtype=float32), 1.0)

</div></p>
<p>But it also works with generative functions that sample from spaces with more structure:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">normal</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nd">@gen</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">():</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">v1</span> <span class="o">=</span> <span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;v1&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">v2</span> <span class="o">=</span> <span class="n">normal</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;v2&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">sample</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">kw</span><span class="p">(</span><span class="n">v1</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">v2</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">score</span><span class="p">,</span> <span class="n">retval</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">assess</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">())</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="nb">print</span><span class="p">((</span><span class="n">score</span><span class="p">,</span> <span class="n">retval</span><span class="p">))</span>
</span></code></pre></div>
<div class="result">
(Array(-2.837877, dtype=float32), None)

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="k">def</span><span class="w"> </span><span class="nf">assess</span><span class="p">(</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">ChoiceMap</span><span class="p">,</span>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Score</span><span class="p">,</span> <span class="n">R</span><span class="p">]:</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">    Return [the score][genjax.core.Trace.get_score] and [the return value][genjax.core.Trace.get_retval] when the generative function is invoked with the provided arguments, and constrained to take the provided sample as the sampled value.</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">    It is an error if the provided sample value is off the support of the distribution over the `ChoiceMap` type, or otherwise induces a partial constraint on the execution of the generative function (which would require the generative function to provide an `edit` implementation which responds to the `EditRequest` induced by the [`importance`][genjax.core.GenerativeFunction.importance] interface).</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        This method is similar to density evaluation interfaces for distributions.</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        from genjax import normal</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        sample = C.v(1.0)</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        score, retval = normal.assess(sample, (1.0, 1.0))</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        print((score, retval))</span>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">        ```</span>
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456"></a>
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        But it also works with generative functions that sample from spaces with more structure:</span>
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458"></a>
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        from genjax import gen</span>
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        from genjax import normal</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        @gen</span>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        def model():</span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">            v1 = normal(0.0, 1.0) @ &quot;v1&quot;</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">            v2 = normal(v1, 1.0) @ &quot;v2&quot;</span>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        sample = C.kw(v1=1.0, v2=0.0)</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        score, retval = model.assess(sample, ())</span>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        print((score, retval))</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        ```</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    &quot;&quot;&quot;</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.contramap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">contramap</span>


<a href="#genjax.core.GenerativeFunction.contramap" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">contramap</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;f&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.contramap(f)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.contramap(f)">f</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="genjax._src.core.generative.generative_function.ArgTuple">ArgTuple</span></span><span class="p">]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Specialized version of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;dimap&lt;/span&gt;" href="#genjax.core.GenerativeFunction.dimap"><code>genjax.GenerativeFunction.dimap</code></a> where only the pre-processing function is applied.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.contramap(f)" class="doc doc-heading doc-heading-parameter">                  <code>f</code>
<a href="#genjax.core.GenerativeFunction.contramap(f)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.Callable">Callable</span>[..., <span title="genjax._src.core.generative.generative_function.ArgTuple">ArgTuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A callable that preprocesses the arguments of the wrapped function. Note that <code>f</code> must return a <em>tuple</em> of arguments, not a bare argument.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that acts like <code>self</code> with a pre-processing function to its arguments.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span><span class="o">,</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Define a pre-processing function.</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Note that this function must return a tuple of arguments!</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_one</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;z&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">contramap_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">contramap</span><span class="p">(</span><span class="n">add_one</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># Use the contramap model</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">trace</span> <span class="o">=</span> <span class="n">contramap_model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,))</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_00318cebf84c4e00b52d986ed326f131" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_00318cebf84c4e00b52d986ed326f131")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_00318cebf84c4e00b52d986ed326f131")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1429"><a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="k">def</span><span class="w"> </span><span class="nf">contramap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">ArgTuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1430"><a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1431"><a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><span class="sd">    Specialized version of [`genjax.GenerativeFunction.dimap`][] where only the pre-processing function is applied.</span>
</span><span id="__span-0-1432"><a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>
</span><span id="__span-0-1433"><a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1434"><a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">        f: A callable that preprocesses the arguments of the wrapped function. Note that `f` must return a _tuple_ of arguments, not a bare argument.</span>
</span><span id="__span-0-1435"><a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>
</span><span id="__span-0-1436"><a id="__codelineno-0-1436" name="__codelineno-0-1436"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1437"><a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="sd">        A [`genjax.GenerativeFunction`][] that acts like `self` with a pre-processing function to its arguments.</span>
</span><span id="__span-0-1438"><a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>
</span><span id="__span-0-1439"><a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1440"><a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;contramap&quot;</span>
</span><span id="__span-0-1441"><a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">        import jax, genjax</span>
</span><span id="__span-0-1442"><a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>
</span><span id="__span-0-1443"><a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>
</span><span id="__span-0-1444"><a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><span class="sd">        # Define a pre-processing function.</span>
</span><span id="__span-0-1445"><a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="sd">        # Note that this function must return a tuple of arguments!</span>
</span><span id="__span-0-1446"><a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="sd">        def add_one(x):</span>
</span><span id="__span-0-1447"><a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><span class="sd">            return (x + 1,)</span>
</span><span id="__span-0-1448"><a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>
</span><span id="__span-0-1449"><a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>
</span><span id="__span-0-1450"><a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1451"><a id="__codelineno-0-1451" name="__codelineno-0-1451"></a><span class="sd">        def model(x):</span>
</span><span id="__span-0-1452"><a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><span class="sd">            return genjax.normal(x, 1.0) @ &quot;z&quot;</span>
</span><span id="__span-0-1453"><a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>
</span><span id="__span-0-1454"><a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>
</span><span id="__span-0-1455"><a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">        contramap_model = model.contramap(add_one)</span>
</span><span id="__span-0-1456"><a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>
</span><span id="__span-0-1457"><a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><span class="sd">        # Use the contramap model</span>
</span><span id="__span-0-1458"><a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-1459"><a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><span class="sd">        trace = contramap_model.simulate(key, (2.0,))</span>
</span><span id="__span-0-1460"><a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>
</span><span id="__span-0-1461"><a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="sd">        print(trace.render_html())</span>
</span><span id="__span-0-1462"><a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">        ```</span>
</span><span id="__span-0-1463"><a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1464"><a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1465"><a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>
</span><span id="__span-0-1466"><a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">contramap</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.dimap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">dimap</span>


<a href="#genjax.core.GenerativeFunction.dimap" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">dimap</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;pre&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.dimap(pre)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.dimap(pre)">pre</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="genjax._src.core.generative.generative_function.ArgTuple">ArgTuple</span></span><span class="p">],</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;post&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.dimap(post)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.dimap(post)">post</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n"><span title="genjax._src.core.generative.generative_function.ArgTuple">ArgTuple</span></span><span class="p">,</span> <span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span> <span class="n"><span title="genjax._src.core.generative.generative_function.S">S</span></span><span class="p">]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.S">S</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> and applies pre- and post-processing functions to its arguments and return value.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Prefer <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;map&lt;/span&gt;" href="#genjax.core.GenerativeFunction.map"><code>genjax.GenerativeFunction.map</code></a> if you only need to transform the return value, or <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;contramap&lt;/span&gt;" href="#genjax.core.GenerativeFunction.contramap"><code>genjax.GenerativeFunction.contramap</code></a> if you only need to transform the arguments.</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.dimap(pre)" class="doc doc-heading doc-heading-parameter">                  <code>pre</code>
<a href="#genjax.core.GenerativeFunction.dimap(pre)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.Callable">Callable</span>[..., <span title="genjax._src.core.generative.generative_function.ArgTuple">ArgTuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A callable that preprocesses the arguments before passing them to the wrapped function. Note that <code>pre</code> must return a <em>tuple</em> of arguments, not a bare argument. Default is the identity function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.dimap(post)" class="doc doc-heading doc-heading-parameter">                  <code>post</code>
<a href="#genjax.core.GenerativeFunction.dimap(post)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.Callable">Callable</span>[[<span title="tuple">tuple</span>[<span title="genjax._src.core.typing.Any">Any</span>, ...], <span title="genjax._src.core.generative.generative_function.ArgTuple">ArgTuple</span>, <span title="genjax._src.core.generative.generative_function.R">R</span>], <span title="genjax._src.core.generative.generative_function.S">S</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A callable that postprocesses the return value of the wrapped function. Default is the identity function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.S">S</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> with <code>pre</code> and <code>post</code> applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span><span class="o">,</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Define pre- and post-processing functions</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">pre_process</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">post_process</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">xformed</span><span class="p">,</span> <span class="n">retval</span><span class="p">):</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">return</span> <span class="n">retval</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;z&quot;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">dimap_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="n">pre_process</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="n">post_process</span><span class="p">)</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="c1"># Use the dimap model</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">trace</span> <span class="o">=</span> <span class="n">dimap_model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="nb">print</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_2c6dd7f9496d46299ef1f0deb078611a" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_2c6dd7f9496d46299ef1f0deb078611a")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_2c6dd7f9496d46299ef1f0deb078611a")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1339"><a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="k">def</span><span class="w"> </span><span class="nf">dimap</span><span class="p">(</span>
</span><span id="__span-0-1340"><a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1341"><a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-1342"><a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-1343"><a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>    <span class="n">pre</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">ArgTuple</span><span class="p">],</span>
</span><span id="__span-0-1344"><a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>    <span class="n">post</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">ArgTuple</span><span class="p">,</span> <span class="n">R</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
</span><span id="__span-0-1345"><a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[S]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1346"><a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1347"><a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">    Returns a new [`genjax.GenerativeFunction`][] and applies pre- and post-processing functions to its arguments and return value.</span>
</span><span id="__span-0-1348"><a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>
</span><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">    !!! info</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="sd">        Prefer [`genjax.GenerativeFunction.map`][] if you only need to transform the return value, or [`genjax.GenerativeFunction.contramap`][] if you only need to transform the arguments.</span>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="sd">        pre: A callable that preprocesses the arguments before passing them to the wrapped function. Note that `pre` must return a _tuple_ of arguments, not a bare argument. Default is the identity function.</span>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="sd">        post: A callable that postprocesses the return value of the wrapped function. Default is the identity function.</span>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1357"><a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="sd">        A new [`genjax.GenerativeFunction`][] with `pre` and `post` applied.</span>
</span><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;dimap&quot;</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="sd">        import jax, genjax</span>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">        # Define pre- and post-processing functions</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">        def pre_process(x, y):</span>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">            return (x + 1, y * 2)</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
</span><span id="__span-0-1369"><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">        def post_process(args, xformed, retval):</span>
</span><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">            return retval**2</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1374"><a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">        def model(x, y):</span>
</span><span id="__span-0-1375"><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><span class="sd">            return genjax.normal(x, y) @ &quot;z&quot;</span>
</span><span id="__span-0-1376"><a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>
</span><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>
</span><span id="__span-0-1378"><a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="sd">        dimap_model = model.dimap(pre=pre_process, post=post_process)</span>
</span><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">        # Use the dimap model</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a><span class="sd">        trace = dimap_model.simulate(key, (2.0, 3.0))</span>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">        print(trace.render_html())</span>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">        ```</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="n">post</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.edit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">edit</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.GenerativeFunction.edit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">edit</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax.core.GenerativeFunction.edit(key)">key</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.PRNGKey">PRNGKey</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><span title="genjax.core.GenerativeFunction.edit(trace)">trace</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.Trace&lt;/code&gt;)" href="#genjax.core.Trace">Trace</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n"><span title="genjax.core.GenerativeFunction.edit(edit_request)">edit_request</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.EditRequest&lt;/code&gt;)" href="#genjax.core.EditRequest">EditRequest</a></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n"><span title="genjax.core.GenerativeFunction.edit(argdiffs)">argdiffs</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Argdiffs&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Argdiffs&lt;/code&gt;)" href="#genjax.core.Argdiffs">Argdiffs</a></span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.Trace&lt;/code&gt;)" href="#genjax.core.Trace">Trace</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Weight&lt;/code&gt;)" href="#genjax.core.Weight">Weight</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Retdiff&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Retdiff&lt;/code&gt;)" href="#genjax.core.Retdiff">Retdiff</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.EditRequest&lt;/code&gt;)" href="#genjax.core.EditRequest">EditRequest</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update a trace in response to an <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a>, returning a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>, an incremental <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Weight"><code>Weight</code></a> for the new target, a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Retdiff&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Retdiff"><code>Retdiff</code></a> return value tagged with change information, and a backward <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a> which requests the reverse move (to go back to the original trace).</p>
<p>The specification of this interface is parametric over the kind of <code>EditRequest</code> -- responding to an <code>EditRequest</code> instance requires that the generative function provides an implementation of a sequential Monte Carlo move in the <a href="https://proceedings.mlr.press/v206/lew23a.html">SMCP3</a> framework. Users of inference algorithms are not expected to understand the ingredients, but inference algorithm developers are.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Updating a trace in response to a request for a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.inference.Target&lt;/span&gt;" href="inference.html#genjax.inference.Target"><code>Target</code></a> change induced by a change to the arguments:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">Diff</span><span class="p">,</span> <span class="n">Update</span><span class="p">,</span> <span class="n">ChoiceMap</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nd">@gen</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">v1</span> <span class="o">=</span> <span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;v1&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">v2</span> <span class="o">=</span> <span class="n">normal</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;v2&quot;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="k">return</span> <span class="n">v2</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="c1"># Generating an initial trace properly weighted according</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c1"># to the target induced by the constraint.</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">constraint</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">kw</span><span class="p">(</span><span class="n">v2</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">initial_tr</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">importance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,))</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1"># Updating the trace to a new target.</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">new_tr</span><span class="p">,</span> <span class="n">inc_w</span><span class="p">,</span> <span class="n">retdiff</span><span class="p">,</span> <span class="n">bwd_prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">initial_tr</span><span class="p">,</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">Update</span><span class="p">(</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="n">C</span><span class="o">.</span><span class="n">empty</span><span class="p">(),</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="p">),</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="n">Diff</span><span class="o">.</span><span class="n">unknown_change</span><span class="p">((</span><span class="mf">3.0</span><span class="p">,)),</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="p">)</span>
</span></code></pre></div>
<div class="result"></div></p>
<p>Now, let's inspect the trace:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Inspect the trace, the sampled values should not have changed!</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">sample</span> <span class="o">=</span> <span class="n">new_tr</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;v1&quot;</span><span class="p">],</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;v2&quot;</span><span class="p">])</span>
</span></code></pre></div>
<div class="result">
-2.4424558 1.0

</div></p>
<p>And the return value diff:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># The return value also should not have changed!</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">retdiff</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_b82ea4041a9e4855b561ef65330ad2df" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_b82ea4041a9e4855b561ef65330ad2df")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_b82ea4041a9e4855b561ef65330ad2df")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
<p>As expected, neither have changed -- but the weight is non-zero:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span></code></pre></div>
<div class="result">
-6.8441896

</div></p>
        <h5 id="genjax.core.GenerativeFunction.edit--mathematical-ingredients-behind-edit">Mathematical ingredients behind edit<a class="headerlink" href="#genjax.core.GenerativeFunction.edit--mathematical-ingredients-behind-edit" title="Permanent link">&para;</a></h5>
<p>The <code>edit</code> interface exposes <a href="https://proceedings.mlr.press/v206/lew23a.html">SMCP3 moves</a>. Here, we omit the measure theoretic description, and refer interested readers to <a href="https://proceedings.mlr.press/v206/lew23a.html">the paper</a>. Informally, the ingredients of such a move are:</p>
<ul>
<li>The previous target <span class="arithmatex">\(T\)</span>.</li>
<li>The new target <span class="arithmatex">\(T'\)</span>.</li>
<li>A pair of kernel probabilistic programs, called <span class="arithmatex">\(K\)</span> and <span class="arithmatex">\(L\)</span>:<ul>
<li>The K kernel is a kernel probabilistic program which accepts a previous sample <span class="arithmatex">\(x_{t-1}\)</span> from <span class="arithmatex">\(T\)</span> as an argument, may sample auxiliary randomness <span class="arithmatex">\(u_K\)</span>, and returns a new sample <span class="arithmatex">\(x_t\)</span> approximately distributed according to <span class="arithmatex">\(T'\)</span>, along with transformed randomness <span class="arithmatex">\(u_L\)</span>.</li>
<li>The L kernel is a kernel probabilistic program which accepts the new sample <span class="arithmatex">\(x_t\)</span>, and provides a density evaluator for the auxiliary randomness <span class="arithmatex">\(u_L\)</span> which K returns, and an inverter <span class="arithmatex">\(x_t \mapsto x_{t-1}\)</span> which is <em>almost everywhere</em> the identity function.</li>
</ul>
</li>
</ul>
<p>The specification of these ingredients are encapsulated in the type signature of the <code>edit</code> interface.</p>
<h5 id="genjax.core.GenerativeFunction.edit--understanding-the-edit-interface">Understanding the <code>edit</code> interface<a class="headerlink" href="#genjax.core.GenerativeFunction.edit--understanding-the-edit-interface" title="Permanent link">&para;</a></h5>
<p>The <code>edit</code> interface uses the mathematical ingredients described above to perform probability-aware mutations and incremental <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Weight"><code>Weight</code></a> computations on <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a> instances, which allows Gen to provide automation to support inference agorithms like importance sampling, SMC, MCMC and many more.</p>
<p>An <code>EditRequest</code> denotes a function <span class="arithmatex">\(tr \mapsto (T, T')\)</span> from traces to a pair of targets (the previous <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.inference.Target&lt;/span&gt;" href="inference.html#genjax.inference.Target"><code>Target</code></a> <span class="arithmatex">\(T\)</span>, and the final <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.inference.Target&lt;/span&gt;" href="inference.html#genjax.inference.Target"><code>Target</code></a> <span class="arithmatex">\(T'\)</span>).</p>
<p>Several common types of moves can be requested via the <code>Update</code> type:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Update</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMap</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">g</span> <span class="o">=</span> <span class="n">Update</span><span class="p">(</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">empty</span><span class="p">(),</span>  <span class="c1"># Constraint</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
</span></code></pre></div>
<div class="result"></div>
<p><code>Update</code> contains information about changes to the arguments of the generative function (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Argdiffs&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Argdiffs"><code>Argdiffs</code></a>) and a constraint which specifies an additional move to be performed.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">new_tr</span><span class="p">,</span> <span class="n">inc_w</span><span class="p">,</span> <span class="n">retdiff</span><span class="p">,</span> <span class="n">bwd_prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">initial_tr</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">Update</span><span class="p">(</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="n">C</span><span class="o">.</span><span class="n">kw</span><span class="p">(</span><span class="n">v1</span><span class="o">=</span><span class="mf">3.0</span><span class="p">),</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="p">),</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">Diff</span><span class="o">.</span><span class="n">unknown_change</span><span class="p">((</span><span class="mf">3.0</span><span class="p">,)),</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nb">print</span><span class="p">((</span><span class="n">new_tr</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()[</span><span class="s2">&quot;v1&quot;</span><span class="p">],</span> <span class="n">w</span><span class="p">))</span>
</span></code></pre></div>
<div class="result">
(3.0, Array(-6.8441896, dtype=float32))

</div>
<p><strong>Additional notes on <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Argdiffs&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Argdiffs"><code>Argdiffs</code></a></strong></p>
<p>Argument changes induce changes to the distribution over samples, internal K and L proposals, and (by virtue of changes to <span class="arithmatex">\(P\)</span>) target distributions. The <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Argdiffs&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Argdiffs"><code>Argdiffs</code></a> type denotes the type of values attached with a <em>change type</em>, a piece of data which indicates how the value has changed from the arguments which created the trace. Generative functions can utilize change type information to inform efficient <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a> implementations.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="k">def</span><span class="w"> </span><span class="nf">edit</span><span class="p">(</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="n">trace</span><span class="p">:</span> <span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span>
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="n">edit_request</span><span class="p">:</span> <span class="n">EditRequest</span><span class="p">,</span>
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="n">argdiffs</span><span class="p">:</span> <span class="n">Argdiffs</span><span class="p">,</span>
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Weight</span><span class="p">,</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">EditRequest</span><span class="p">]:</span>
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">    Update a trace in response to an [`EditRequest`][genjax.core.EditRequest], returning a new [`Trace`][genjax.core.Trace], an incremental [`Weight`][genjax.core.Weight] for the new target, a [`Retdiff`][genjax.core.Retdiff] return value tagged with change information, and a backward [`EditRequest`][genjax.core.EditRequest] which requests the reverse move (to go back to the original trace).</span>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505"></a>
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">    The specification of this interface is parametric over the kind of `EditRequest` -- responding to an `EditRequest` instance requires that the generative function provides an implementation of a sequential Monte Carlo move in the [SMCP3](https://proceedings.mlr.press/v206/lew23a.html) framework. Users of inference algorithms are not expected to understand the ingredients, but inference algorithm developers are.</span>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507"></a>
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">        Updating a trace in response to a request for a [`Target`][genjax.inference.Target] change induced by a change to the arguments:</span>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        ```python exec=&quot;yes&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        import jax</span>
</span><span id="__span-0-512"><a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        from genjax import gen, normal, Diff, Update, ChoiceMap as C</span>
</span><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        @gen</span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        def model(var):</span>
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">            v1 = normal(0.0, 1.0) @ &quot;v1&quot;</span>
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">            v2 = normal(v1, var) @ &quot;v2&quot;</span>
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">            return v2</span>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        # Generating an initial trace properly weighted according</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        # to the target induced by the constraint.</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        constraint = C.kw(v2=1.0)</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        initial_tr, w = model.importance(key, constraint, (1.0,))</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        # Updating the trace to a new target.</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        new_tr, inc_w, retdiff, bwd_prob = model.edit(</span>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            key,</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">            initial_tr,</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            Update(</span>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">                C.empty(),</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">            ),</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">            Diff.unknown_change((3.0,)),</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">        )</span>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        ```</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">        Now, let&#39;s inspect the trace:</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">        # Inspect the trace, the sampled values should not have changed!</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">        sample = new_tr.get_choices()</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        print(sample[&quot;v1&quot;], sample[&quot;v2&quot;])</span>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        ```</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">        And the return value diff:</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">        # The return value also should not have changed!</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">        print(retdiff.render_html())</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">        ```</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">        As expected, neither have changed -- but the weight is non-zero:</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">        print(w)</span>
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        ```</span>
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557"></a>
</span><span id="__span-0-558"><a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    ## Mathematical ingredients behind edit</span>
</span><span id="__span-0-559"><a id="__codelineno-0-559" name="__codelineno-0-559"></a>
</span><span id="__span-0-560"><a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">    The `edit` interface exposes [SMCP3 moves](https://proceedings.mlr.press/v206/lew23a.html). Here, we omit the measure theoretic description, and refer interested readers to [the paper](https://proceedings.mlr.press/v206/lew23a.html). Informally, the ingredients of such a move are:</span>
</span><span id="__span-0-561"><a id="__codelineno-0-561" name="__codelineno-0-561"></a>
</span><span id="__span-0-562"><a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    * The previous target $T$.</span>
</span><span id="__span-0-563"><a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">    * The new target $T&#39;$.</span>
</span><span id="__span-0-564"><a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    * A pair of kernel probabilistic programs, called $K$ and $L$:</span>
</span><span id="__span-0-565"><a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">        * The K kernel is a kernel probabilistic program which accepts a previous sample $x_{t-1}$ from $T$ as an argument, may sample auxiliary randomness $u_K$, and returns a new sample $x_t$ approximately distributed according to $T&#39;$, along with transformed randomness $u_L$.</span>
</span><span id="__span-0-566"><a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">        * The L kernel is a kernel probabilistic program which accepts the new sample $x_t$, and provides a density evaluator for the auxiliary randomness $u_L$ which K returns, and an inverter $x_t \\mapsto x_{t-1}$ which is _almost everywhere_ the identity function.</span>
</span><span id="__span-0-567"><a id="__codelineno-0-567" name="__codelineno-0-567"></a>
</span><span id="__span-0-568"><a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    The specification of these ingredients are encapsulated in the type signature of the `edit` interface.</span>
</span><span id="__span-0-569"><a id="__codelineno-0-569" name="__codelineno-0-569"></a>
</span><span id="__span-0-570"><a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">    ## Understanding the `edit` interface</span>
</span><span id="__span-0-571"><a id="__codelineno-0-571" name="__codelineno-0-571"></a>
</span><span id="__span-0-572"><a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">    The `edit` interface uses the mathematical ingredients described above to perform probability-aware mutations and incremental [`Weight`][genjax.core.Weight] computations on [`Trace`][genjax.core.Trace] instances, which allows Gen to provide automation to support inference agorithms like importance sampling, SMC, MCMC and many more.</span>
</span><span id="__span-0-573"><a id="__codelineno-0-573" name="__codelineno-0-573"></a>
</span><span id="__span-0-574"><a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">    An `EditRequest` denotes a function $tr \\mapsto (T, T&#39;)$ from traces to a pair of targets (the previous [`Target`][genjax.inference.Target] $T$, and the final [`Target`][genjax.inference.Target] $T&#39;$).</span>
</span><span id="__span-0-575"><a id="__codelineno-0-575" name="__codelineno-0-575"></a>
</span><span id="__span-0-576"><a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">    Several common types of moves can be requested via the `Update` type:</span>
</span><span id="__span-0-577"><a id="__codelineno-0-577" name="__codelineno-0-577"></a>
</span><span id="__span-0-578"><a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    ```python exec=&quot;yes&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-579"><a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">    from genjax import Update</span>
</span><span id="__span-0-580"><a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    from genjax import ChoiceMap</span>
</span><span id="__span-0-581"><a id="__codelineno-0-581" name="__codelineno-0-581"></a>
</span><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">    g = Update(</span>
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">        ChoiceMap.empty(),  # Constraint</span>
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">    )</span>
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    ```</span>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">    `Update` contains information about changes to the arguments of the generative function ([`Argdiffs`][genjax.core.Argdiffs]) and a constraint which specifies an additional move to be performed.</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    new_tr, inc_w, retdiff, bwd_prob = model.edit(</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">        key,</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">        initial_tr,</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">        Update(</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">            C.kw(v1=3.0),</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">        ),</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">        Diff.unknown_change((3.0,)),</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">    )</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">    print((new_tr.get_choices()[&quot;v1&quot;], w))</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    ```</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">    **Additional notes on [`Argdiffs`][genjax.core.Argdiffs]**</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">    Argument changes induce changes to the distribution over samples, internal K and L proposals, and (by virtue of changes to $P$) target distributions. The [`Argdiffs`][genjax.core.Argdiffs] type denotes the type of values attached with a _change type_, a piece of data which indicates how the value has changed from the arguments which created the trace. Generative functions can utilize change type information to inform efficient [`edit`][genjax.core.GenerativeFunction.edit] implementations.</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>    <span class="k">pass</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.get_zero_trace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_zero_trace</span>


<a href="#genjax.core.GenerativeFunction.get_zero_trace" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_zero_trace</span><span class="p">(</span><span class="o">*</span><span class="n"><span title="genjax.core.GenerativeFunction.get_zero_trace(*args)">args</span></span><span class="p">,</span> <span class="o">**</span><span class="n"><span title="genjax.core.GenerativeFunction.get_zero_trace(**_kwargs)">_kwargs</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.Trace&lt;/code&gt;)" href="#genjax.core.Trace">Trace</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <div class="language-text highlight"><pre><span></span><code>    Returns a trace with zero values for all leaves, generated without executing the generative function.

    This method is useful for static analysis and shape inference without executing the generative function. It returns a trace with the same structure as a real trace, but filled with zero or default values.

    Args:
        *args: The arguments to the generative function.
        **_kwargs: Ignored keyword arguments.

    Returns:
        A trace with zero values, matching the structure of a real trace.

    Note:
        This method uses the `empty_trace` utility function, which creates a trace without spending any FLOPs. The resulting trace has the correct structure but contains placeholder zero values.

    Example:
        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;
        @genjax.gen
        def weather_model():
            temperature = genjax.normal(20.0, 5.0) @ &quot;temperature&quot;
            is_sunny = genjax.bernoulli(0.7) @ &quot;is_sunny&quot;
            return {&quot;temperature&quot;: temperature, &quot;is_sunny&quot;: is_sunny}


        zero_trace = weather_model.get_zero_trace()
        print(&quot;Zero trace structure:&quot;)
        print(zero_trace.render_html())

        print(&quot;
</code></pre></div>
<p>Actual simulation:")
            key = jax.random.key(0)
            actual_trace = weather_model.simulate(key, ())
            print(actual_trace.render_html())
            ```</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_zero_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">]:</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    Returns a trace with zero values for all leaves, generated without executing the generative function.</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    This method is useful for static analysis and shape inference without executing the generative function. It returns a trace with the same structure as a real trace, but filled with zero or default values.</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    Args:</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        *args: The arguments to the generative function.</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        **_kwargs: Ignored keyword arguments.</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        A trace with zero values, matching the structure of a real trace.</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">    Note:</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        This method uses the `empty_trace` utility function, which creates a trace without spending any FLOPs. The resulting trace has the correct structure but contains placeholder zero values.</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    Example:</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        def weather_model():</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            temperature = genjax.normal(20.0, 5.0) @ &quot;temperature&quot;</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            is_sunny = genjax.bernoulli(0.7) @ &quot;is_sunny&quot;</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            return {&quot;temperature&quot;: temperature, &quot;is_sunny&quot;: is_sunny}</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        zero_trace = weather_model.get_zero_trace()</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        print(&quot;Zero trace structure:&quot;)</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        print(zero_trace.render_html())</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        print(&quot;\nActual simulation:&quot;)</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        actual_trace = weather_model.simulate(key, ())</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        print(actual_trace.render_html())</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        ```</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="k">return</span> <span class="n">empty_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.handle_kwargs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">handle_kwargs</span>


<a href="#genjax.core.GenerativeFunction.handle_kwargs" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">handle_kwargs</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a new GenerativeFunction like <code>self</code>, but where all GFI methods accept a tuple of arguments and a dictionary of keyword arguments.</p>
<p>The returned GenerativeFunction can be invoked with <code>__call__</code> with no special argument handling (just like the original).</p>
<p>In place of <code>args</code> tuples in GFI methods, the new GenerativeFunction expects a 2-tuple containing:</p>
<ol>
<li>A tuple containing the original positional arguments.</li>
<li>A dictionary containing the keyword arguments.</li>
</ol>
<p>This allows for more flexible argument passing, especially useful in contexts where
keyword arguments need to be handled separately or passed through multiple layers.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new GenerativeFunction that accepts (args_tuple, kwargs_dict) for all GFI methods.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">_</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;v&quot;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">kw_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">handle_kwargs</span><span class="p">()</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">kw_model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">}))</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_d78c94da29ca4be5aa2a08dee968df26" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_d78c94da29ca4be5aa2a08dee968df26")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_d78c94da29ca4be5aa2a08dee968df26")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    Returns a new GenerativeFunction like `self`, but where all GFI methods accept a tuple of arguments and a dictionary of keyword arguments.</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    The returned GenerativeFunction can be invoked with `__call__` with no special argument handling (just like the original).</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    In place of `args` tuples in GFI methods, the new GenerativeFunction expects a 2-tuple containing:</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    1. A tuple containing the original positional arguments.</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    2. A dictionary containing the keyword arguments.</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    This allows for more flexible argument passing, especially useful in contexts where</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    keyword arguments need to be handled separately or passed through multiple layers.</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        A new GenerativeFunction that accepts (args_tuple, kwargs_dict) for all GFI methods.</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    Example:</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        import jax</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        def model(x, y, z=1.0):</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            _ = genjax.normal(x + y, z) @ &quot;v&quot;</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            return x + y + z</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        kw_model = model.handle_kwargs()</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        tr = kw_model.simulate(key, ((1.0, 2.0), {&quot;z&quot;: 3.0}))</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        ```</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="k">return</span> <span class="n">IgnoreKwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.importance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">importance</span>


<a href="#genjax.core.GenerativeFunction.importance" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">importance</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax.core.GenerativeFunction.importance(key)">key</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.PRNGKey">PRNGKey</span></span><span class="p">,</span> <span class="n"><span title="genjax.core.GenerativeFunction.importance(constraint)">constraint</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span><span class="p">,</span> <span class="n"><span title="genjax.core.GenerativeFunction.importance(args)">args</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Arguments&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Arguments&lt;/code&gt;)" href="#genjax.core.Arguments">Arguments</a></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.Trace&lt;/code&gt;)" href="#genjax.core.Trace">Trace</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Weight&lt;/code&gt;)" href="#genjax.core.Weight">Weight</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a properly weighted pair, a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a> and a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Weight"><code>Weight</code></a>, properly weighted for the target induced by the generative function for the provided constraint and arguments.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>(<strong>Full constraints</strong>) A simple example using the <code>importance</code> interface on distributions:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">normal</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">tr</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">normal</span><span class="o">.</span><span class="n">importance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">v</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_977313ec01674490b5ddb728f48fb424" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_977313ec01674490b5ddb728f48fb424")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_977313ec01674490b5ddb728f48fb424")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
<p>(<strong>Internal proposal for partial constraints</strong>) Specifying a <em>partial</em> constraint on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.StaticGenerativeFunction&lt;/span&gt;" href="generative_functions.html#genjax.StaticGenerativeFunction"><code>StaticGenerativeFunction</code></a>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">flip</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">gen</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nd">@gen</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">():</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">p</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;p&quot;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">f1</span> <span class="o">=</span> <span class="n">flip</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;f1&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">f2</span> <span class="o">=</span> <span class="n">flip</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;f2&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">tr</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">importance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">kw</span><span class="p">(</span><span class="n">f1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">f2</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="p">())</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_0c303f14358d4a37af0168072d7b24e2" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_0c303f14358d4a37af0168072d7b24e2")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_0c303f14358d4a37af0168072d7b24e2")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
        <p>Under the hood, creates an <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a> which requests that the generative function respond with a move from the <em>empty</em> trace (the only possible value for <em>empty</em> target <span class="arithmatex">\(\delta_\emptyset\)</span>) to the target induced by the generative function for constraint <span class="arithmatex">\(C\)</span> with arguments <span class="arithmatex">\(a\)</span>.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="k">def</span><span class="w"> </span><span class="nf">importance</span><span class="p">(</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a>    <span class="n">constraint</span><span class="p">:</span> <span class="n">ChoiceMap</span><span class="p">,</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a>    <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Weight</span><span class="p">]:</span>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">    Returns a properly weighted pair, a [`Trace`][genjax.core.Trace] and a [`Weight`][genjax.core.Weight], properly weighted for the target induced by the generative function for the provided constraint and arguments.</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">        (**Full constraints**) A simple example using the `importance` interface on distributions:</span>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">        import jax</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">        from genjax import normal</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        tr, w = normal.importance(key, C.v(1.0), (0.0, 1.0))</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        print(tr.get_choices().render_html())</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">        ```</span>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">        (**Internal proposal for partial constraints**) Specifying a _partial_ constraint on a [`StaticGenerativeFunction`][genjax.StaticGenerativeFunction]:</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">        from genjax import flip, uniform, gen</span>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        @gen</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">        def model():</span>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">            p = uniform(0.0, 1.0) @ &quot;p&quot;</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">            f1 = flip(p) @ &quot;f1&quot;</span>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">            f2 = flip(p) @ &quot;f2&quot;</span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">        tr, w = model.importance(key, C.kw(f1=True, f2=True), ())</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">        print(tr.get_choices().render_html())</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">        ```</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">    Under the hood, creates an [`EditRequest`][genjax.core.EditRequest] which requests that the generative function respond with a move from the _empty_ trace (the only possible value for _empty_ target $\\delta_\\emptyset$) to the target induced by the generative function for constraint $C$ with arguments $a$.</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="n">constraint</span><span class="p">,</span>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">args</span><span class="p">,</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.iterate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">iterate</span>


<a href="#genjax.core.GenerativeFunction.iterate" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">iterate</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;n&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.iterate(n)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.iterate(n)">n</a></span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>When called on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>a -&gt; a</code>, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>a -&gt; [a]</code> where</p>
<ul>
<li><code>a</code> is a loop-carried value, which must hold a fixed shape and dtype across all iterations</li>
<li><code>[a]</code> is an array of all <code>a</code>, <code>f(a)</code>, <code>f(f(a))</code> etc. values seen during iteration.</li>
</ul>
<p>All traced values are nested under an index.</p>
<p>The semantics of the returned <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> are given roughly by this Python implementation:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">iterate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">init</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="nb">input</span> <span class="o">=</span> <span class="n">init</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">seen</span> <span class="o">=</span> <span class="p">[</span><span class="n">init</span><span class="p">]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="n">seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">return</span> <span class="n">seen</span>
</span></code></pre></div>
<p><code>init</code> may be an arbitrary pytree value, and so multiple arrays can be iterated over at once and produce multiple output arrays.</p>
<p>The iterated value <code>a</code> must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type <code>a</code> in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.iterate(n)" class="doc doc-heading doc-heading-parameter">                  <code>n</code>
<a href="#genjax.core.GenerativeFunction.iterate(n)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the number of iterations to run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>iterative addition, returning all intermediate sums:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">inc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">init</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">inc</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">init</span><span class="p">,))</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_3eb48e399c854dbbb50be51a6ddf2e65" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_3eb48e399c854dbbb50be51a6ddf2e65")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_3eb48e399c854dbbb50be51a6ddf2e65")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="k">def</span><span class="w"> </span><span class="nf">iterate</span><span class="p">(</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">    When called on a [`genjax.GenerativeFunction`][] of type `a -&gt; a`, returns a new [`genjax.GenerativeFunction`][] of type `a -&gt; [a]` where</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    - `a` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">    - `[a]` is an array of all `a`, `f(a)`, `f(f(a))` etc. values seen during iteration.</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a>
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">    All traced values are nested under an index.</span>
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">    The semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation:</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">    ```python</span>
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">    def iterate(f, n, init):</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        input = init</span>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        seen = [init]</span>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        for _ in range(n):</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">            input = f(input)</span>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">            seen.append(input)</span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">        return seen</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">    ```</span>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">    `init` may be an arbitrary pytree value, and so multiple arrays can be iterated over at once and produce multiple output arrays.</span>
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998"></a>
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">    The iterated value `a` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `a` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">        n: the number of iterations to run.</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">        iterative addition, returning all intermediate sums:</span>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">        import jax</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        @genjax.iterate(n=100)</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">        def inc(x):</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">            return x + 1</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">        init = 0.0</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">        tr = jax.jit(inc.simulate)(key, (init,))</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">        ```</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.iterate_final" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">iterate_final</span>


<a href="#genjax.core.GenerativeFunction.iterate_final" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">iterate_final</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;n&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.iterate_final(n)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.iterate_final(n)">n</a></span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a decorator that wraps a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>a -&gt; a</code> and returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>a -&gt; a</code> where</p>
<ul>
<li><code>a</code> is a loop-carried value, which must hold a fixed shape and dtype across all iterations</li>
<li>the original function is invoked <code>n</code> times with each input coming from the previous invocation's output, so that the new function returns <span class="arithmatex">\(f^n(a)\)</span></li>
</ul>
<p>All traced values are nested under an index.</p>
<p>The semantics of the returned <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> are given roughly by this Python implementation:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">iterate_final</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">init</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">init</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">return</span> <span class="n">ret</span>
</span></code></pre></div>
<p><code>init</code> may be an arbitrary pytree value, and so multiple arrays can be iterated over at once and produce multiple output arrays.</p>
<p>The iterated value <code>a</code> must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type <code>a</code> in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.iterate_final(n)" class="doc doc-heading doc-heading-parameter">                  <code>n</code>
<a href="#genjax.core.GenerativeFunction.iterate_final(n)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the number of iterations to run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>iterative addition:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">iterate_final</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">inc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">init</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">inc</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">init</span><span class="p">,))</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_4bf51f17584840569b9f49b85c54e169" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_4bf51f17584840569b9f49b85c54e169")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >eNrtXet22sqS/j9P0ZusOYaxkSVxt2OvAd+TOImNEyfZJ4sjpAYUC0mWhDHey//nvMfMA8wrzKOcJ5mqbnERd3zBVpCzFsGt/vpWVV1fVbfhret1DLoreA6lrmrZtOJYlkf+Irbl6p5umVvEoYbi6Td0m9Qs00vWlKZudLZI0zIt11ZUKG83dI8m2S9bxHagxNBdL8maTnodG0pNy4TiqqJe1R2rZWpJ1TIsZ4tDt4n/W9WACtCernmNLVLTPahmetT0tklTN5N+uSSK/w5tWbdJV7/TzTrgLEejThKKtomtaBoUJg1a87aIrDZwNCZNNqheb0CJJGSwP9NTdJhcr33/TfJGd/WqbugeTFFpeVavblI3PUc3XV3Fbil/6s/r/u0mX8e3vXVMOi0T+nSgzFUd3fYILsTOmmLbhq4quLSblupRXCaHKs213Xg8sbMLKw/9uR7RaM10yQ7xGror1Kl3DmL5aGk0nhAalusJ7DlMjXqkYlMTp1xUsVUE/flz3JNjxdQMCo/NlmFs8x4EGGbZskwojbct5ypBBsdgXUIRPgoUe7qKhTZ1apbTVEyVCqbVjieYIkAH8ZEnJMlBb0lKTkA7eo3Eh0YtGNSsew2ys0NErDJ16A71Wo4J606o4dL+wBotE0c23LTb0Gsejo9VwDf38G9CD3FQP1Oz2oJDr1vU9Yqm3mTiOnSUJo3zNUlgG9sjHdktt8GXcXvMHLtd7PBpTJnl/GPAUXBBela9bnDzrTATA221sS0soYa3QegNKLgvSRwd+124oh1c9JgTwwH5lQXVUFz3A1ix32481muz0gQ1jHU7v0/AeoL6Mx3ffbs5zgA0/YawBndiwX0mRjylCjOltzsxMQam63ijVSwThgiLYcKjacYwfgXiiOnOPQbGyPe7quV5VhM3hi3T8uJCzTI0pQpoE5rdaihufNdQqtTYDT6p8D4YZkttUPWKaokE+Q9cuu7G41n2FhEFKUObo1sPlt0l2ZTh9+2x2+y9wLbDilKtOvSGaTfbHd9k87Iiiv0KqtVswrQGaijsB0UzVEXhQ25YN9RJjKkfrF5pN6hZobc2KCTVnmyFJvUK8gWj0QZqiPBTq/VrmK1mlTqDFQp5KZPtVaBaBVe6X8H3JKMO50Zx4slk1bDUK16U2O66DyY4yb4lrmXo2rSaXHtmVb4PrswEpwqiGreAUFvTXdtQOl3nOVyR7BImgK2tKoXtdmDyb1T2M167uF9MSugYfYcKKtXrSzeZyrKZTOmTKdJoz5riXLlUqYMJm6PoJ1Kk3hgQOh7UrR8YIXPwW2Tt73Kmqq695PCCoImDzC5hkChH7LjluChA2wKaQ50x/eru03XLTIF1lGQbsztJx5+m1/70PHrrjfYi6G6lpjuuV7FMvo+MmtY0UxLkDFrTWFGRRw+fS3x4iDirpuLUgZjyYTCDvn9kb7Cb2p1qC3Y3c+wG1H88TmljJDZUCxYSwoLxlf9OpbQWG4oq1k4V0ApdMUi506xahks+tTycr0b2OBL+tztgGMk2rV5BhMDgbhOcfoPFAorpAVxXXKr14oo3VMR/26NqztGMz4tCAb1zcJbcPsbMYvx210cKbcWtqED1YWF7eKXmBbxYd5+e1ucQJtjl4NL7PkhTPCWpmCBYxhgTg8XYCdJgRzG72syaJZJLKKwYEJOk1fIWm0pvBCAYnWp/BEfCuiR/6E3bcjzFHGm76lhXwDWwpL8ZzV7dAdjAenbFfC801EaFBaQVtI4BdsaNRRS4xQ7Uc5CjDVR0OGfr1UTOBlPVKioEOZpDTX/ywTASRhms+GTkqWeMvmsOGL+qGGocYl0ItICTMG4uuJ6C+N54n20kPiniI9GAGoGaIDMaEMd1SzFMCF0qtkNr+i00EjC8PDM8iNMUZHJtxTFBApWuq+hKt1ZTVCk1pqINgc6I4Nh+6C+SX5T0hdlnhVuMoCtOsu4omg5iixMpldFofYNYYCR1SkQYXlZtbHCjgQgFtyBWRPxlHhnLyF79NI6AjGz5yZ5yDst6km4O1+uxZy5DsO5glaVrryik1UZinrEuR505u2ejGsvxA0EfmwfIxGiAtOISTGcQ4rfrQi2awODdX4M+NDk/tttvNxJhyF6T3dKkX7zE1ezHUmwFk2hXLdefoESbMLvJExvDoRZmMLNU/K9AuMfli7vVHOHe9Mr3ArT4LBmFvpAfk1RgMT3mFMYxOyTasHhj6/CQcKAWjHVSQ7wFWBJDsYGBzY5iFxfw5B76AxUCCYwJdZ5iHOO6CCxFPxU3bimCuS4hmGMjU1oYnqoZyPqNrzhPZxPbecJEN+YeyR9Fx1E6Qs2xmnHNUluYdhKQFLjCjWK0KChaQnCtJo0zqoBZS/xf4IECZiznDBVia+A4E70csdug1MNEMm2TvXK5jLMpYxmmhdlDwaEwZZWWO6Ya/8d/+uGJSrukZfFQhXMd7AnX0Wkqhl/W9m04jVk911G3SMsx4sibt/D5Ztuq1eTtKjDzbHpDEwtHp/Viqch+Ts6KRYu9K5234fX4sFg8KE77KTWLxfqV9V47OSjttb8Xixff994VT09Ke8XD+u3J8YeG55ZOdVpPHe5/kz+cZL/flO2W/vk0cyG9+3Zy/vX05vL0zvvcOTzcW7+sX13opX2xoe+ftd4daEe/xOPqZu3mRLOv32cb15e6ftY6NY8ax7UvXvFLtvTRSRcPT8yrg6z6pdUy188z16p71b6pHRqb17f1Aytfr75rH+Wl4+KmWTzPfHCcd9L5ev1OPNfE4ruaVP+Y22sf/ZLrotVpnedyzQMp2z7+VvhUr9v04qqTpifVu4xadT4deUqxfnbysb2vuB33rHVy8u3y4LBd/Hxmn3zXvmxurtdzF7lvKU+svf98XbzJQJsfih9zxdN2sVm/Oy+vt36U6cG3W7mWVe8+ps+PO5lWqfj+rvTLPrRT+vHZ3oH4o/U5Xc6ZtdKHg+PD02ZRX8/fHMgNU2rk1qtf299+tY+dm/2jL3vmr9rBQd1b/6T+MIxcprD3rl3KNwrp09OjcuroR7HePMn8Kp0VvIsjelw4KJVOjlL79fT55ne1Uy0egUy/vt8snh0pRXq6ZxSP7w4+1X949Wzpc/3Tp5P90pV+lqGHpW97pUNVF+2GY9km6Ib942BfupOuyrW9mtfovDePNeXQPa6JH5tHBx+zJa14/fWrrXhu+UdT0xS9INfuCukv+q/rrN10sp+s73tl3Tlq3rw7SpUvy6nDA1ktndUu1o8Nyz5KH7rtjFK/zub1H7T80bAvzdLxCdVOHdq6vD7aa0qXh85VuXybkbOXl267CCNKEHYo5MXXmFqvocv8B7z0rF/RLBtih75JsqMsQRCm1NjgNvsT2pp+ONBgZyssYOSxLLQN6mGqJM5DyuDJF5jghYXmC9X8kBPLXNgesAmMoTHwVNqK7hFTudHrimc5ArRsVy3F0YS2o3v0gt568X5byCh4W/3jFXDx8dhAgI0HK9DLhd6kEInHuydvIziHNiFaHoHebxBZFEXGpGDzBdYaZ6mi8f0ORNGx/uAwSdbdwfAsKkbekENFN2Bj8yyClf9gOxuwTRPiOtiNdVgzqmiYBFgfXDv/kGjG8RAmFAjbHndiAVK1RawrQ20Apc7lM8h+xBSRpYJQyKVymXQ+L+clOUM2gQLBhMcxSkxtx/wO/AOoYDp7OFKDypwCvNVNu+W7shhz+lXrNja2EZ8fwEPODWCWDBzsN3BM4RNFEsxSDI006PyHHg4F1LHdOjV/KbdCBbwIGIFJHcb7KrWW6Z9Nqlazqpuopa6g6U3FFkAs0OKu/98+ll04MJh474G/FgMdr3W531qwGIsqxo0RLI6NxKVBMh6bUntCVV9PBl2q7ilgANsDh0eynKltszWp1Ex/NjuL6VkaeHU+JWekQiY1U8ukqVq26ko1VZ/6Ob01Ypl7uJPtrC24lbMz3sQa6SUcd2ICl32sL+/eQ2Bu/lPMIg/nS+Ep27rANTbgvb9Cu8FphdYidBOE+DCDkAqw8coF+E+W8rkXM4gQGAKsgTlkB2UoekEzEJjcpxsDr7N6JnFFHZMalchXrLqv4AYgBPRhHpMJIiKfsohPyaYEWS6kcqIk5SKvMmIyLuqPOuxLWOFRr/6hX/2Vmc78PmccbvXMyLVajkofZkdyIS1I2XRazuckEcxphe1IhZ4Eu4N5hiG72TMst+XQV2kmApf+Q63Fh6+e0Wgds6I4dbdrNvHExqge9c6KYrtkzIRjgYOc2KtSCKE7wUdqRq+dh6vIRIWZIdSauTO6Gfh3m2O7fzO87a6/I7qpEsUj4m2upuaq2UxGq+XFv9W97TmkthE2yT6EXA638FTSnCXitd658NqYnb17a5xLc5wcgjIXBGFypX5bA3KfVLvrU/q3+cnQha7YbmK2AodclV7Ma6y6Ev0mvmb5HP2hvgQ8GDsIrDQV29bN+vyexcNgCUIr3VQMAR8BLVYMF/UDlhJIIzu+G3rAflWaVU3BXwddU6EKRHvQNYVfFYbX9gFaMdzEk/DRYZMm5A3ZB96P9yxAIsxeIQYqEKtGNhtWk246LRzbJv4d3iYPDbr/QYDQfVvx348E3ZsDeapNlsq1O4/VW4d6N4qxJK2FqKhig14EqZSqqr8TlQqu6AN0NdjAMjVVXr6mRq45dPvxMjPPD93W+J9sj9vO+N9rxnbBSYZ2w+Gzm0sOvGpEpFfIWp/3MPV3IMg5Gl6CvCAZfkHim5Yi4tslviDrEeZbqGZVJazMdyGW+1SMNnJGIdqpnuuC20MNfqnXB/JpIZWSxEw6+4JXB0J062bCxbTZl36fS4enMqlVvQcAEnnUbbToomYYL2r6JzJ94U81i8GK0ZXN6Mrmyl3ZHLGC+bJnM2DR5c3o8uYKXd6cYQ1z0LNZ4OgaZ3SN8ze6xjmXzs+4lbNIG9GFztBc6FxErDNvdT6osehq56uS8YNJaHTJc6UueYbHp0QHA7+PJ3ohVh9d/HylSjHvgfei7URXQKMroM+pt/OdkC/WSnQZNHLcr1DXl57Tjq6FThTM9Luhk+pH1HvVLHgJh7ihuKmz4Kf2rfSthEd8ON/z6vUcgeOKHvr8BjcRohsID7cJYZ7NfrBmdM8gjPcMXvllnbDcNxg0hLl9ihDdKohuFfzWtwpG1XyuQ5+JsOjuQMjuDkyU5JzXBWbjoxsCLy3JRUhidA9gBe8BvB4vEKUcQ+07lsepozP91yP6xY7xp0Kjk/vo5P6JtXORw/opwOh8PnK1r0Ojl5HxDcX5Xi4l5OToeO8BqdlXcag3P2WMDviiv5Nc6XOLRbf/1T72i84tVuTcIkDX589YjYFF5xahPLcYI8mFzi2m4aNzi5eW5OK+Ljq3WMFzi9fgBaJkSqh9x/I49fISK4PO/ZkpavyFGeBi7v5xzv3hfE8HRTe9AcIXm/b8NX2DfG+rmbzBVKaY88h+MGlfG2rjDZm+6BipFB1H6ZAZeyxU7FapGZbipeS4JIobiQntkn/9878ydF2UyP/9rywU2Ls///XP/xEFcQOe/XeBl/0kd9SxtiRiWiZ7VyjM2usnzXlwbUb36clR1rRNdGF9Y0sZ/xMC4Q0CMS+8yPiSwpc0vmTwJYsvOXzJ40sBXiRESIiQAPFvhP9ICJQQKCFQQqCEQAmBEgJlBMoIlLErGREyIuRMvx0ZgTICZQTKCEwhMIXAFAJTCEwhMIVdpRCRQkQq328nhcA0AtMITCMwjcA0AtMITCMwjcA0dpVGRAYRGanfTgaBGQRmEJhBYAaBGQRmEJhBYBaBWewqi4gsIrLpfjtZBGYRmEVgFoFZBOYQmENgDoE5BOawqxwicojI5frt5BCYQ2AegXkE5hGYR2AegXkE5hGYx67yiMgjoiD22ykgsIDAAgILCCwgsIDAAgILCCwUhJ8bHKKxfcY3qQ3SpspVhRVdOC2amOb5Nl4hFUC/8Kf4czFHAoBwskaJUIMi4KH0MRF26rdM1rA82sdPrZdE/CKqMIEqSD5VkKBE/tljCOP/BDl8FIHTA84POEHgDIFTBM4ROEngLIHRBM4TGFHo+hxGGHyqwLkCJwucLXC6wPkCJwycMXDKwDhDryHGHTh5YOzB5w2cOHDmwKkD5w6cPHD2wOhDryFGIziP4ESCMwlGJXwSwVkEpxGcR3AiwZhEryHGKDil4JyCkwrOKjitYLzCZxScUnBOwUhFryFGLji74PSC8wtOMDjD4BSDcwxGMnx6wfhFryHGMzjR4EyDUw3ONTjZ4GyD0w3ONzjhCDAOTjk45+Ckg7MOTjs47+DEgzMPTj0492Dko9cQIyGMhfj8gxMQzkA4BeEchJMQzkI4DUEe0ueaooik5En5SDicGN/u53djvH4YHJnbqnp4TaGXxPjrPqSpyd5M5hdTDxKlJFctJbmECzFREvJJxTZvIBElHqPEY5R4jBKPUeLxVSUeXzsrWCAv+cQZybmdBN+Rr2inDUwhtvvRMmlYbxOwJZTmX20ppPlfuZv/dVcwAbwcxvabJn1fjmjPn+x4bJojIttR6j5K3Uep+yh1H6Xun8uPzcnpe5UjVv/oFZcWWfGI2YdUzMsgiNHpSth23Wf9DOHoROWJRDU7Mg/lKcron3L1wpo4Uqjp9CesnxI0V+Yyylk+doWleVY4YjOhM53n3Aej3OSTiWoe0hnSfOQ0t4WB++/quOYM0KPQ/ClWWZpvlSMHFkITet5dcYmXUfHDUMb6sIWYfSK83+EJ85/1vVJQJQyyVBvNB342UC4nyIV0QX7A52kF0i3BD+wZTblM/QCfqcdqD/+gn/6nZAlqw9JhMKPfe8M/Hyv+131i+ggnHXKFSuVBTaYrPFRYvrqzb2/7nb/rcO4vOYy+3XB1MrhT1SHK2r5gCDwtTxFlal/WdGakX6M/Xw/RNvh8dvYqMoFPmGgKBeGZHh1Hh9OP/Ai7TU2/2f1/sKOjAw==</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_4bf51f17584840569b9f49b85c54e169")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="k">def</span><span class="w"> </span><span class="nf">iterate_final</span><span class="p">(</span>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">    Returns a decorator that wraps a [`genjax.GenerativeFunction`][] of type `a -&gt; a` and returns a new [`genjax.GenerativeFunction`][] of type `a -&gt; a` where</span>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">    - `a` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">    - the original function is invoked `n` times with each input coming from the previous invocation&#39;s output, so that the new function returns $f^n(a)$</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">    All traced values are nested under an index.</span>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">    The semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation:</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">    ```python</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">    def iterate_final(f, n, init):</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">        ret = init</span>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">        for _ in range(n):</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">            ret = f(ret)</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">        return ret</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">    ```</span>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">    `init` may be an arbitrary pytree value, and so multiple arrays can be iterated over at once and produce multiple output arrays.</span>
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">    The iterated value `a` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `a` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">        n: the number of iterations to run.</span>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        iterative addition:</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">        import jax</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>
</span><span id="__span-0-1066"><a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">        @genjax.iterate_final(n=100)</span>
</span><span id="__span-0-1067"><a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1068"><a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">        def inc(x):</span>
</span><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">            return x + 1</span>
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">        init = 0.0</span>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">        tr = jax.jit(inc.simulate)(key, (init,))</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">        ```</span>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">iterate_final</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.map" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">map</span>


<a href="#genjax.core.GenerativeFunction.map" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">map</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;f&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.map(f)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.map(f)">f</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span> <span class="n"><span title="genjax._src.core.generative.generative_function.S">S</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.S">S</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Specialized version of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;genjax.dimap&lt;/span&gt;" href="combinators.html#genjax.dimap"><code>genjax.dimap</code></a> where only the post-processing function is applied.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.map(f)" class="doc doc-heading doc-heading-parameter">                  <code>f</code>
<a href="#genjax.core.GenerativeFunction.map(f)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.Callable">Callable</span>[[<span title="genjax._src.core.generative.generative_function.R">R</span>], <span title="genjax._src.core.generative.generative_function.S">S</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A callable that postprocesses the return value of the wrapped function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.S">S</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that acts like <code>self</code> with a post-processing function to its return value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span><span class="o">,</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Define a post-processing function</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;z&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">map_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Use the map model</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">trace</span> <span class="o">=</span> <span class="n">map_model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,))</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_46678e6945bb444ab0042c69d253c696" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_46678e6945bb444ab0042c69d253c696")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_46678e6945bb444ab0042c69d253c696")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">R</span><span class="p">],</span> <span class="n">S</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[S]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">    Specialized version of [`genjax.dimap`][] where only the post-processing function is applied.</span>
</span><span id="__span-0-1394"><a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>
</span><span id="__span-0-1395"><a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1396"><a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">        f: A callable that postprocesses the return value of the wrapped function.</span>
</span><span id="__span-0-1397"><a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>
</span><span id="__span-0-1398"><a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1399"><a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="sd">        A [`genjax.GenerativeFunction`][] that acts like `self` with a post-processing function to its return value.</span>
</span><span id="__span-0-1400"><a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>
</span><span id="__span-0-1401"><a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1402"><a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;map&quot;</span>
</span><span id="__span-0-1403"><a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><span class="sd">        import jax, genjax</span>
</span><span id="__span-0-1404"><a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>
</span><span id="__span-0-1405"><a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>
</span><span id="__span-0-1406"><a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><span class="sd">        # Define a post-processing function</span>
</span><span id="__span-0-1407"><a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><span class="sd">        def square(x):</span>
</span><span id="__span-0-1408"><a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><span class="sd">            return x**2</span>
</span><span id="__span-0-1409"><a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>
</span><span id="__span-0-1410"><a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>
</span><span id="__span-0-1411"><a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1412"><a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><span class="sd">        def model(x):</span>
</span><span id="__span-0-1413"><a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><span class="sd">            return genjax.normal(x, 1.0) @ &quot;z&quot;</span>
</span><span id="__span-0-1414"><a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>
</span><span id="__span-0-1415"><a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>
</span><span id="__span-0-1416"><a id="__codelineno-0-1416" name="__codelineno-0-1416"></a><span class="sd">        map_model = model.map(square)</span>
</span><span id="__span-0-1417"><a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>
</span><span id="__span-0-1418"><a id="__codelineno-0-1418" name="__codelineno-0-1418"></a><span class="sd">        # Use the map model</span>
</span><span id="__span-0-1419"><a id="__codelineno-0-1419" name="__codelineno-0-1419"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-1420"><a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><span class="sd">        trace = map_model.simulate(key, (2.0,))</span>
</span><span id="__span-0-1421"><a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>
</span><span id="__span-0-1422"><a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><span class="sd">        print(trace.render_html())</span>
</span><span id="__span-0-1423"><a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="sd">        ```</span>
</span><span id="__span-0-1424"><a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1425"><a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1426"><a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>
</span><span id="__span-0-1427"><a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">mask</span>


<a href="#genjax.core.GenerativeFunction.mask" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">mask</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Mask&lt;/span&gt; (&lt;code&gt;genjax.Mask&lt;/code&gt;)" href="#genjax.core.Mask">Mask</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Enables dynamic masking of generative functions. Returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> like <code>self</code>, but which accepts an additional boolean first argument.</p>
<p>If <code>True</code>, the invocation of <code>self</code> is masked, and its contribution to the score is ignored. If <code>False</code>, it has the same semantics as if one was invoking <code>self</code> without masking.</p>
<p>The return value type is a <code>Mask</code>, with a flag value equal to the supplied boolean.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Mask&lt;/span&gt; (&lt;code&gt;genjax.Mask&lt;/code&gt;)" href="#genjax.core.Mask">Mask</a>[<span title="genjax._src.core.generative.generative_function.R">R</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The masked version of the original <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Masking a normal draw:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span><span class="o">,</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">normal_draw</span><span class="p">(</span><span class="n">mean</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;x&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">masked_normal_draw</span> <span class="o">=</span> <span class="n">normal_draw</span><span class="o">.</span><span class="n">mask</span><span class="p">()</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">masked_normal_draw</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="p">(</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="mf">2.0</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="p">),</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="p">)</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_e4173d9fa73e437ea30b7572492d7089" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_e4173d9fa73e437ea30b7572492d7089")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_e4173d9fa73e437ea30b7572492d7089")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[genjax.Mask[R]]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">    Enables dynamic masking of generative functions. Returns a new [`genjax.GenerativeFunction`][] like `self`, but which accepts an additional boolean first argument.</span>
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">    If `True`, the invocation of `self` is masked, and its contribution to the score is ignored. If `False`, it has the same semantics as if one was invoking `self` without masking.</span>
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">    The return value type is a `Mask`, with a flag value equal to the supplied boolean.</span>
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="sd">        The masked version of the original [`genjax.GenerativeFunction`][].</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">        Masking a normal draw:</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;mask&quot;</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">        import genjax, jax</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><span class="sd">        def normal_draw(mean):</span>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">            return genjax.normal(mean, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">        masked_normal_draw = normal_draw.mask()</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">        tr = jax.jit(masked_normal_draw.simulate)(</span>
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">            key,</span>
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">            (</span>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">                False,</span>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">                2.0,</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">            ),</span>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">        )</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">        ```</span>
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.masked_iterate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">masked_iterate</span>


<a href="#genjax.core.GenerativeFunction.masked_iterate" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">masked_iterate</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Transforms a generative function that takes a single argument of type <code>a</code> and returns a value of type <code>a</code>, into a function that takes a tuple of arguments <code>(a, [mask])</code> and returns a list of values of type <code>a</code>.</p>
<p>The original function is modified to accept an additional argument <code>mask</code>, which is a boolean value indicating whether the operation should be masked or not. The function returns a Masked list of results of the original operation with the input [mask] as mask.</p>
<p>All traced values from the kernel generative function are traced (with an added axis due to the scan) but only those indices from [mask] with a flag of True will accounted for in inference, notably for score computations.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">masks</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Create a kernel generative function</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="o">.</span><span class="n">mask</span><span class="p">()</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span><span class="n">masks</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="o">@</span> <span class="s2">&quot;rats&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># Create a model using masked_iterate</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">model</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">masked_iterate</span><span class="p">()</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="c1"># Simulate from the model</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">mask_steps</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">mask_steps</span><span class="p">))</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_0e509501cc60444ea20eb9cfd2901148" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_0e509501cc60444ea20eb9cfd2901148")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_0e509501cc60444ea20eb9cfd2901148")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="k">def</span><span class="w"> </span><span class="nf">masked_iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">    Transforms a generative function that takes a single argument of type `a` and returns a value of type `a`, into a function that takes a tuple of arguments `(a, [mask])` and returns a list of values of type `a`.</span>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">    The original function is modified to accept an additional argument `mask`, which is a boolean value indicating whether the operation should be masked or not. The function returns a Masked list of results of the original operation with the input [mask] as mask.</span>
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">    All traced values from the kernel generative function are traced (with an added axis due to the scan) but only those indices from [mask] with a flag of True will accounted for in inference, notably for score computations.</span>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">        import jax</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">        masks = jnp.array([True, False, True])</span>
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">        # Create a kernel generative function</span>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">        def step(x):</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">            _ = (</span>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">                genjax.normal.mask().vmap(in_axes=(0, None, None))(masks, x, 1.0)</span>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">                @ &quot;rats&quot;</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">            )</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">            return x</span>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">        # Create a model using masked_iterate</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">        model = step.masked_iterate()</span>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">        # Simulate from the model</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">        mask_steps = jnp.arange(10) &lt; 5</span>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">        tr = model.simulate(key, (0.0, mask_steps))</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        ```</span>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">masked_iterate</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.masked_iterate_final" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">masked_iterate_final</span>


<a href="#genjax.core.GenerativeFunction.masked_iterate_final" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">masked_iterate_final</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Transforms a generative function that takes a single argument of type <code>a</code> and returns a value of type <code>a</code>, into a function that takes a tuple of arguments <code>(a, [mask])</code> and returns a value of type <code>a</code>.</p>
<p>The original function is modified to accept an additional argument <code>mask</code>, which is a boolean value indicating whether the operation should be masked or not. The function returns the result of the original operation if <code>mask</code> is <code>True</code>, and the original input if <code>mask</code> is <code>False</code>.</p>
<p>All traced values from the kernel generative function are traced (with an added axis due to the scan) but only those indices from [mask] with a flag of True will accounted for in inference, notably for score computations.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">masks</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Create a kernel generative function</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="o">.</span><span class="n">mask</span><span class="p">()</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span><span class="n">masks</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="o">@</span> <span class="s2">&quot;rats&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># Create a model using masked_iterate_final</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">model</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">masked_iterate_final</span><span class="p">()</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="c1"># Simulate from the model</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">mask_steps</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">mask_steps</span><span class="p">))</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_4ae656371a034baa9d1bb15adea0910c" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_4ae656371a034baa9d1bb15adea0910c")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >eNrtPVl221aW/70KhD4dUm0RwsMMKdJpStbkRHZsObGTVA4LJEESFgjQAChKzvF/1z66F1BbqKXUSvo+ABzAARxEUgR4lRNLBO4b7/ju8PiD5z9axgnru4bhVZ22UXYdx2f+YtqOZ/qmYx8yrmHpvnlvHDF1x/aLdb1lWo+HTMuxHa+tV+F5t2n6RjH4cMi0XXhimZ5fDLou+o9teGo7Njyu6NW7hut07Fqx6liOexg2PWKiTxULAKA/s+Y3D5m66QOY7Ru2f8S0TLsYPScc95/Ql/NQ9Myvpt2Ado5bM9wiPDpi2nqtBg+LllH3Dxm+2qSzsY1i0zAbTXhCWImOZ/u6CYvr9x/9Ubw3PbNiWqYPS9Q7vtOHLZq275q2Z1bpsEb4NlrXtx8Own38ob+PRbdjw5guPPOqrtn2GboRx3m93bbMqk639sCp+gbdJtfQW/mTQmHv+AR2HsbzfKZm1G2POWb8pumxDcN/D2h549SMwh7bdDyfDd7D0gyfKbcNmy65VKW90kZ//DnpzZVu1ywDXtsdyzoKR2BhmreOY8PTQtdx7/aY4Tk4H+ERfRV77JtV+rBtuHXHbel21WBtp1vYCwgBBiiMvWGKYaMfGIHfg37MOlMYmTVrGXbDbzLHxwxHQRKn7hp+x7Vh3xnD8ozBxJodm85stGuvadZ9Or8AgP7xDf6bMkIByM+uOV3WNb50DM8v2WYrQNeFq7eMQrgne7SPo7GB2h2vGW7j0YQ19oY4DpeRsMr550BnESLSdxoNK2TfcsBiQK1t2hd9Ylj+PmPcA4FHmKSzCz6zd8Yj3fScm6MTioDZqqV73k/AxVG/hVy/z3ILyDDXG/zbHuwnkH9A4yc/HExigJp5zwQdHuficibH+HoFVmo8HOe4HLCu64+DODZMETbDhldJzDB5Bwq0TW/tOWDGUN5VHN93WlQwHNqOX2DrjlXTK9Dahm4Pm7pXOLH0imGdxN+UwzGCNofVplG9M2p7e8x/0a3rCR7faR8yHEskozUueuizr8VgyfD5aKKY/cYG4rCsVyqucR9QdyAdX8gqr3PcAKDqtFqwrCEIPfihqBkB0cMpN517w92bAB8HL3ebhl02HtpAkEZtZTs0bVTALzBNbQiCg596fQBhd1oVwx0G0FQiyQMAj8rmxvAYApGI1AcwamWKigFApGrGNdK97haKxYrlVO/CR3tHPf0SYJa0HxjPscxaEmRIXrOAv8W3borWBVxO2mGArple29Ife9p1FJA5YQIMHR5WDJDHQ4t/UQ1+JpNfqDiLhGrOSOMCzfXHMu2ApoOVJIwZUNr4yDXdvfMMvQE8bo+3XhGl9edAm05u1IOPzTCwAA6Z/N94qVLNP+f04o2mTlLewCQpHunAHdejCGw7YAcZ7oRxTW91wwasEAxUDCS3N43GVzPqYHm+8eCPj8KaXrluup5fduxQjoyzVhIrsbxEuWkiqpgnTz/E+OgU6apautsAyzWcRsDQ3544GkjT9mOlA9LNniiABq8nEW2OyY1AwUbCuWEy8N8MItZyI8eO/I0OVGHqFnP72Ko4lse87fh0vTXmLGwJv9uPwBjFrlG5gyNE0NxrgVXQDA4Luu1Dc1P3jFr/4PHC4Oh/R+NkHrYODH6O1aj6jq8y5I8Jq5gs7gYt2a7ulatwFoCN7bfX635MzfXkdNKYI23iQw5vfaSDarqvF3UbEBuYlHvDj+kg1E52dbtHzUG3DPEYA3YMLJei0/EXW0p/BoAY06h9F59JMCTzndlqO66v22N9V1znDowR+mQgjGbv7lCzof3sofkb26w2y8GJtUy5Y8h8C5mFY0OOHYJzqRE3BOiGRl0fkhp1sNRauQqnoJpr2NHi4+dMmGUccGXWVZ8ZI9UcY/6qblULcBiGkxjYJIHxznq+Ttv357u2mURGUTiTGphGQCbUMhpCx5eObtlwtim3XaNuPkAnMcZTA8aDg5xOLbmu7tqAgXJPVfSwW6/rVSJMAGzDSWgMcYE8jDYpelSMkDmwCg8DC153iw1Xr5mAtgJDBKlmNPYZB5ikYTAcTE+uNvdDpoEjDBVBwSMm2uaxuYzJ6tUoAmZM5Bf7xDmK62m0OQrXt55DHAJ3x0E2Tr0cK1abe/PMdTPkHFr3wawm2vixU2GwDsCJ1QRsFQgsZ7hJ1K8HUMYePd1HezBoWpy/bW/c3kkkaNnvsve0GD3e4G4OzlLBDhYpX3W8aIHEaMHqpi9sgg21sAUzi8T/ih33QvxSaTXHcS8Z+BsLPa7F5TBA8lO8DsGhnzodJll21NCGzZsIEx4Jh6BgrtM6CnuALbH0Nlhgs0+xiyN4+giDibIxD8cUmFXMY9IQsa0Y+OombUXcGcbGnXBMQg+jS7VjbsHJgPMMNrWfFXrCqXOS+a7kuvojW3edVqHmVDvUL8VSo8Bj73WrYwCh7bGe0zIKgalA3Zr0NxseFKhLc86jQi4PinOv70T2mobhU0+z0WXObm9v6Wpu6TPqNw5esq4BS64at492tfD3/46OJ1WjZ7QsflQJbR06Et1Ht6Vb0bNuxMMidft5bvWQ6bhWgdrNh/T9Qdep1/mjCljmsrhf47TLm0bptBT8XL8rlZzgr9P3Xfj36qJUOi8l/Zy2SqXGnfNj7fr89Kz7W6n04bez16Wb69Oz0kXj4frqp6bvnd6YRkO4ePWJ/+la/u3+tt0xf76RPpDXn67f/3pz//Hmq//z48XF2cuPjbsP5ukrrmm+etd5fV67/MxdVQ7q99e19pcf5eaXj6b5rnNjXzav6r/4pV/k0zeuWLq4tu/O5eovnY798r30perdde/rF9bBl4fGuaM2Kq+7lyq5Kh3YpffST677mrx/2fjKva9xpdd10nijnHUvP/MNznnsvFeU1jmRu1eftLeNRtv4cPcoGteVr1K14r699PVS4931m+4r3Xv03nWurz99PL/oln5+177+rfbLwcHLhvJB+ST4XP3Hn7+U7iXo86fSG6V00y21Gl/f377s/H5rnH964Oty9esb8f3Vo9Q5Lf349fRz+6ItmFfvzs653zs/i7eKXT/96fzq4qZVMl+q9+d80yZN5WXl1+6nz90r9/7V5S9n9uf6+XnDf/m2+rtlKZJ29rp7qjY18ebm8la4/L3UaF1Ln0/faf6HS+NKOz89vb4UXjXE9we/VR8rpUvA6a8/HpTeXeol4+bMKl19PX/b+N1vyKc/N96+vX51eme+k4yL009npxdVk2s3XadtA220fz9/Rb6Su9v6Wd1vPv5oX9X0C++qzr1pXZ6/kU9rpS+//trWfe/291atppsaX/+qib+Yn7/I7ZYrv3V+O7s13cvW/etL4fbjrXBxzldP39U/vLyynPaleOF1Jb3xRVbN343bN1b7o316dW3Ublyj8/HL5VmLfLxw725vHyRe/vjR65ZgRntMEDXyC/mArPNUZf4d/ulzv15z2nB2GLBkEOtiWTYBYj/k2T+hr+ToQTMIvgQHxvAsC30DedhVphAeKeOhMWDBDw5lXwCLjpz0mQfigXZBz9D04Kl3ddNnbP3ebOi+47LQc7vi6G6N7bqmb3wwHvzCoC9qUYR9DeIvoOILuaEDNo28wCgfzJYBJ/FCLzQ31s41WnBaHmv6bZ/hOY4LLCkQvmC1FgJX0eRxh07RucHkqJOsJ8FosCrHvGAudNMCweY7DAX+LpBsYG3acK4DaWzCnhl6jToBXg7vXRRFmhE/og4FJhCPx7mYUXXIOHdWtQkmtaJK1PrhBIYnGqspgiKJqsqrhJeYAzCBYMGTLErq2s5FA0QRqrg7e/SkBsChCfCDabc7kSrLBUq/4jzkJnYS2QfwMrQNYJVB4/i4sTBFZCgycS/FyEzjyn/k5ciBOnfSMOzP+gNbBi0CTGAbbmD3lesdOwpeVp1WxbQplXpszWzpbRbQAj2eRL9e0WcfXJhMof8i2ouhgfM92y8ff0wfla17K/44N3YujRvjuQToKaARnQyrVNPXgQGOhqJLPC/Vj4I9KdftaDXHi9GZCHa1KvAS0SRhJpWRRCrbdaJKpKeBTy/POPYZlWTH+QVFeRAE3sszfYfjcY4NcZ8b4Lv/Eiy36C31Io/6S+FtILpANTbh72iHTuLLSi1HmDYgcTmGIBoIXl6DXzxRlWdjiBQwAuyBPcIHt/DoGdmADfCezAwhzO6xxJ3h2oZVRl2x67oiZAA2Rg/zsEy8BeqURXQKp7KiKHOiiEplBse0dO9uhGFu4NFZH2TLOGd+lTOp3e5x0VP0D5EFluc1QeEIUZ6Tj7ZcA3mUkKqjplnw8LIPfxGBbyU/scuqpVjz3eMuz+m4VWM57uI1kSWyKPKqQjhgsh3WUlUYiW0/UifeCBedWY7XcY1tZho2JIIn8k7Uy+6xUO3RLutuw+sxUWFvf5yq+mHZ3AkzYcG5WMw0t43kwfbWuRo66Xe3PMFMJZ8ZKK7bx+OCIqo6yJ18b/lHPc0IKzXajO4z3INSryoVWdKMqs593/CP5kDifkoR/WQ1OuhoVcidhfF8Pz8jP0EJ9Mo7QuROwkqcBFiWnQ406GuICqZB99TPoOyGGUmszJ3szabnbBDWcysYJKnskNSzGfq7TkQZsW02739Z1loBGynI8Si39HbbtBtz2y7UMQb9mD49v8Np37R1i6UQcDbTLY+SCewonFyCBI2RF3DIGbF7FG7Y7kk/GYzu6xIUMdrF5onDNfx73dowaQAORmhDlrNkE8c3dQm6iHeAumZndc0mo2TLipDw/olJoiMqT8+dvHFsI7W8Ha5vLkyEoMivO8Sv6039eAabrz2qroOPeqtS0+nHuOKu1dX0GnULGnCrM9YS+IthXjCvjHpQ6wA7HTCPQBTGqTMHTadlHLgdSlEH9K6cgzCA0PvludXen+Xo77FA3cFQ4PsgTBVpPz6bDdmewzKU+LRahgtZgauy+BYmLfEZSAsV21YLxnWl9i4rXzaaOKWKrCAQThJlzPZ4Qkru7HKHddFwolW2oylQFElPysPFFPU0pqiHh9Ih5CeyxTAgJqtjsvrOJauPccF8vrgZzTBtHdPWdydtfQYzzGGdzWqMCeyYwL6LCexzMQf7JFWFqeyYyp7VVPZFSH9GuuESXWFSe2qS2pfA7szM9qf0ientW4ny1ShZTHTfkazktKofJK6MEdfzHg0wDpwdG+iZvDiYBr+FBDFvKtWi/WBCfHa00Hz5UIv1gppotzXRxmNymCSfgJrkTPlp8MjDu8bDG0hDSUWu4YI3Lu90uPsJFyuvl67nOAth3DqtuVSYQ7U8T8zlcNrtiHMGMqVSlG24zRlTMaf9vCqFxbyo1OdFYT7UivlmYbWDWU+Y9ZTtrKep1D5XpHlWa8xtSllu0yyEzpnONHc3mMG0LYhdWi1intJOpZJsq8JAEko/CW3cMMcoUaptk835QTCzaDvQvlgyUWJTzB9Ktd5YJGUooSHqjp3THZuIOqUix0AQBZYTVU6TFA4jqcvEh7YiwWB+W2hHg0EUeeUBNvH6iZ0Ppob/jtDF3Bw02hDDq3jtxK6HWScyxgIGV1J7DLxi4DWjgdcksl/AoT5HNxiKTWUodg7MLhSTXaQ/DM5uHaqfrkwxXLuDsbY0qBkkqgwR1fOZ/OiWz4aN8wzemFQ47RWBVXisC1zCa7JFzvoFXfZYxYFVHOheXDyKi3WE6ErcMVfikhm5Uxuj2zDFbsOnFnDM7gVdhFuC1mUVIroDd9Zzsz2qAn02GVAwmzbIN+etGbYG1mzfFrbCfFzGPniaNbC8sWgCA9j+kLWYS3qfO5lhPFCDv+S6+mPhD47dZ2b//+c+UwtQXbcc3Rf4faZr6Hfl4NEHt2PsJdddbAkLU+z9wf25DNKhWTolP2EMy6ANllUBe9kQ35vn9s2J7rDYY6Lwfn7eTxORhBu5KJmErdJAKF6n4tP4wKYU/V9boej7q14Usf2GKVX5nu/SqrGT71888MqRq/te+Fc0uUNmwUoaQWAlThZlTeFlScYveJ2jSuB+/G7CX7flzs7JtP5HnhJKfoqV9P2XjuMfzd9LCI8xvUXiEYLGirKqaSIRORlj34tz13YzVqInYVH+ijpDNsNSNyx1S+aRdfAdst/SWk5lOU4kEidoSyi5GHvE2WLcHf0ENtEro8kjEePYjtvSrcJehmIkM2h8jeyzGi7C+EqqfS/pE9vL+m1MoLsHw9uNKMtUFES7sFq8Rp0+mz5egdPG7rQqlEq4jLN1hKqp8ZgnkgD0uzb2ngOLk77UKuuYJGvCJNk6TGbTzuvtN78mPPJ/ptjCE3pxVO+pgdRME882qnM8GGRS72yTAxVvwsOb8LaEORKK7hbmjeD5jjo38T49DDIszHfz1Xcvx4ejfWPQAYMOGTxPLH7hxmrYCYMQeNbIgFhPyUmEYyVR4AmvapjiNGYW1UyauQl0P/Zp7GuOB69SczZZ/Qllp88paA/t7YQKml2F+BTmSZsbbOeqFZOxN7266UlEQbtNZyw9hlLG9Mp10/X8smMH0mpNNkPfEp9uf5cTRM2YrJpm9o/08YJJ3ux+xRcz4wgCgD2QqNarQLh9Rtib0jHz73/8D8dyzL/+Sf/949//+D/4vQ9P/xd+/8l8NVznUOBmnXumLXB4I8bPLNPtnCRpvjBRRZVyfwyXw/0HE/6k8eHMYr4kiZ5pzZpYHPxkKfps6SgoCDckCElMEJJIEBIqCG3HzpIsJCBKwv+HZEwKHz5JFmbS6zokr8jaJCFJcxoQv7I0oMwr0+08j2zuiHqvWx1jQ2dUVMFUBRdB+8p8oIVVIVDDRZ4lgR6G35nTw3RxgkwUSWP2Geq5o6X5KqEfYCMUwouEJ0OqD7ZHFARJVqQQhBBZIhz9AG8UmWgSp0pxeHgtcDwhAQivckSVBDH4oEkaD38LQ/DQpQidC5ooh13yvKKJghQMpqmiSERBjMMTkdAWUgBPeEVVJBJ+kGRZIYLExOFVUSGqKIlBlwIMz2uKGq5XUnlZ4NT4/DlBIZpM+ACE5wiBzySEF4FRRX54vQzdT1EcbCFROZlwdL2EJRIvKZrAxPtXBVmGBuGWKIomqYIa7qesqBJsrzgCL3OSDEsO8EWgf55nwsE0GdbOadKYVbK7J7JAgK5BiwT9pkaNePRSXlQjm1QjhBUCJSLJoRIRWD5QIlTs8dlTI7A8DsRSIIlg7aIqKbwWqQWNJ6ICr4bFGGgawmu8xvRAAD7QQfCG5zSeF5gRManxoqjyihxpDpVonBiKVUHRgNDJaP+8ygsSCbsEKUkkUYgmxwmiIgpj/auaIopSNB+Q8aIkBfAcyGSek0f65xWQ1ZoYzV+BuclKbzGcLEjqaP+gRAROiEAEjciyHH0gmiJoMTUF+wngmtLfQqIRjsjh/EFBEOh+dD6yCqol2n+e51UiRh+ICIMJ6ii8CrtM1KhLUQAURPCCqhJFAfiF1EiGD7OB+FyDEgn6xWQhTBZKS34DxmY3Tggr94JgPHZXjdeK41gzLFff7RiHPMfUdcszDkk2jFOGOuL3mQu6Jjgn00/DJ3Z8OzD0KInsorNgHYFbDNli7grmrmDuSjqEH1mD8CMo/DBfBfNVMF9l66Ufvwbph1fVZF1pbptfZnPuuWqztVy1kCSxAn5FKv2K1EHVHlttOiaMMX4R+VnwIhUFeUARK2UH6G9Hi/Hul6zD40SWCAS/WWM6n/WqY3UrMHi8CVeFpIXX2PtVcxt7v6v8hjmWmGOJOZaYY4k5lkupjTXkWA71m5ojUd3SG6hFMEqNUernj1Jn0lEZCkUqZtYga2m3mIn4pEzE7BLd1h01Mek1q+bklvkQsUQn014ILeaD6JXoDJJ3CNf3RfAZLNSB42xkb81XqBOHn12oMwo/q1BnFH5Woc4o/KxCnfH1JhfqjMHPKNQZnc+sQp1R+FmFOmP7uVShTkaVx+qLdFZfnrNOBeIafsoDRxgwWhdvAG2slDOgPwwWoZmGwSIMFmGwCINFcyuNNYSK+r1ioAgDRRgowrcYKKIiceVhol6n6LlHz30aDpibzIUHnYwKHRU6KnRU6GuKi4KQWHFkFHpEVY6qfJu/9Rdvm9og8ldYz4g3TKEFhxYcWnB4w1RfHK7ubqlnvVUqLq+ooOlLicLQLTtJ/8+8gGKIm7NJCmSlpEC2kRQGF44k/b8IKWTsXLfaS0fwupEMXzeyXYY5JkSnOdMmMc+GZ5Ugy0YjYZaNyKrhNxYQVh2k2WTDYofFEZ7nhCDJg6fX5ROJZ4K/BU6QwvwZnhUFonCaEPzNcapIs3x7Zi5N1NFUUZCEIJVEFTRB1mDHoGtF5YigSGEXRKW33QR/y4oiaJoMei/42eGMkFUm66YrTRdvTsKbk3qUu7p6J7wtCW9LwuT3CVyxsuJVvCEJTXFMesekd0x6x6T3+RXGShPe8VYkjKxiZBUjq5gbNyQOV5jojjch4U1IaThGYuJl9kzFrfEDLmsa1sxW2TLsht88nkAZdqdVoVBCNiXEYPErwuOgQ5QVqIr6dLEa6koxSRE4aRqtZQnrW6aIYjIx5Gc3zKM02UnLY0GCyWPhxjYVbkzPA8tPgc5j+cUCUdYMOguTXYVS5CmUsuAojDxjSb8ir9mkXz0HW/BpB0oVEksS8tMb5DNecJBSwzCxrCA/vUE6DUEec8U3aQukIDWSVxSW10SNJ2r2kiMT7Yj1JlHeUjqpFv7ajiyvqV7S/GTgfCbytGIyzQNU2w2giRcPvHJEvTnhX9HED5nUpRRvb/pjOlKLgc6XdA4OtcTUYUwd3tHU4SEuWDjGG2uLqcGY4IWpwZgajKnBmBo8UUEslQo8oQdM/cXU34n+fNJL/eUx9Xd9byeED57tbeZTf+Pib4lU3/EOMJ9qF/OptuWYh+STdvJ5Ni9betPuliOgb3vJYZHp9knqDw0bCnPgXU6ZvcuJsALzr38SVuxd5URGvtlW6vuJJLzPKfzpf7nq/oJ/79B9Tgn3NuWngefxy1Pxy1O3Ogg09dtr8pOB8xjmwSuBF6exJA9wPqlJHr29mMONOdxryeFOqUci+Tv+8gktsPpr56q/Nmff4LfuoaJBRZMt1/fU757LTwNHFbNrKmZuAsGi4i0pKp63hCiVhcTolJgH/XNWgD5X7SdWg6OBhwbeumUAmV8GYMFwSgX9+vX8RiN197qVefMsXOY8iAsh0UTLnIkWInZOI60P/ExXdNwZj13g6dzJG8c20qoQo00ki+w4KsWUonkTshXdWWmTunNQBbqwnt1Gmm3Uptht1bsrmWO5NLLRXJ4l9CmhTwl9SpnyKc3lTUI/UjoF+jqVLfqOVoaqeU42GfQXUXdQNj1Bc/qA0Puzil0m8+0yqq8UstB6ZeI2VFImCcgiEVhOVbTRW3fSKhbnKENLTelZum+9XfcdhDt9++3MUnC85TYdt9zi7bYLEf0Cd23gLbZ4i+1uFjAveqUR3laLt9XibbV4Wy3eVou31U5WInPfUIu30qIGwFtp8VbaHbqVdqmbaPH22d29PvQ5j2dIJmkkk416u/A22ezeJrvesMGyprpX1e2yZdgNv3mckPVKuPQx8dDSZgUl+4BYVLALRQWJ5ICFBM+YMJeU1YjFA5tnlxllA1gwgAUDWDCQEZfKjFIBLBJIm+BejyLdisKAleWdp4Izk5NlsRz6iX6pg5p5f/L/YVPh0A==</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_4ae656371a034baa9d1bb15adea0910c")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="k">def</span><span class="w"> </span><span class="nf">masked_iterate_final</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">    Transforms a generative function that takes a single argument of type `a` and returns a value of type `a`, into a function that takes a tuple of arguments `(a, [mask])` and returns a value of type `a`.</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">    The original function is modified to accept an additional argument `mask`, which is a boolean value indicating whether the operation should be masked or not. The function returns the result of the original operation if `mask` is `True`, and the original input if `mask` is `False`.</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">    All traced values from the kernel generative function are traced (with an added axis due to the scan) but only those indices from [mask] with a flag of True will accounted for in inference, notably for score computations.</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">        import jax</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">        masks = jnp.array([True, False, True])</span>
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">        # Create a kernel generative function</span>
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">        def step(x):</span>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">            _ = (</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">                genjax.normal.mask().vmap(in_axes=(0, None, None))(masks, x, 1.0)</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">                @ &quot;rats&quot;</span>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">            )</span>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">            return x</span>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">        # Create a model using masked_iterate_final</span>
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">        model = step.masked_iterate_final()</span>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">        # Simulate from the model</span>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">        mask_steps = jnp.arange(10) &lt; 5</span>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">        tr = model.simulate(key, (0.0, mask_steps))</span>
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">        ```</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">masked_iterate_final</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.mix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">mix</span>


<a href="#genjax.core.GenerativeFunction.mix" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">mix</span><span class="p">(</span><span class="o">*</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;*fns&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.mix(*fns)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.mix(*fns)">fns</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Takes any number of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a>s and returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that represents a mixture model.</p>
<p>The returned generative function takes the following arguments:</p>
<ul>
<li><code>mixture_logits</code>: Logits for the categorical distribution used to select a component.</li>
<li><code>*args</code>: Argument tuples for <code>self</code> and each of the input generative functions</li>
</ul>
<p>and samples from <code>self</code> or one of the input generative functions based on a draw from a categorical distribution defined by the provided mixture logits.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.mix(*fns)" class="doc doc-heading doc-heading-parameter">                  <code>*fns</code>
<a href="#genjax.core.GenerativeFunction.mix(*fns)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variable number of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a>s to be mixed with <code>self</code>.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> representing the mixture model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>```python exec="yes" html="true" source="material-block" session="mix"
import jax
import genjax</p>
<h4 id="genjax.core.GenerativeFunction.mix--define-component-generative-functions">Define component generative functions<a class="headerlink" href="#genjax.core.GenerativeFunction.mix--define-component-generative-functions" title="Permanent link">&para;</a></h4>
<p>@genjax.gen
def component1(x):
    return genjax.normal(x, 1.0) @ "y"</p>
<p>@genjax.gen
def component2(x):
    return genjax.normal(x, 2.0) @ "y"</p>
<h4 id="genjax.core.GenerativeFunction.mix--create-mixture-model">Create mixture model<a class="headerlink" href="#genjax.core.GenerativeFunction.mix--create-mixture-model" title="Permanent link">&para;</a></h4>
<p>mixture = component1.mix(component2)</p>
<h4 id="genjax.core.GenerativeFunction.mix--use-the-mixture-model">Use the mixture model<a class="headerlink" href="#genjax.core.GenerativeFunction.mix--use-the-mixture-model" title="Permanent link">&para;</a></h4>
<p>key = jax.random.key(0)
logits = jax.numpy.array([0.3, 0.7])  # Favors component2
trace = mixture.simulate(key, (logits, (0.0,), (7.0,)))
print(trace.render_html())
    ```</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1291"><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="k">def</span><span class="w"> </span><span class="nf">mix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fns</span><span class="p">:</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1292"><a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1293"><a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">    Takes any number of [`genjax.GenerativeFunction`][]s and returns a new [`genjax.GenerativeFunction`][] that represents a mixture model.</span>
</span><span id="__span-0-1294"><a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>
</span><span id="__span-0-1295"><a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">    The returned generative function takes the following arguments:</span>
</span><span id="__span-0-1296"><a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>
</span><span id="__span-0-1297"><a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="sd">    - `mixture_logits`: Logits for the categorical distribution used to select a component.</span>
</span><span id="__span-0-1298"><a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><span class="sd">    - `*args`: Argument tuples for `self` and each of the input generative functions</span>
</span><span id="__span-0-1299"><a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>
</span><span id="__span-0-1300"><a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">    and samples from `self` or one of the input generative functions based on a draw from a categorical distribution defined by the provided mixture logits.</span>
</span><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><span class="sd">        *fns: Variable number of [`genjax.GenerativeFunction`][]s to be mixed with `self`.</span>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">        A new [`genjax.GenerativeFunction`][] representing the mixture model.</span>
</span><span id="__span-0-1307"><a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>
</span><span id="__span-0-1308"><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1309"><a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;mix&quot;</span>
</span><span id="__span-0-1310"><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">        import jax</span>
</span><span id="__span-0-1311"><a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-1312"><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>
</span><span id="__span-0-1313"><a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>
</span><span id="__span-0-1314"><a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">        # Define component generative functions</span>
</span><span id="__span-0-1315"><a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1316"><a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="sd">        def component1(x):</span>
</span><span id="__span-0-1317"><a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="sd">            return genjax.normal(x, 1.0) @ &quot;y&quot;</span>
</span><span id="__span-0-1318"><a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>
</span><span id="__span-0-1319"><a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
</span><span id="__span-0-1320"><a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1321"><a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">        def component2(x):</span>
</span><span id="__span-0-1322"><a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">            return genjax.normal(x, 2.0) @ &quot;y&quot;</span>
</span><span id="__span-0-1323"><a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
</span><span id="__span-0-1324"><a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>
</span><span id="__span-0-1325"><a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">        # Create mixture model</span>
</span><span id="__span-0-1326"><a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">        mixture = component1.mix(component2)</span>
</span><span id="__span-0-1327"><a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
</span><span id="__span-0-1328"><a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">        # Use the mixture model</span>
</span><span id="__span-0-1329"><a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-1330"><a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">        logits = jax.numpy.array([0.3, 0.7])  # Favors component2</span>
</span><span id="__span-0-1331"><a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">        trace = mixture.simulate(key, (logits, (0.0,), (7.0,)))</span>
</span><span id="__span-0-1332"><a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="sd">        print(trace.render_html())</span>
</span><span id="__span-0-1333"><a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">            ```</span>
</span><span id="__span-0-1334"><a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1335"><a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1336"><a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>
</span><span id="__span-0-1337"><a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">mix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fns</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.or_else" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">or_else</span>


<a href="#genjax.core.GenerativeFunction.or_else" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">or_else</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;gen_fn&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.or_else(gen_fn)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.or_else(gen_fn)">gen_fn</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> that accepts</p>
<ul>
<li>a boolean argument</li>
<li>an argument tuple for <code>self</code></li>
<li>an argument tuple for the supplied <code>gen_fn</code></li>
</ul>
<p>and acts like <code>self</code> when the boolean is <code>True</code> or like <code>gen_fn</code> otherwise.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.or_else(gen_fn)" class="doc doc-heading doc-heading-parameter">                  <code>gen_fn</code>
<a href="#genjax.core.GenerativeFunction.or_else(gen_fn)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>called when the boolean argument is <code>False</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">if_model</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;if_value&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">else_model</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;else_value&quot;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">toss</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="c1"># Note that the returned model takes a new boolean predicate in</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="c1"># addition to argument tuples for each branch.</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="k">return</span> <span class="n">if_model</span><span class="o">.</span><span class="n">or_else</span><span class="p">(</span><span class="n">else_model</span><span class="p">)(</span><span class="n">toss</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,),</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,))</span> <span class="o">@</span> <span class="s2">&quot;tossed&quot;</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,))</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_ea2a95b88e1c4905abc1afa94dc9ade8" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_ea2a95b88e1c4905abc1afa94dc9ade8")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_ea2a95b88e1c4905abc1afa94dc9ade8")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="k">def</span><span class="w"> </span><span class="nf">or_else</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gen_fn</span><span class="p">:</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">    Returns a [`GenerativeFunction`][genjax.GenerativeFunction] that accepts</span>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">    - a boolean argument</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">    - an argument tuple for `self`</span>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">    - an argument tuple for the supplied `gen_fn`</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">    and acts like `self` when the boolean is `True` or like `gen_fn` otherwise.</span>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">        gen_fn: called when the boolean argument is `False`.</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;gen-fn&quot;</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">        import jax</span>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">        import jax.numpy as jnp</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">        def if_model(x):</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">            return genjax.normal(x, 1.0) @ &quot;if_value&quot;</span>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">        def else_model(x):</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">            return genjax.normal(x, 5.0) @ &quot;else_value&quot;</span>
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">        def model(toss: bool):</span>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">            # Note that the returned model takes a new boolean predicate in</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">            # addition to argument tuples for each branch.</span>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">            return if_model.or_else(else_model)(toss, (1.0,), (10.0,)) @ &quot;tossed&quot;</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">        tr = jax.jit(model.simulate)(key, (True,))</span>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">        ```</span>
</span><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">or_else</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gen_fn</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.propose" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">propose</span>


<a href="#genjax.core.GenerativeFunction.propose" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">propose</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax.core.GenerativeFunction.propose(key)">key</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.PRNGKey">PRNGKey</span></span><span class="p">,</span> <span class="n"><span title="genjax.core.GenerativeFunction.propose(args)">args</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Arguments&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Arguments&lt;/code&gt;)" href="#genjax.core.Arguments">Arguments</a></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Score&lt;/code&gt;)" href="#genjax.core.Score">Score</a></span><span class="p">,</span> <span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Samples a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt;" href="#genjax.core.ChoiceMap"><code>ChoiceMap</code></a> and any untraced randomness <span class="arithmatex">\(r\)</span> from the generative function's distribution over samples (<span class="arithmatex">\(P\)</span>), and returns the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Score"><code>Score</code></a> of that sample under the distribution, and the <code>R</code> of the generative function's return value function <span class="arithmatex">\(f(r, t, a)\)</span> for the sample and untraced randomness.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="k">def</span><span class="w"> </span><span class="nf">propose</span><span class="p">(</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ChoiceMap</span><span class="p">,</span> <span class="n">Score</span><span class="p">,</span> <span class="n">R</span><span class="p">]:</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">    Samples a [`ChoiceMap`][genjax.core.ChoiceMap] and any untraced randomness $r$ from the generative function&#39;s distribution over samples ($P$), and returns the [`Score`][genjax.core.Score] of that sample under the distribution, and the `R` of the generative function&#39;s return value function $f(r, t, a)$ for the sample and untraced randomness.</span>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-685"><a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</span><span id="__span-0-686"><a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span>
</span><span id="__span-0-687"><a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="n">score</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_score</span><span class="p">()</span>
</span><span id="__span-0-688"><a id="__codelineno-0-688" name="__codelineno-0-688"></a>    <span class="n">retval</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_retval</span><span class="p">()</span>
</span><span id="__span-0-689"><a id="__codelineno-0-689" name="__codelineno-0-689"></a>    <span class="k">return</span> <span class="n">sample</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">retval</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.reduce" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reduce</span>


<a href="#genjax.core.GenerativeFunction.reduce" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">reduce</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>When called on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, a) -&gt; c</code>, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, [a]) -&gt; c</code> where</p>
<ul>
<li><code>c</code> is a loop-carried value, which must hold a fixed shape and dtype across all iterations</li>
<li><code>a</code> may be a primitive, an array type or a pytree (container) type with array leaves</li>
</ul>
<p>All traced values are nested under an index.</p>
<p>For any array type specifier <code>t</code>, <code>[t]</code> represents the type with an additional leading axis, and if <code>t</code> is a pytree (container) type with array leaves then <code>[t]</code> represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</p>
<p>The semantics of the returned <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> are given roughly by this Python implementation (note the similarity to <a href="https://docs.python.org/3/library/itertools.html#functools.reduce"><code>functools.reduce</code></a>):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">xs</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">carry</span> <span class="o">=</span> <span class="n">init</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">:</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="n">carry</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">carry</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">return</span> <span class="n">carry</span>
</span></code></pre></div>
<p>Unlike that Python version, both <code>xs</code> and <code>carry</code> may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays.</p>
<p>The loop-carried value <code>c</code> must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type <code>c</code> in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>sum an array of numbers:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="nb">sum</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">new_sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">x</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">return</span> <span class="n">new_sum</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">init</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">xs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">xs</span><span class="p">))</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_9e4aea50e60245058d23d36cb41b4dd0" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_9e4aea50e60245058d23d36cb41b4dd0")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_9e4aea50e60245058d23d36cb41b4dd0")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    When called on a [`genjax.GenerativeFunction`][] of type `(c, a) -&gt; c`, returns a new [`genjax.GenerativeFunction`][] of type `(c, [a]) -&gt; c` where</span>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">    - `c` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    - `a` may be a primitive, an array type or a pytree (container) type with array leaves</span>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">    All traced values are nested under an index.</span>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    For any array type specifier `t`, `[t]` represents the type with an additional leading axis, and if `t` is a pytree (container) type with array leaves then `[t]` represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</span>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">    The semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation (note the similarity to [`functools.reduce`](https://docs.python.org/3/library/itertools.html#functools.reduce)):</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a>
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">    ```python</span>
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">    def reduce(f, init, xs):</span>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">        carry = init</span>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        for x in xs:</span>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            carry = f(carry, x)</span>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">        return carry</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">    ```</span>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">    Unlike that Python version, both `xs` and `carry` may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays.</span>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">    The loop-carried value `c` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `c` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">        sum an array of numbers:</span>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">        import jax</span>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">        import jax.numpy as jnp</span>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a>
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">        @genjax.reduce()</span>
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">        def add(sum, x):</span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">            new_sum = sum + x</span>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">            return new_sum</span>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        init = 0.0</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        xs = jnp.ones(10)</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">        tr = jax.jit(add.simulate)(key, (init, xs))</span>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">        ```</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968"></a>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">reduce</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.repeat" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">repeat</span>


<a href="#genjax.core.GenerativeFunction.repeat" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">repeat</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;n&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.repeat(n)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.repeat(n)">n</a></span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that samples from <code>self</code> <code>n</code> times, returning a vector of <code>n</code> results.</p>
<p>The values traced by each call <code>gen_fn</code> will be nested under an integer index that matches the loop iteration index that generated it.</p>
<p>This combinator is useful for creating multiple samples from <code>self</code> in a batched manner.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.repeat(n)" class="doc doc-heading doc-heading-parameter">                  <code>n</code>
<a href="#genjax.core.GenerativeFunction.repeat(n)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of times to sample from the generative function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that samples from the original function <code>n</code> times.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span><span class="o">,</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">normal_draw</span><span class="p">(</span><span class="n">mean</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;x&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">normal_draws</span> <span class="o">=</span> <span class="n">normal_draw</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c1"># Generate 10 draws from a normal distribution with mean 2.0</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">normal_draws</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,))</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_a7242b75020643738023cedcfb124d6f" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_a7242b75020643738023cedcfb124d6f")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_a7242b75020643738023cedcfb124d6f")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-739"><a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="k">def</span><span class="w"> </span><span class="nf">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-740"><a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-741"><a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">    Returns a [`genjax.GenerativeFunction`][] that samples from `self` `n` times, returning a vector of `n` results.</span>
</span><span id="__span-0-742"><a id="__codelineno-0-742" name="__codelineno-0-742"></a>
</span><span id="__span-0-743"><a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">    The values traced by each call `gen_fn` will be nested under an integer index that matches the loop iteration index that generated it.</span>
</span><span id="__span-0-744"><a id="__codelineno-0-744" name="__codelineno-0-744"></a>
</span><span id="__span-0-745"><a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">    This combinator is useful for creating multiple samples from `self` in a batched manner.</span>
</span><span id="__span-0-746"><a id="__codelineno-0-746" name="__codelineno-0-746"></a>
</span><span id="__span-0-747"><a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">    Args:</span>
</span><span id="__span-0-748"><a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        n: The number of times to sample from the generative function.</span>
</span><span id="__span-0-749"><a id="__codelineno-0-749" name="__codelineno-0-749"></a>
</span><span id="__span-0-750"><a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-751"><a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">        A new [`genjax.GenerativeFunction`][] that samples from the original function `n` times.</span>
</span><span id="__span-0-752"><a id="__codelineno-0-752" name="__codelineno-0-752"></a>
</span><span id="__span-0-753"><a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-754"><a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;repeat&quot;</span>
</span><span id="__span-0-755"><a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">        import genjax, jax</span>
</span><span id="__span-0-756"><a id="__codelineno-0-756" name="__codelineno-0-756"></a>
</span><span id="__span-0-757"><a id="__codelineno-0-757" name="__codelineno-0-757"></a>
</span><span id="__span-0-758"><a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-759"><a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">        def normal_draw(mean):</span>
</span><span id="__span-0-760"><a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">            return genjax.normal(mean, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-761"><a id="__codelineno-0-761" name="__codelineno-0-761"></a>
</span><span id="__span-0-762"><a id="__codelineno-0-762" name="__codelineno-0-762"></a>
</span><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">        normal_draws = normal_draw.repeat(n=10)</span>
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764"></a>
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766"></a>
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        # Generate 10 draws from a normal distribution with mean 2.0</span>
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">        tr = jax.jit(normal_draws.simulate)(key, (2.0,))</span>
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">        ```</span>
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773"></a>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.scan" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">scan</span>


<a href="#genjax.core.GenerativeFunction.scan" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">scan</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="o">*</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;n&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.scan(n)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.scan(n)">n</a></span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.Carry">Carry</span></span><span class="p">,</span> <span class="n"><span title="genjax._src.core.generative.generative_function.Y">Y</span></span><span class="p">]]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>When called on a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, a) -&gt; (c, b)</code>, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> of type <code>(c, [a]) -&gt; (c, [b])</code> where</p>
<ul>
<li><code>c</code> is a loop-carried value, which must hold a fixed shape and dtype across all iterations</li>
<li><code>a</code> may be a primitive, an array type or a pytree (container) type with array leaves</li>
<li><code>b</code> may be a primitive, an array type or a pytree (container) type with array leaves.</li>
</ul>
<p>The values traced by each call to the original generative function will be nested under an integer index that matches the loop iteration index that generated it.</p>
<p>For any array type specifier <code>t</code>, <code>[t]</code> represents the type with an additional leading axis, and if <code>t</code> is a pytree (container) type with array leaves then <code>[t]</code> represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</p>
<p>When the type of <code>xs</code> in the snippet below (denoted <code>[a]</code> above) is an array type or None, and the type of <code>ys</code> in the snippet below (denoted <code>[b]</code> above) is an array type, the semantics of the returned <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> are given roughly by this Python implementation:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scan</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="k">if</span> <span class="n">xs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">length</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">carry</span> <span class="o">=</span> <span class="n">init</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">:</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="n">carry</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">carry</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">return</span> <span class="n">carry</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span></code></pre></div>
<p>Unlike that Python version, both <code>xs</code> and <code>ys</code> may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays. <code>None</code> is actually a special case of this, as it represents an empty pytree.</p>
<p>The loop-carried value <code>c</code> must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type <code>c</code> in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.scan(n)" class="doc doc-heading doc-heading-parameter">                  <code>n</code>
<a href="#genjax.core.GenerativeFunction.scan(n)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional integer specifying the number of loop iterations, which (if supplied) must agree with the sizes of leading axes of the arrays in the returned function's second argument. If supplied then the returned generative function can take <code>None</code> as its second argument.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="tuple">tuple</span>[<span title="genjax._src.core.generative.generative_function.Carry">Carry</span>, <span title="genjax._src.core.generative.generative_function.Y">Y</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that takes a loop-carried value and a new input, and returns a new loop-carried value along with either <code>None</code> or an output to be collected into the second return value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Scan for 1000 iterations with no array input:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">random_walk_step</span><span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;x&quot;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">random_walk</span> <span class="o">=</span> <span class="n">random_walk_step</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">init</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">random_walk</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_290829eb3f8b46718a73657d040e02c9" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_290829eb3f8b46718a73657d040e02c9")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_290829eb3f8b46718a73657d040e02c9")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
<p>Scan across an input array:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_and_square_step</span><span class="p">(</span><span class="nb">sum</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">new_sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">x</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">return</span> <span class="n">new_sum</span><span class="p">,</span> <span class="nb">sum</span> <span class="o">*</span> <span class="nb">sum</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># notice no `n` parameter supplied:</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">add_and_square_all</span> <span class="o">=</span> <span class="n">add_and_square_step</span><span class="o">.</span><span class="n">scan</span><span class="p">()</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">init</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">xs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">add_and_square_all</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">xs</span><span class="p">))</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># The retval has the final carry and an array of all `sum*sum` returned.</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_532a4becd4ad438792ed56e926880e4d" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_532a4becd4ad438792ed56e926880e4d")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_532a4becd4ad438792ed56e926880e4d")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-776"><a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="k">def</span><span class="w"> </span><span class="nf">scan</span><span class="p">(</span>
</span><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777"></a>    <span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;GenerativeFunction[tuple[Carry, Y]]&quot;</span><span class="p">,</span>
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778"></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[tuple[Carry, Y]]&quot;</span><span class="p">:</span>
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">    When called on a [`genjax.GenerativeFunction`][] of type `(c, a) -&gt; (c, b)`, returns a new [`genjax.GenerativeFunction`][] of type `(c, [a]) -&gt; (c, [b])` where</span>
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784"></a>
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">    - `c` is a loop-carried value, which must hold a fixed shape and dtype across all iterations</span>
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">    - `a` may be a primitive, an array type or a pytree (container) type with array leaves</span>
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">    - `b` may be a primitive, an array type or a pytree (container) type with array leaves.</span>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788"></a>
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">    The values traced by each call to the original generative function will be nested under an integer index that matches the loop iteration index that generated it.</span>
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790"></a>
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">    For any array type specifier `t`, `[t]` represents the type with an additional leading axis, and if `t` is a pytree (container) type with array leaves then `[t]` represents the type with the same pytree structure and corresponding leaves each with an additional leading axis.</span>
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792"></a>
</span><span id="__span-0-793"><a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">    When the type of `xs` in the snippet below (denoted `[a]` above) is an array type or None, and the type of `ys` in the snippet below (denoted `[b]` above) is an array type, the semantics of the returned [`genjax.GenerativeFunction`][] are given roughly by this Python implementation:</span>
</span><span id="__span-0-794"><a id="__codelineno-0-794" name="__codelineno-0-794"></a>
</span><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">    ```python</span>
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">    def scan(f, init, xs, length=None):</span>
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        if xs is None:</span>
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">            xs = [None] * length</span>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">        carry = init</span>
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">        ys = []</span>
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">        for x in xs:</span>
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">            carry, y = f(carry, x)</span>
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">            ys.append(y)</span>
</span><span id="__span-0-804"><a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">        return carry, np.stack(ys)</span>
</span><span id="__span-0-805"><a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">    ```</span>
</span><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806"></a>
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">    Unlike that Python version, both `xs` and `ys` may be arbitrary pytree values, and so multiple arrays can be scanned over at once and produce multiple output arrays. `None` is actually a special case of this, as it represents an empty pytree.</span>
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808"></a>
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">    The loop-carried value `c` must hold a fixed shape and dtype across all iterations (and not just be consistent up to NumPy rank/shape broadcasting and dtype promotion rules, for example). In other words, the type `c` in the type signature above represents an array with a fixed shape and dtype (or a nested tuple/list/dict container data structure with a fixed structure and arrays with fixed shape and dtype at the leaves).</span>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810"></a>
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">    Args:</span>
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">        n: optional integer specifying the number of loop iterations, which (if supplied) must agree with the sizes of leading axes of the arrays in the returned function&#39;s second argument. If supplied then the returned generative function can take `None` as its second argument.</span>
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813"></a>
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">        A new [`genjax.GenerativeFunction`][] that takes a loop-carried value and a new input, and returns a new loop-carried value along with either `None` or an output to be collected into the second return value.</span>
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816"></a>
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">        Scan for 1000 iterations with no array input:</span>
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">        import jax</span>
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822"></a>
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823"></a>
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">        def random_walk_step(prev, _):</span>
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">            x = genjax.normal(prev, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">            return x, None</span>
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828"></a>
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829"></a>
</span><span id="__span-0-830"><a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">        random_walk = random_walk_step.scan(n=1000)</span>
</span><span id="__span-0-831"><a id="__codelineno-0-831" name="__codelineno-0-831"></a>
</span><span id="__span-0-832"><a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">        init = 0.5</span>
</span><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834"></a>
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">        tr = jax.jit(random_walk.simulate)(key, (init, None))</span>
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">        ```</span>
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838"></a>
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        Scan across an input array:</span>
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;scan&quot;</span>
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        import jax.numpy as jnp</span>
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842"></a>
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843"></a>
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">        def add_and_square_step(sum, x):</span>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">            new_sum = sum + x</span>
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">            return new_sum, sum * sum</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">        # notice no `n` parameter supplied:</span>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">        add_and_square_all = add_and_square_step.scan()</span>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">        init = 0.0</span>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">        xs = jnp.ones(10)</span>
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">        tr = jax.jit(add_and_square_all.simulate)(key, (init, xs))</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">        # The retval has the final carry and an array of all `sum*sum` returned.</span>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">        ```</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862"></a>
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.simulate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">simulate</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.GenerativeFunction.simulate" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">simulate</span><span class="p">(</span><span class="n"><span title="genjax.core.GenerativeFunction.simulate(key)">key</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.PRNGKey">PRNGKey</span></span><span class="p">,</span> <span class="n"><span title="genjax.core.GenerativeFunction.simulate(args)">args</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Arguments&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Arguments&lt;/code&gt;)" href="#genjax.core.Arguments">Arguments</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.Trace&lt;/code&gt;)" href="#genjax.core.Trace">Trace</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Execute the generative function, sampling from its distribution over samples, and return a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>.</p>
<h5 id="genjax.core.GenerativeFunction.simulate--more-on-traces">More on traces<a class="headerlink" href="#genjax.core.GenerativeFunction.simulate--more-on-traces" title="Permanent link">&para;</a></h5>
<p>The <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a> returned by <code>simulate</code> implements its own interface.</p>
<p>It is responsible for storing the arguments of the invocation (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_args&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_args"><code>genjax.Trace.get_args</code></a>), the return value of the generative function (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_retval&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_retval"><code>genjax.Trace.get_retval</code></a>), the identity of the generative function which produced the trace (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_gen_fn&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_gen_fn"><code>genjax.Trace.get_gen_fn</code></a>), the sample of traced random choices produced during the invocation (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_choices&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_choices"><code>genjax.Trace.get_choices</code></a>) and <em>the score</em> of the sample (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_score"><code>genjax.Trace.get_score</code></a>).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">jax</span><span class="w"> </span><span class="kn">import</span> <span class="n">vmap</span><span class="p">,</span> <span class="n">jit</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">jax.random</span><span class="w"> </span><span class="kn">import</span> <span class="n">split</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">():</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;x&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">())</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_f13a7748554e4a2a95d502e6e2a512e0" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_f13a7748554e4a2a95d502e6e2a512e0")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_f13a7748554e4a2a95d502e6e2a512e0")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>
<p>Another example, using the same model, composed into <a href="combinators.html#genjax.repeat"><code>genjax.repeat</code></a> - which creates a new generative function, which has the same interface:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">():</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;x&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">())</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_7361b6a60d604fc8b1d2884810956ca9" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_7361b6a60d604fc8b1d2884810956ca9")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_7361b6a60d604fc8b1d2884810956ca9")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
<p>(<strong>Fun, flirty, fast ... parallel?</strong>) Feel free to use <code>jax.jit</code> and <code>jax.vmap</code>!
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">sub_keys</span> <span class="o">=</span> <span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">sim</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">simulate</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">vmap</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)))(</span><span class="n">sub_keys</span><span class="p">,</span> <span class="p">())</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_23d430d6458640e18b68043cedfc919e" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_23d430d6458640e18b68043cedfc919e")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_23d430d6458640e18b68043cedfc919e")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span><span class="p">,</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trace</span><span class="p">[</span><span class="n">R</span><span class="p">]:</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    Execute the generative function, sampling from its distribution over samples, and return a [`Trace`][genjax.core.Trace].</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">    ## More on traces</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">    The [`Trace`][genjax.core.Trace] returned by `simulate` implements its own interface.</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">    It is responsible for storing the arguments of the invocation ([`genjax.Trace.get_args`][]), the return value of the generative function ([`genjax.Trace.get_retval`][]), the identity of the generative function which produced the trace ([`genjax.Trace.get_gen_fn`][]), the sample of traced random choices produced during the invocation ([`genjax.Trace.get_choices`][]) and _the score_ of the sample ([`genjax.Trace.get_score`][]).</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        import jax</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        from jax import vmap, jit</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        from jax.random import split</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        def model():</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            x = genjax.normal(0.0, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">            return x</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        tr = model.simulate(key, ())</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        ```</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        Another example, using the same model, composed into [`genjax.repeat`](combinators.md#genjax.repeat) - which creates a new generative function, which has the same interface:</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        def model():</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            x = genjax.normal(0.0, 1.0) @ &quot;x&quot;</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">            return x</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        tr = model.repeat(n=10).simulate(key, ())</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        ```</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        (**Fun, flirty, fast ... parallel?**) Feel free to use `jax.jit` and `jax.vmap`!</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        key = jax.random.key(0)</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        sub_keys = split(key, 10)</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        sim = model.repeat(n=10).simulate</span>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        tr = jit(vmap(sim, in_axes=(0, None)))(sub_keys, ())</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">        ```</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    &quot;&quot;&quot;</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.switch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">switch</span>


<a href="#genjax.core.GenerativeFunction.switch" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">switch</span><span class="p">(</span><span class="o">*</span><span class="n"><span title="genjax.core.GenerativeFunction.switch(*branches)">branches</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="genjax.Switch">Switch</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Given <code>n</code> <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> inputs, returns a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>genjax.GenerativeFunction</code></a> that accepts <code>n+2</code> arguments:</p>
<ul>
<li>an index in the range <span class="arithmatex">\([0, n+1)\)</span></li>
<li>a tuple of arguments for <code>self</code> and each of the input generative functions (<code>n+1</code> total tuples)</li>
</ul>
<p>and executes the generative function at the supplied index with its provided arguments.</p>
<p>If <code>index</code> is out of bounds, <code>index</code> is clamped to within bounds.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span><span class="o">,</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">branch_1</span><span class="p">():</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;x1&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">branch_2</span><span class="p">():</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;x2&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">switch</span> <span class="o">=</span> <span class="n">branch_1</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="n">branch_2</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">jitted</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">switch</span><span class="o">.</span><span class="n">simulate</span><span class="p">)</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1"># Select `branch_2` by providing 1:</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jitted</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(),</span> <span class="p">()))</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_764d30c01b4d4447b650989c28c726d1" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_764d30c01b4d4447b650989c28c726d1")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_764d30c01b4d4447b650989c28c726d1")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="k">def</span><span class="w"> </span><span class="nf">switch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">branches</span><span class="p">:</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;genjax.Switch[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">    Given `n` [`genjax.GenerativeFunction`][] inputs, returns a new [`genjax.GenerativeFunction`][] that accepts `n+2` arguments:</span>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">    - an index in the range $[0, n+1)$</span>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">    - a tuple of arguments for `self` and each of the input generative functions (`n+1` total tuples)</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">    and executes the generative function at the supplied index with its provided arguments.</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">    If `index` is out of bounds, `index` is clamped to within bounds.</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;switch&quot;</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">        import jax, genjax</span>
</span><span id="__span-0-1264"><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
</span><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1267"><a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">        def branch_1():</span>
</span><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">            x = genjax.normal(0.0, 1.0) @ &quot;x1&quot;</span>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">        def branch_2():</span>
</span><span id="__span-0-1273"><a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">            x = genjax.bernoulli(0.3) @ &quot;x2&quot;</span>
</span><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">        switch = branch_1.switch(branch_2)</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-1279"><a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">        jitted = jax.jit(switch.simulate)</span>
</span><span id="__span-0-1280"><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>
</span><span id="__span-0-1281"><a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">        # Select `branch_2` by providing 1:</span>
</span><span id="__span-0-1282"><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">        tr = jitted(key, (1, (), ()))</span>
</span><span id="__span-0-1283"><a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>
</span><span id="__span-0-1284"><a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-1285"><a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">        ```</span>
</span><span id="__span-0-1286"><a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1287"><a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-1288"><a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
</span><span id="__span-0-1289"><a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">branches</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.GenerativeFunction.vmap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">vmap</span>


<a href="#genjax.core.GenerativeFunction.vmap" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">vmap</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;in_axes&lt;/code&gt; (&lt;code&gt;genjax.core.GenerativeFunction.vmap(in_axes)&lt;/code&gt;)" href="#genjax.core.GenerativeFunction.vmap(in_axes)">in_axes</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.InAxes">InAxes</span></span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> that performs a vectorized map over the argument specified by <code>in_axes</code>. Traced values are nested under an index, and the retval is vectorized.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.GenerativeFunction.vmap(in_axes)" class="doc doc-heading doc-heading-parameter">                  <code>in_axes</code>
<a href="#genjax.core.GenerativeFunction.vmap(in_axes)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.InAxes">InAxes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Selector specifying which input arguments (or index into them) should be vectorized. Defaults to 0, i.e., the first argument. See <a href="https://jax.readthedocs.io/en/latest/pytrees.html#applying-optional-parameters-to-pytrees">this link</a> for more detail.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> that accepts an argument of one-higher dimension at the position specified by <code>in_axes</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;v&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;q&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">vmapped</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">in_axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">arr</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># `vmapped` accepts an array if numbers instead of the original</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># single number that `model` accepted.</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">vmapped</span><span class="o">.</span><span class="n">simulate</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">arr</span><span class="p">,))</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_f695ca27502c4591ba73e07914a5fb18" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_f695ca27502c4591ba73e07914a5fb18")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_f695ca27502c4591ba73e07914a5fb18")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-700"><a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="k">def</span><span class="w"> </span><span class="nf">vmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">in_axes</span><span class="p">:</span> <span class="n">InAxes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-701"><a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-702"><a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">    Returns a [`GenerativeFunction`][genjax.GenerativeFunction] that performs a vectorized map over the argument specified by `in_axes`. Traced values are nested under an index, and the retval is vectorized.</span>
</span><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703"></a>
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">    Args:</span>
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">        in_axes: Selector specifying which input arguments (or index into them) should be vectorized. Defaults to 0, i.e., the first argument. See [this link](https://jax.readthedocs.io/en/latest/pytrees.html#applying-optional-parameters-to-pytrees) for more detail.</span>
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706"></a>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">        A new [`GenerativeFunction`][genjax.GenerativeFunction] that accepts an argument of one-higher dimension at the position specified by `in_axes`.</span>
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709"></a>
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;gen-fn&quot;</span>
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">        import jax</span>
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">        import jax.numpy as jnp</span>
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715"></a>
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716"></a>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">        def model(x):</span>
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">            v = genjax.normal(x, 1.0) @ &quot;v&quot;</span>
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">            return genjax.normal(v, 0.01) @ &quot;q&quot;</span>
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721"></a>
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722"></a>
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">        vmapped = model.vmap(in_axes=0)</span>
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724"></a>
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">        arr = jnp.ones(100)</span>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727"></a>
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">        # `vmapped` accepts an array if numbers instead of the original</span>
</span><span id="__span-0-729"><a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">        # single number that `model` accepted.</span>
</span><span id="__span-0-730"><a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">        tr = jax.jit(vmapped.simulate)(key, (arr,))</span>
</span><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731"></a>
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">        print(tr.render_html())</span>
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">        ```</span>
</span><span id="__span-0-734"><a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-735"><a id="__codelineno-0-735" name="__codelineno-0-735"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-736"><a id="__codelineno-0-736" name="__codelineno-0-736"></a>
</span><span id="__span-0-737"><a id="__codelineno-0-737" name="__codelineno-0-737"></a>    <span class="k">return</span> <span class="n">genjax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">in_axes</span><span class="o">=</span><span class="n">in_axes</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>Traces are data structures which record (execution and inference) data about the invocation of generative functions. Traces are often specialized to a generative function language, to take advantage of data locality, and other representation optimizations. Traces support a <em>trace interface</em>: a set of accessor methods designed to provide convenient manipulation when handling traces in inference algorithms. We document this interface below for the <code>Trace</code> data type.</p>


<div class="doc doc-object doc-class">



<h2 id="genjax.core.Trace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.Trace</span>


<a href="#genjax.core.Trace" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="genjax._src.core.typing.Generic">Generic</span>[<span title="genjax._src.core.generative.generative_function.R">R</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt; (&lt;code&gt;genjax._src.core.pytree.Pytree&lt;/code&gt;)" href="#genjax.core.Pytree">Pytree</a></code></p>


        <p><code>Trace</code> is the type of traces of generative functions.</p>
<p>A trace is a data structure used to represent sampled executions of
generative functions. Traces track metadata associated with the probabilities
of choices, as well as other data associated with
the invocation of a generative function, including the arguments it
was invoked with, its return value, and the identity of the generative function itself.</p>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt; (&lt;code&gt;genjax.core.Trace.edit&lt;/code&gt;)" href="#genjax.core.Trace.edit">edit</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>This method calls out to the underlying <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>GenerativeFunction.edit</code></a> method - see <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a> and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a> for more information.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_args&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Trace.get_args&lt;/code&gt;)" href="#genjax.core.Trace.get_args">get_args</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Arguments&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Arguments"><code>Arguments</code></a> for the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> invocation which created the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_choices&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Trace.get_choices&lt;/code&gt;)" href="#genjax.core.Trace.get_choices">get_choices</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Retrieves the random choices made in a trace in the form of a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt;" href="#genjax.core.ChoiceMap"><code>genjax.ChoiceMap</code></a>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_gen_fn&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Trace.get_gen_fn&lt;/code&gt;)" href="#genjax.core.Trace.get_gen_fn">get_gen_fn</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> whose invocation created the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_inner_trace&lt;/span&gt; (&lt;code&gt;genjax.core.Trace.get_inner_trace&lt;/code&gt;)" href="#genjax.core.Trace.get_inner_trace">get_inner_trace</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Override this method to provide <code>Trace.get_subtrace</code> support</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_retval&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Trace.get_retval&lt;/code&gt;)" href="#genjax.core.Trace.get_retval">get_retval</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns the <code>R</code> from the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> invocation which created the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Trace.get_score&lt;/code&gt;)" href="#genjax.core.Trace.get_score">get_score</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Return the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Score"><code>Score</code></a> of the <code>Trace</code>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_subtrace&lt;/span&gt; (&lt;code&gt;genjax.core.Trace.get_subtrace&lt;/code&gt;)" href="#genjax.core.Trace.get_subtrace">get_subtrace</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Return the subtrace having the supplied address. Specifying multiple addresses</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;update&lt;/span&gt; (&lt;code&gt;genjax.core.Trace.update&lt;/code&gt;)" href="#genjax.core.Trace.update">update</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>This method calls out to the underlying <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>GenerativeFunction.edit</code></a> method - see <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a> and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a> for more information.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="k">class</span><span class="w"> </span><span class="nc">Trace</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    `Trace` is the type of traces of generative functions.</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    A trace is a data structure used to represent sampled executions of</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    generative functions. Traces track metadata associated with the probabilities</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    of choices, as well as other data associated with</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    the invocation of a generative function, including the arguments it</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    was invoked with, its return value, and the identity of the generative function itself.</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Arguments</span><span class="p">:</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the [`Arguments`][genjax.core.Arguments] for the [`GenerativeFunction`][genjax.core.GenerativeFunction] invocation which created the [`Trace`][genjax.core.Trace].&quot;&quot;&quot;</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_retval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the `R` from the [`GenerativeFunction`][genjax.core.GenerativeFunction] invocation which created the [`Trace`][genjax.core.Trace].&quot;&quot;&quot;</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Score</span><span class="p">:</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the [`Score`][genjax.core.Score] of the `Trace`.</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        The score must satisfy a particular mathematical specification: it&#39;s either an exact density evaluation of $P$ (the distribution over samples) for the sample returned by [`genjax.Trace.get_choices`][], or _a sample from an estimator_ (a density estimate) if the generative function contains _untraced randomness_.</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        Let $s$ be the score, $t$ the sample, and $a$ the arguments: when the generative function contains no _untraced randomness_, the score (in logspace) is given by:</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        $$</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        \\log s := \\log P(t; a)</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        $$</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        (**With untraced randomness**) Gen allows for the possibility of sources of randomness _which are not traced_. When these sources are included in generative computations, the score is defined so that the following property holds:</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        $$</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        \\mathbb{E}_{r\\sim~P(r | t; a)}\\big[\\frac{1}{s}\\big] = \\frac{1}{P(t; a)}</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        $$</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        This property is the one you&#39;d want to be true if you were using a generative function with untraced randomness _as a proposal_ in a routine which uses importance sampling, for instance.</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        In GenJAX, one way you might encounter this is by using pseudo-random routines in your modeling code:</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        ```python</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        # notice how the key is explicit</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        def model_with_untraced_randomness(key: PRNGKey):</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            x = genjax.normal(0.0, 1.0) &quot;x&quot;</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            v = some_random_process(key, x)</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            y = genjax.normal(v, 1.0) @ &quot;y&quot;</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        ```</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        In this case, the score (in logspace) is given by:</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        $$</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        \\log s := \\log P(r, t; a) - \\log Q(r; a)</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        $$</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        which satisfies the requirement by virtue of the fact:</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        $$</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        \\begin{aligned}</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        \\mathbb{E}_{r\\sim~P(r | t; a)}\\big[\\frac{1}{s}\\big] &amp;= \\mathbb{E}_{r\\sim P(r | t; a)}\\big[\\frac{Q(r; a)}{P(r, t; a)} \\big] \\\\ &amp;= \\frac{1}{P(t; a)} \\mathbb{E}_{r\\sim P(r | t; a)}\\big[\\frac{Q(r; a)}{P(r | t; a)}\\big] \\\\</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &amp;= \\frac{1}{P(t; a)}</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        \\end{aligned}</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        $$</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;genjax.ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves the random choices made in a trace in the form of a [`genjax.ChoiceMap`][].&quot;&quot;&quot;</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">pass</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="nd">@nobeartype</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Use .get_choices() instead.&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.8.1&quot;</span><span class="p">)</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_gen_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the [`GenerativeFunction`][genjax.core.GenerativeFunction] whose invocation created the [`Trace`][genjax.core.Trace].&quot;&quot;&quot;</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">pass</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">edit</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">request</span><span class="p">:</span> <span class="n">EditRequest</span><span class="p">,</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">argdiffs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Self</span><span class="p">,</span> <span class="n">Weight</span><span class="p">,</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">EditRequest</span><span class="p">]:</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        This method calls out to the underlying [`GenerativeFunction.edit`][genjax.core.GenerativeFunction.edit] method - see [`EditRequest`][genjax.core.EditRequest] and [`edit`][genjax.core.GenerativeFunction.edit] for more information.</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="n">Diff</span><span class="o">.</span><span class="n">no_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_args</span><span class="p">())</span> <span class="k">if</span> <span class="n">argdiffs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">argdiffs</span><span class="p">,</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="p">)</span>  <span class="c1"># pyright: ignore[reportReturnType]</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">constraint</span><span class="p">:</span> <span class="n">ChoiceMap</span><span class="p">,</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">argdiffs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Self</span><span class="p">,</span> <span class="n">Weight</span><span class="p">,</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">ChoiceMap</span><span class="p">]:</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        This method calls out to the underlying [`GenerativeFunction.edit`][genjax.core.GenerativeFunction.edit] method - see [`EditRequest`][genjax.core.EditRequest] and [`edit`][genjax.core.GenerativeFunction.edit] for more information.</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gen_fn</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="n">constraint</span><span class="p">,</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="n">Diff</span><span class="o">.</span><span class="n">no_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_args</span><span class="p">())</span> <span class="k">if</span> <span class="n">argdiffs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">argdiffs</span><span class="p">,</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="p">)</span>  <span class="c1"># pyright: ignore[reportReturnType]</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">selection</span><span class="p">:</span> <span class="n">Selection</span><span class="p">,</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Weight</span><span class="p">:</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">gen_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gen_fn</span><span class="p">()</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">return</span> <span class="n">gen_fn</span><span class="o">.</span><span class="n">project</span><span class="p">(</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="n">selection</span><span class="p">,</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="p">)</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_subtrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">addresses</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Trace[Any]&quot;</span><span class="p">:</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        Return the subtrace having the supplied address. Specifying multiple addresses</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        will apply the operation recursively.</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        GenJAX does not guarantee the validity of any inference computations performed</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        using information from the returned subtrace. In other words, it is safe to</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        inspect the data of subtraces -- but it not safe to use that data to make decisions</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        about inference. This is true of all the methods on the subtrace, including</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        `Trace.get_args`, `Trace.get_score`, `Trace.get_retval`, etc. It is safe to look,</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        but don&#39;t use the data for non-trivial things!&quot;&quot;&quot;</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="k">lambda</span> <span class="n">tr</span><span class="p">,</span> <span class="n">addr</span><span class="p">:</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_inner_trace</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span> <span class="n">addresses</span><span class="p">,</span> <span class="bp">self</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="p">)</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_inner_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Trace[Any]&quot;</span><span class="p">:</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Override this method to provide `Trace.get_subtrace` support</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        for those trace types that have substructure that can be addressed</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        in this way.</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        NOTE: `get_inner_trace` takes a full `Address` because, unlike `ChoiceMap`, if a user traces to a tupled address like (&quot;a&quot;, &quot;b&quot;), then the resulting `StaticTrace` will store a sub-trace at this address, vs flattening it out.</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        As a result, `tr.get_inner_trace((&quot;a&quot;, &quot;b&quot;))` does not equal `tr.get_inner_trace(&quot;a&quot;).get_inner_trace(&quot;b&quot;)`.&quot;&quot;&quot;</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="s2">&quot;This type of Trace object does not possess subtraces.&quot;</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="p">)</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="c1">###################</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="c1"># Batch semantics #</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="c1">###################</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="nd">@property</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">batch_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_score</span><span class="p">())</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.edit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">edit</span>


<a href="#genjax.core.Trace.edit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">edit</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax.core.Trace.edit(key)">key</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.PRNGKey">PRNGKey</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><span title="genjax.core.Trace.edit(request)">request</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.EditRequest&lt;/code&gt;)" href="#genjax.core.EditRequest">EditRequest</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n"><span title="genjax.core.Trace.edit(argdiffs)">argdiffs</span></span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Self">Self</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Weight&lt;/code&gt;)" href="#genjax.core.Weight">Weight</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Retdiff&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Retdiff&lt;/code&gt;)" href="#genjax.core.Retdiff">Retdiff</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.EditRequest&lt;/code&gt;)" href="#genjax.core.EditRequest">EditRequest</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>This method calls out to the underlying <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>GenerativeFunction.edit</code></a> method - see <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a> and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a> for more information.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="k">def</span><span class="w"> </span><span class="nf">edit</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">request</span><span class="p">:</span> <span class="n">EditRequest</span><span class="p">,</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="n">argdiffs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Self</span><span class="p">,</span> <span class="n">Weight</span><span class="p">,</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">EditRequest</span><span class="p">]:</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    This method calls out to the underlying [`GenerativeFunction.edit`][genjax.core.GenerativeFunction.edit] method - see [`EditRequest`][genjax.core.EditRequest] and [`edit`][genjax.core.GenerativeFunction.edit] for more information.</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">Diff</span><span class="o">.</span><span class="n">no_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_args</span><span class="p">())</span> <span class="k">if</span> <span class="n">argdiffs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">argdiffs</span><span class="p">,</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="p">)</span>  <span class="c1"># pyright: ignore[reportReturnType]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.get_args" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_args</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.Trace.get_args" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_args</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Arguments&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Arguments&lt;/code&gt;)" href="#genjax.core.Arguments">Arguments</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Arguments&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Arguments"><code>Arguments</code></a> for the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> invocation which created the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Arguments</span><span class="p">:</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the [`Arguments`][genjax.core.Arguments] for the [`GenerativeFunction`][genjax.core.GenerativeFunction] invocation which created the [`Trace`][genjax.core.Trace].&quot;&quot;&quot;</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.get_choices" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_choices</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.Trace.get_choices" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_choices</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves the random choices made in a trace in the form of a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt;" href="#genjax.core.ChoiceMap"><code>genjax.ChoiceMap</code></a>.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;genjax.ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves the random choices made in a trace in the form of a [`genjax.ChoiceMap`][].&quot;&quot;&quot;</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">pass</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.get_gen_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_gen_fn</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.Trace.get_gen_fn" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_gen_fn</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> whose invocation created the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_gen_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GenerativeFunction[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the [`GenerativeFunction`][genjax.core.GenerativeFunction] whose invocation created the [`Trace`][genjax.core.Trace].&quot;&quot;&quot;</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">pass</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.get_inner_trace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_inner_trace</span>


<a href="#genjax.core.Trace.get_inner_trace" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_inner_trace</span><span class="p">(</span><span class="n"><span title="genjax.core.Trace.get_inner_trace(_address)">_address</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.generative.choice_map.Address">Address</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.Trace&lt;/code&gt;)" href="#genjax.core.Trace">Trace</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Override this method to provide <code>Trace.get_subtrace</code> support
for those trace types that have substructure that can be addressed
in this way.</p>
<p>NOTE: <code>get_inner_trace</code> takes a full <code>Address</code> because, unlike <code>ChoiceMap</code>, if a user traces to a tupled address like ("a", "b"), then the resulting <code>StaticTrace</code> will store a sub-trace at this address, vs flattening it out.</p>
<p>As a result, <code>tr.get_inner_trace(("a", "b"))</code> does not equal <code>tr.get_inner_trace("a").get_inner_trace("b")</code>.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inner_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Trace[Any]&quot;</span><span class="p">:</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Override this method to provide `Trace.get_subtrace` support</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    for those trace types that have substructure that can be addressed</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    in this way.</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    NOTE: `get_inner_trace` takes a full `Address` because, unlike `ChoiceMap`, if a user traces to a tupled address like (&quot;a&quot;, &quot;b&quot;), then the resulting `StaticTrace` will store a sub-trace at this address, vs flattening it out.</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    As a result, `tr.get_inner_trace((&quot;a&quot;, &quot;b&quot;))` does not equal `tr.get_inner_trace(&quot;a&quot;).get_inner_trace(&quot;b&quot;)`.&quot;&quot;&quot;</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="s2">&quot;This type of Trace object does not possess subtraces.&quot;</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.get_retval" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_retval</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.Trace.get_retval" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_retval</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the <code>R</code> from the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt;" href="#genjax.core.GenerativeFunction"><code>GenerativeFunction</code></a> invocation which created the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt;" href="#genjax.core.Trace"><code>Trace</code></a>.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_retval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the `R` from the [`GenerativeFunction`][genjax.core.GenerativeFunction] invocation which created the [`Trace`][genjax.core.Trace].&quot;&quot;&quot;</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.get_score" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_score</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.Trace.get_score" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_score</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Score&lt;/code&gt;)" href="#genjax.core.Score">Score</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Score&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Score"><code>Score</code></a> of the <code>Trace</code>.</p>
<p>The score must satisfy a particular mathematical specification: it's either an exact density evaluation of <span class="arithmatex">\(P\)</span> (the distribution over samples) for the sample returned by <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_choices&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.Trace.get_choices"><code>genjax.Trace.get_choices</code></a>, or <em>a sample from an estimator</em> (a density estimate) if the generative function contains <em>untraced randomness</em>.</p>
<p>Let <span class="arithmatex">\(s\)</span> be the score, <span class="arithmatex">\(t\)</span> the sample, and <span class="arithmatex">\(a\)</span> the arguments: when the generative function contains no <em>untraced randomness</em>, the score (in logspace) is given by:</p>
<div class="arithmatex">\[
\log s := \log P(t; a)
\]</div>
<p>(<strong>With untraced randomness</strong>) Gen allows for the possibility of sources of randomness <em>which are not traced</em>. When these sources are included in generative computations, the score is defined so that the following property holds:</p>
<div class="arithmatex">\[
\mathbb{E}_{r\sim~P(r | t; a)}\big[\frac{1}{s}\big] = \frac{1}{P(t; a)}
\]</div>
<p>This property is the one you'd want to be true if you were using a generative function with untraced randomness <em>as a proposal</em> in a routine which uses importance sampling, for instance.</p>
<p>In GenJAX, one way you might encounter this is by using pseudo-random routines in your modeling code:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># notice how the key is explicit</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">model_with_untraced_randomness</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">):</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="s2">&quot;x&quot;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">some_random_process</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">genjax</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;y&quot;</span>
</span></code></pre></div></p>
<p>In this case, the score (in logspace) is given by:</p>
<div class="arithmatex">\[
\log s := \log P(r, t; a) - \log Q(r; a)
\]</div>
<p>which satisfies the requirement by virtue of the fact:</p>
<div class="arithmatex">\[
\begin{aligned}
\mathbb{E}_{r\sim~P(r | t; a)}\big[\frac{1}{s}\big] &amp;= \mathbb{E}_{r\sim P(r | t; a)}\big[\frac{Q(r; a)}{P(r, t; a)} \big] \\ &amp;= \frac{1}{P(t; a)} \mathbb{E}_{r\sim P(r | t; a)}\big[\frac{Q(r; a)}{P(r | t; a)}\big] \\
&amp;= \frac{1}{P(t; a)}
\end{aligned}
\]</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Score</span><span class="p">:</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the [`Score`][genjax.core.Score] of the `Trace`.</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    The score must satisfy a particular mathematical specification: it&#39;s either an exact density evaluation of $P$ (the distribution over samples) for the sample returned by [`genjax.Trace.get_choices`][], or _a sample from an estimator_ (a density estimate) if the generative function contains _untraced randomness_.</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Let $s$ be the score, $t$ the sample, and $a$ the arguments: when the generative function contains no _untraced randomness_, the score (in logspace) is given by:</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    $$</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    \\log s := \\log P(t; a)</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    $$</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    (**With untraced randomness**) Gen allows for the possibility of sources of randomness _which are not traced_. When these sources are included in generative computations, the score is defined so that the following property holds:</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    $$</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    \\mathbb{E}_{r\\sim~P(r | t; a)}\\big[\\frac{1}{s}\\big] = \\frac{1}{P(t; a)}</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    $$</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    This property is the one you&#39;d want to be true if you were using a generative function with untraced randomness _as a proposal_ in a routine which uses importance sampling, for instance.</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    In GenJAX, one way you might encounter this is by using pseudo-random routines in your modeling code:</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    ```python</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    # notice how the key is explicit</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    @genjax.gen</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    def model_with_untraced_randomness(key: PRNGKey):</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        x = genjax.normal(0.0, 1.0) &quot;x&quot;</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        v = some_random_process(key, x)</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        y = genjax.normal(v, 1.0) @ &quot;y&quot;</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    ```</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    In this case, the score (in logspace) is given by:</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    $$</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    \\log s := \\log P(r, t; a) - \\log Q(r; a)</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    $$</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    which satisfies the requirement by virtue of the fact:</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    $$</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    \\begin{aligned}</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    \\mathbb{E}_{r\\sim~P(r | t; a)}\\big[\\frac{1}{s}\\big] &amp;= \\mathbb{E}_{r\\sim P(r | t; a)}\\big[\\frac{Q(r; a)}{P(r, t; a)} \\big] \\\\ &amp;= \\frac{1}{P(t; a)} \\mathbb{E}_{r\\sim P(r | t; a)}\\big[\\frac{Q(r; a)}{P(r | t; a)}\\big] \\\\</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    &amp;= \\frac{1}{P(t; a)}</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    \\end{aligned}</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    $$</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    &quot;&quot;&quot;</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.get_subtrace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_subtrace</span>


<a href="#genjax.core.Trace.get_subtrace" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_subtrace</span><span class="p">(</span><span class="o">*</span><span class="n"><span title="genjax.core.Trace.get_subtrace(*addresses)">addresses</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.generative.choice_map.Address">Address</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Trace&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.generative_function.Trace&lt;/code&gt;)" href="#genjax.core.Trace">Trace</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the subtrace having the supplied address. Specifying multiple addresses
will apply the operation recursively.</p>
<p>GenJAX does not guarantee the validity of any inference computations performed
using information from the returned subtrace. In other words, it is safe to
inspect the data of subtraces -- but it not safe to use that data to make decisions
about inference. This is true of all the methods on the subtrace, including
<code>Trace.get_args</code>, <code>Trace.get_score</code>, <code>Trace.get_retval</code>, etc. It is safe to look,
but don't use the data for non-trivial things!</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_subtrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">addresses</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Trace[Any]&quot;</span><span class="p">:</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Return the subtrace having the supplied address. Specifying multiple addresses</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    will apply the operation recursively.</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    GenJAX does not guarantee the validity of any inference computations performed</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    using information from the returned subtrace. In other words, it is safe to</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    inspect the data of subtraces -- but it not safe to use that data to make decisions</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    about inference. This is true of all the methods on the subtrace, including</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    `Trace.get_args`, `Trace.get_score`, `Trace.get_retval`, etc. It is safe to look,</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    but don&#39;t use the data for non-trivial things!&quot;&quot;&quot;</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">lambda</span> <span class="n">tr</span><span class="p">,</span> <span class="n">addr</span><span class="p">:</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_inner_trace</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span> <span class="n">addresses</span><span class="p">,</span> <span class="bp">self</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Trace.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#genjax.core.Trace.update" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">update</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax.core.Trace.update(key)">key</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.PRNGKey">PRNGKey</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><span title="genjax.core.Trace.update(constraint)">constraint</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n"><span title="genjax.core.Trace.update(argdiffs)">argdiffs</span></span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Self">Self</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Weight&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Weight&lt;/code&gt;)" href="#genjax.core.Weight">Weight</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;genjax.core.Retdiff&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.concepts.Retdiff&lt;/code&gt;)" href="#genjax.core.Retdiff">Retdiff</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.generative_function.R">R</span></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>This method calls out to the underlying <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>GenerativeFunction.edit</code></a> method - see <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.EditRequest&lt;/span&gt;" href="#genjax.core.EditRequest"><code>EditRequest</code></a> and <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a> for more information.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/generative_function.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">constraint</span><span class="p">:</span> <span class="n">ChoiceMap</span><span class="p">,</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">argdiffs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Self</span><span class="p">,</span> <span class="n">Weight</span><span class="p">,</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">ChoiceMap</span><span class="p">]:</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    This method calls out to the underlying [`GenerativeFunction.edit`][genjax.core.GenerativeFunction.edit] method - see [`EditRequest`][genjax.core.EditRequest] and [`edit`][genjax.core.GenerativeFunction.edit] for more information.</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gen_fn</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">key</span><span class="p">,</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">constraint</span><span class="p">,</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">Diff</span><span class="o">.</span><span class="n">no_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_args</span><span class="p">())</span> <span class="k">if</span> <span class="n">argdiffs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">argdiffs</span><span class="p">,</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="p">)</span>  <span class="c1"># pyright: ignore[reportReturnType]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="genjax.core.EditRequest" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.EditRequest</span>


<a href="#genjax.core.EditRequest" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt; (&lt;code&gt;genjax._src.core.pytree.Pytree&lt;/code&gt;)" href="#genjax.core.Pytree">Pytree</a></code></p>


        <p>An <code>EditRequest</code> is a request to edit a trace of a generative function. Generative functions respond to instances of subtypes of <code>EditRequest</code> by providing an <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a> implementation.</p>
<p>Updating a trace is a common operation in inference processes, but naively mutating the trace will invalidate the mathematical invariants that Gen retains. <code>EditRequest</code> instances denote requests for <em>SMC moves</em> in the framework of <a href="https://proceedings.mlr.press/v206/lew23a.html">SMCP3</a>, which preserve these invariants.</p>











              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/generative/concepts.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="k">class</span><span class="w"> </span><span class="nc">EditRequest</span><span class="p">(</span><span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    An `EditRequest` is a request to edit a trace of a generative function. Generative functions respond to instances of subtypes of `EditRequest` by providing an [`edit`][genjax.core.GenerativeFunction.edit] implementation.</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    Updating a trace is a common operation in inference processes, but naively mutating the trace will invalidate the mathematical invariants that Gen retains. `EditRequest` instances denote requests for _SMC moves_ in the framework of [SMCP3](https://proceedings.mlr.press/v206/lew23a.html), which preserve these invariants.</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">edit</span><span class="p">(</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">,</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">tr</span><span class="p">:</span> <span class="s2">&quot;genjax.Trace[R]&quot;</span><span class="p">,</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">argdiffs</span><span class="p">:</span> <span class="n">Argdiffs</span><span class="p">,</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;tuple[genjax.Trace[R], Weight, Retdiff[R], EditRequest]&quot;</span><span class="p">:</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="k">pass</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dimap</span><span class="p">(</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">pre</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Argdiffs</span><span class="p">],</span> <span class="n">Argdiffs</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">post</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">]],</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;genjax.DiffAnnotate[Self]&quot;</span><span class="p">:</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiffAnnotate</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">return</span> <span class="n">DiffAnnotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argdiff_fn</span><span class="o">=</span><span class="n">pre</span><span class="p">,</span> <span class="n">retdiff_fn</span><span class="o">=</span><span class="n">post</span><span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">post</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">]],</span> <span class="n">Retdiff</span><span class="p">[</span><span class="n">R</span><span class="p">]],</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;genjax.DiffAnnotate[Self]&quot;</span><span class="p">:</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="n">post</span><span class="p">)</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">contramap</span><span class="p">(</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">pre</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Argdiffs</span><span class="p">],</span> <span class="n">Argdiffs</span><span class="p">],</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;genjax.DiffAnnotate[Self]&quot;</span><span class="p">:</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h2 id="generative-functions-with-addressed-random-choices">Generative functions with addressed random choices<a class="headerlink" href="#generative-functions-with-addressed-random-choices" title="Permanent link">&para;</a></h2>
<p>Generative functions will often include <em>addressed</em> random choices. These are random choices which are given a name via an addressing syntax, and can be accessed by name via extended interfaces on the <code>ChoiceMap</code> type which supports the addressing.</p>


<div class="doc doc-object doc-class">



<h2 id="genjax.core.ChoiceMap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.ChoiceMap</span>


<a href="#genjax.core.ChoiceMap" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt; (&lt;code&gt;genjax._src.core.pytree.Pytree&lt;/code&gt;)" href="#genjax.core.Pytree">Pytree</a></code></p>


        <p>The type <code>ChoiceMap</code> denotes a map-like value which can be sampled from
generative functions.</p>
<p>Generative functions which utilize <code>ChoiceMap</code> as their sample representation typically support a notion of <em>addressing</em> for the random choices they make. <code>ChoiceMap</code> stores addressed random choices, and provides a data language for querying and manipulating these choices.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>(<strong>Making choice maps</strong>) Choice maps can be constructed using the <code>ChoiceMapBuilder</code> interface
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">chm</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_3ee20e6ed598430698c3b1ffdac8c858" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_3ee20e6ed598430698c3b1ffdac8c858")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_3ee20e6ed598430698c3b1ffdac8c858")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
<p>(<strong>Getting submaps</strong>) Hierarchical choice maps support <code>__call__</code>, which allows for the retrieval of <em>submaps</em> at addresses:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">submap</span> <span class="o">=</span> <span class="n">chm</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">submap</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_08c4d56410cb45b4952e753d7c87de39" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_08c4d56410cb45b4952e753d7c87de39")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_08c4d56410cb45b4952e753d7c87de39")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
<p>(<strong>Getting values</strong>) Choice maps support <code>__getitem__</code>, which allows for the retrieval of <em>values</em> at addresses:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">value</span> <span class="o">=</span> <span class="n">chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>
<div class="result">
3.0

</div></p>
<p>(<strong>Making vectorized choice maps</strong>) Choice maps can be constructed using <code>jax.vmap</code>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMapBuilder</span> <span class="k">as</span> <span class="n">C</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">jax</span><span class="w"> </span><span class="kn">import</span> <span class="n">vmap</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">vec_chm</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">idx</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">C</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">v</span><span class="p">))(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">vec_chm</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_87e7150ab5a641b9a63806b993d9ce7a" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_87e7150ab5a641b9a63806b993d9ce7a")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_87e7150ab5a641b9a63806b993d9ce7a")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__call__&lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.__call__&lt;/code&gt;)" href="#genjax.core.ChoiceMap.__call__">__call__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Alias for <code>get_submap(*addresses)</code>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;choice&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.choice&lt;/code&gt;)" href="#genjax.core.ChoiceMap.choice">choice</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a ChoiceMap containing a single value.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;d&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.d&lt;/code&gt;)" href="#genjax.core.ChoiceMap.d">d</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a ChoiceMap from a dictionary.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;empty&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.empty&lt;/code&gt;)" href="#genjax.core.ChoiceMap.empty">empty</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a ChoiceMap with no values or submaps.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;entry&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.entry&lt;/code&gt;)" href="#genjax.core.ChoiceMap.entry">entry</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a ChoiceMap with a single value at a specified address.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;extend&lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.extend&lt;/code&gt;)" href="#genjax.core.ChoiceMap.extend">extend</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a new ChoiceMap with the given address component as its root.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;filter&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.filter&lt;/code&gt;)" href="#genjax.core.ChoiceMap.filter">filter</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Filter the choice map on the <code>Selection</code>. The resulting choice map only contains the addresses that return True when presented to the selection.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;from_mapping&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.from_mapping&lt;/code&gt;)" href="#genjax.core.ChoiceMap.from_mapping">from_mapping</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a ChoiceMap from an iterable of address-value pairs.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;get_selection&lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.get_selection&lt;/code&gt;)" href="#genjax.core.ChoiceMap.get_selection">get_selection</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a Selection representing the structure of this ChoiceMap.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;invalid_subset&lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.invalid_subset&lt;/code&gt;)" href="#genjax.core.ChoiceMap.invalid_subset">invalid_subset</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Identifies the subset of choices that are invalid for a given generative function and its arguments.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;kw&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.kw&lt;/code&gt;)" href="#genjax.core.ChoiceMap.kw">kw</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a ChoiceMap from keyword arguments.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;mask&lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.mask&lt;/code&gt;)" href="#genjax.core.ChoiceMap.mask">mask</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a new ChoiceMap with values masked by a boolean flag.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;merge&lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.merge&lt;/code&gt;)" href="#genjax.core.ChoiceMap.merge">merge</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Merges this ChoiceMap with another ChoiceMap.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;simplify&lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.simplify&lt;/code&gt;)" href="#genjax.core.ChoiceMap.simplify">simplify</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Previously pushed down filters, now acts as identity.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;static_is_empty&lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.static_is_empty&lt;/code&gt;)" href="#genjax.core.ChoiceMap.static_is_empty">static_is_empty</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns True if this ChoiceMap is equal to <code>ChoiceMap.empty()</code>, False otherwise.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;switch&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.switch&lt;/code&gt;)" href="#genjax.core.ChoiceMap.switch">switch</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a ChoiceMap that switches between multiple ChoiceMaps based on an index.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;at&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.ChoiceMap.at&lt;/code&gt;)" href="#genjax.core.ChoiceMap.at">at</a></code></td>
            <td>
                  <code><span title="genjax._src.core.generative.choice_map._ChoiceMapBuilder">_ChoiceMapBuilder</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns a _ChoiceMapBuilder instance for constructing nested ChoiceMaps.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChoiceMap</span><span class="p">(</span><span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The type `ChoiceMap` denotes a map-like value which can be sampled from</span>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">    generative functions.</span>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">    Generative functions which utilize `ChoiceMap` as their sample representation typically support a notion of _addressing_ for the random choices they make. `ChoiceMap` stores addressed random choices, and provides a data language for querying and manipulating these choices.</span>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">        (**Making choice maps**) Choice maps can be constructed using the `ChoiceMapBuilder` interface</span>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">        chm = C[&quot;x&quot;].set(3.0)</span>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">        print(chm.render_html())</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">        ```</span>
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861"></a>
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">        (**Getting submaps**) Hierarchical choice maps support `__call__`, which allows for the retrieval of _submaps_ at addresses:</span>
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-864"><a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865"></a>
</span><span id="__span-0-866"><a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">        chm = C[&quot;x&quot;, &quot;y&quot;].set(3.0)</span>
</span><span id="__span-0-867"><a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">        submap = chm(&quot;x&quot;)</span>
</span><span id="__span-0-868"><a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">        print(submap.render_html())</span>
</span><span id="__span-0-869"><a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">        ```</span>
</span><span id="__span-0-870"><a id="__codelineno-0-870" name="__codelineno-0-870"></a>
</span><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">        (**Getting values**) Choice maps support `__getitem__`, which allows for the retrieval of _values_ at addresses:</span>
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-873"><a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874"></a>
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">        chm = C[&quot;x&quot;, &quot;y&quot;].set(3.0)</span>
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">        value = chm[&quot;x&quot;, &quot;y&quot;]</span>
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        print(value)</span>
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">        ```</span>
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879"></a>
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        (**Making vectorized choice maps**) Choice maps can be constructed using `jax.vmap`:</span>
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">        from genjax import ChoiceMapBuilder as C</span>
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">        from jax import vmap</span>
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">        import jax.numpy as jnp</span>
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885"></a>
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">        vec_chm = vmap(lambda idx, v: C[&quot;x&quot;, idx].set(v))(jnp.arange(10), jnp.ones(10))</span>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        print(vec_chm.render_html())</span>
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">        ```</span>
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890"></a>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="c1">#######################</span>
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892"></a>    <span class="c1"># Map-like interfaces #</span>
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="c1">#######################</span>
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894"></a>
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection</span><span class="p">:</span> <span class="n">Selection</span> <span class="o">|</span> <span class="n">Flag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">        Filter the choice map on the `Selection`. The resulting choice map only contains the addresses that return True when presented to the selection.</span>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        Args:</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">            selection: The Selection to filter the choice map with.</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a>
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">            A new ChoiceMap containing only the addresses selected by the given Selection.</span>
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">            import jax</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">            from genjax import bernoulli</span>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">            from genjax import SelectionBuilder as S</span>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">            def model():</span>
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">                x = bernoulli(0.3) @ &quot;x&quot;</span>
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">                y = bernoulli(0.3) @ &quot;y&quot;</span>
</span><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">                return x</span>
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">            key = jax.random.key(314159)</span>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">            tr = model.simulate(key, ())</span>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">            chm = tr.get_choices()</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">            selection = S[&quot;x&quot;]</span>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            filtered = chm.filter(selection)</span>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            assert &quot;y&quot; not in filtered</span>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            ```</span>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932"></a>        <span class="k">pass</span>
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933"></a>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_inner_map</span><span class="p">(</span>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="n">addr</span><span class="p">:</span> <span class="n">AddressComponent</span><span class="p">,</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a>        <span class="k">pass</span>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_submap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">addresses</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="n">addr</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a>            <span class="n">label</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">addresses</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">a</span><span class="p">,))</span>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="p">)</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a>        <span class="n">addr</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">AddressComponent</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">_validate_addr</span><span class="p">(</span>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a>            <span class="n">addr</span><span class="p">,</span> <span class="n">allow_partial_slice</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="p">)</span>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">chm</span><span class="p">,</span> <span class="n">addr</span><span class="p">:</span> <span class="n">chm</span><span class="o">.</span><span class="n">get_inner_map</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span> <span class="n">addr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952"></a>
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="c1">######################################</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="c1"># Convenient syntax for construction #</span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="c1">######################################</span>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="n">builder</span><span class="p">:</span> <span class="n">Final</span><span class="p">[</span><span class="n">_ChoiceMapBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ChoiceMapBuilder</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">empty</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">        Returns a ChoiceMap with no values or submaps.</span>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">            An empty ChoiceMap.</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="k">return</span> <span class="n">_empty</span>
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968"></a>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">choice</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">        Creates a ChoiceMap containing a single value.</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">        This method creates and returns an instance of Choice, which represents</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">        a ChoiceMap with a single value at the root level.</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">        Args:</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">            v: The value to be stored in the ChoiceMap.</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">            A ChoiceMap containing the single value.</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a>
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        Example:</span>
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">            from genjax import ChoiceMap</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">            value_chm = ChoiceMap.value(42)</span>
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">            assert value_chm.get_value() == 42</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">            ```</span>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a>        <span class="k">return</span> <span class="n">Choice</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a>    <span class="nd">@nobeartype</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;Use ChoiceMap.choice() instead.&quot;</span><span class="p">)</span>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">value</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="k">return</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998"></a>
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">entry</span><span class="p">(</span>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="n">v</span><span class="p">:</span> <span class="s2">&quot;dict[K_addr, Any] | ChoiceMap | Any&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">addrs</span><span class="p">:</span> <span class="n">AddressComponent</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">        Creates a ChoiceMap with a single value at a specified address.</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">        This method creates and returns a ChoiceMap with a new ChoiceMap stored at</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">        the given address.</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">        - if the provided value is already a ChoiceMap, it will be used directly;</span>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">        - `dict` values will be passed to `ChoiceMap.d`;</span>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        - any other value will be passed to `ChoiceMap.value`.</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">            v: The value to be stored in the ChoiceMap. Can be any value, a dict or a ChoiceMap.</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">            addrs: The address at which to store the value. Can be a static or dynamic address component.</span>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">            A ChoiceMap with the value stored at the specified address.</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">            import genjax</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">            import jax.numpy as jnp</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">            # Using an existing ChoiceMap</span>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">            nested_chm = ChoiceMap.entry(ChoiceMap.value(42), &quot;x&quot;)</span>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">            assert nested_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">            # Using a dict generates a new `ChoiceMap.d` call</span>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">            nested_chm = ChoiceMap.entry({&quot;y&quot;: 42}, &quot;x&quot;)</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">            assert nested_chm[&quot;x&quot;, &quot;y&quot;] == 42</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">            # Static address</span>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">            static_chm = ChoiceMap.entry(42, &quot;x&quot;)</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">            assert static_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">            # Dynamic address</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">            dynamic_chm = ChoiceMap.entry(</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">                jnp.array([1.1, 2.2, 3.3]), jnp.array([1, 2, 3])</span>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">            )</span>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">            assert dynamic_chm[1] == genjax.Mask(1.1, True)</span>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">            ```</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ChoiceMap</span><span class="p">):</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>            <span class="n">chm</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>            <span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>            <span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>        <span class="k">return</span> <span class="n">chm</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="o">*</span><span class="n">addrs</span><span class="p">)</span>
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_mapping</span><span class="p">(</span><span class="n">pairs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">K_addr</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">        Creates a ChoiceMap from an iterable of address-value pairs.</span>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">        This method constructs a ChoiceMap by iterating through the provided pairs,</span>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        where each pair consists of an address (or address component) and a corresponding value.</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        The resulting ChoiceMap will contain all the values at their respective addresses.</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">            pairs: An iterable of tuples, where each tuple contains an address (or address component) and its corresponding value. The address can be a single component or a tuple of components.</span>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1066"><a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">            A ChoiceMap containing all the address-value pairs from the input.</span>
</span><span id="__span-0-1067"><a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
</span><span id="__span-0-1068"><a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">            ```python</span>
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">            pairs = [(&quot;x&quot;, 42), ((&quot;y&quot;, &quot;z&quot;), 10), (&quot;w&quot;, [1, 2, 3])]</span>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">            chm = ChoiceMap.from_mapping(pairs)</span>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">            assert chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">            assert chm[&quot;y&quot;, &quot;z&quot;] == 10</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">            assert chm[&quot;w&quot;] == [1, 2, 3]</span>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">            ```</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">        Note:</span>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">            If multiple pairs have the same address, later pairs will overwrite earlier ones.</span>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>        <span class="n">acc</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>        <span class="k">for</span> <span class="n">addr</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>            <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">addr</span><span class="p">,)</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>            <span class="n">acc</span> <span class="o">|=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">*</span><span class="n">addr</span><span class="p">)</span>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>        <span class="k">return</span> <span class="n">acc</span>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">K_addr</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">        Creates a ChoiceMap from a dictionary.</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">        This method creates and returns a ChoiceMap based on the key-value pairs in the provided dictionary. Each key in the dictionary becomes an address in the ChoiceMap, and the corresponding value is stored at that address.</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">        Dict-shaped values are recursively converted to ChoiceMap instances.</span>
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">            d: A dictionary where keys are addresses and values are the corresponding data to be stored in the ChoiceMap.</span>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">            A ChoiceMap containing the key-value pairs from the input dictionary.</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">            from genjax import ChoiceMap</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">            dict_chm = ChoiceMap.d({&quot;x&quot;: 42, &quot;y&quot;: {&quot;z&quot;: [1, 2, 3]}})</span>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">            assert dict_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">            assert dict_chm[&quot;y&quot;, &quot;z&quot;] == [1, 2, 3]</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">            ```</span>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>        <span class="k">return</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">from_mapping</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">kw</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        Creates a ChoiceMap from keyword arguments.</span>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">        This method creates and returns a ChoiceMap based on the provided keyword arguments.</span>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">        Each keyword argument becomes an address in the ChoiceMap, and its value is stored at that address.</span>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">        Dict-shaped values are recursively converted to ChoiceMap instances with calls to `ChoiceMap.d`.</span>
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">            A ChoiceMap containing the key-value pairs from the input keyword arguments.</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">            kw_chm = ChoiceMap.kw(x=42, y=[1, 2, 3], z={&quot;w&quot;: 10.0})</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">            assert kw_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">            assert kw_chm[&quot;y&quot;] == [1, 2, 3]</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">            assert kw_chm[&quot;z&quot;, &quot;w&quot;] == 10.0</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">            ```</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>        <span class="k">return</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">switch</span><span class="p">(</span><span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">IntArray</span><span class="p">,</span> <span class="n">chms</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ChoiceMap&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">        Creates a ChoiceMap that switches between multiple ChoiceMaps based on an index.</span>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">        This method creates a new ChoiceMap that selectively includes values from a sequence of</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">        input ChoiceMaps based on the provided index. The resulting ChoiceMap will contain</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">        values from the ChoiceMap at the position specified by the index, while masking out</span>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">        values from all other ChoiceMaps.</span>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">            idx: An index or array of indices specifying which ChoiceMap(s) to select from.</span>
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">            chms: An iterable of ChoiceMaps to switch between.</span>
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">            A new ChoiceMap containing values from the selected ChoiceMap(s).</span>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">            chm1 = ChoiceMap.d({&quot;x&quot;: 1, &quot;y&quot;: 2})</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">            chm2 = ChoiceMap.d({&quot;x&quot;: 3, &quot;y&quot;: 4})</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">            chm3 = ChoiceMap.d({&quot;x&quot;: 5, &quot;y&quot;: 6})</span>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">            switched = ChoiceMap.switch(jnp.array(1), [chm1, chm2, chm3])</span>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">            assert switched[&quot;x&quot;].unmask() == 3</span>
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">            assert switched[&quot;y&quot;].unmask() == 4</span>
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">            ```</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>        <span class="k">return</span> <span class="n">Switch</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">chms</span><span class="p">)</span>
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>    <span class="c1">######################</span>
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>    <span class="c1"># Combinator methods #</span>
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>    <span class="c1">######################</span>
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">Flag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">        Returns a new ChoiceMap with values masked by a boolean flag.</span>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">        This method creates a new ChoiceMap where the values are conditionally</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">        included based on the provided flag. If the flag is True, the original</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">        values are retained; if False, the ChoiceMap behaves as if it&#39;s empty.</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">            flag: A boolean flag determining whether to include the values.</span>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><span class="sd">            A new ChoiceMap with values conditionally masked.</span>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">            original_chm = ChoiceMap.value(42)</span>
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">            masked_chm = original_chm.mask(True)</span>
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">            assert masked_chm.get_value() == 42</span>
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">            masked_chm = original_chm.mask(False)</span>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">            assert masked_chm.get_value() is None</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">            ```</span>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">addrs</span><span class="p">:</span> <span class="n">AddressComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">        Returns a new ChoiceMap with the given address component as its root.</span>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">        This method creates a new ChoiceMap where the current ChoiceMap becomes a submap</span>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">        under the specified address component. It effectively adds a new level of hierarchy</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="sd">        to the ChoiceMap structure.</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">            addrs: The address components to use as the new root.</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">            A new ChoiceMap with the current ChoiceMap nested under the given address.</span>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">            original_chm = ChoiceMap.value(42)</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">            indexed_chm = original_chm.extend(&quot;x&quot;)</span>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">            assert indexed_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">            ```</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>        <span class="n">acc</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">addrs</span><span class="p">):</span>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">StaticAddressComponent</span><span class="p">):</span>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>                <span class="n">acc</span> <span class="o">=</span> <span class="n">Static</span><span class="o">.</span><span class="n">build</span><span class="p">({</span><span class="n">addr</span><span class="p">:</span> <span class="n">acc</span><span class="p">})</span>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>                <span class="n">acc</span> <span class="o">=</span> <span class="n">Indexed</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="k">return</span> <span class="n">acc</span>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">        Merges this ChoiceMap with another ChoiceMap.</span>
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">        This method combines the current ChoiceMap with another ChoiceMap using the XOR operation (^). It creates a new ChoiceMap that contains all addresses from both input ChoiceMaps; any overlapping addresses will trigger an error on access at the address via `[&lt;addr&gt;]` or `get_value()`. Use `|` if you don&#39;t want this behavior.</span>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">            other: The ChoiceMap to merge with the current one.</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">            A new ChoiceMap resulting from the merge operation.</span>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">            chm1 = ChoiceMap.value(5).extend(&quot;x&quot;)</span>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">            chm2 = ChoiceMap.value(10).extend(&quot;y&quot;)</span>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">            merged_chm = chm1.merge(chm2)</span>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">            assert merged_chm[&quot;x&quot;] == 5</span>
</span><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">            assert merged_chm[&quot;y&quot;] == 10</span>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">            ```</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">        Note:</span>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">            This method is equivalent to using the | operator between two ChoiceMaps.</span>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>        <span class="k">return</span> <span class="bp">self</span> <span class="o">|</span> <span class="n">other</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Selection</span><span class="p">:</span>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">        Returns a Selection representing the structure of this ChoiceMap.</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">        This method creates a Selection that matches the hierarchical structure</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">        of the current ChoiceMap. The resulting Selection can be used to filter</span>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">        or query other ChoiceMaps with the same structure.</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">            A Selection object representing the structure of this ChoiceMap.</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>
</span><span id="__span-0-1264"><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">            chm = ChoiceMap.value(5).extend(&quot;x&quot;)</span>
</span><span id="__span-0-1267"><a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">            sel = chm.get_selection()</span>
</span><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">            assert sel[&quot;x&quot;] == True</span>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">            assert sel[&quot;y&quot;] == False</span>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">            ```</span>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>        <span class="k">return</span> <span class="n">ChmSel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1273"><a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
</span><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">static_is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">        Returns True if this ChoiceMap is equal to `ChoiceMap.empty()`, False otherwise.</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-1279"><a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>
</span><span id="__span-0-1280"><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>    <span class="c1">###########</span>
</span><span id="__span-0-1281"><a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>    <span class="c1"># Dunders #</span>
</span><span id="__span-0-1282"><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>    <span class="c1">###########</span>
</span><span id="__span-0-1283"><a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>
</span><span id="__span-0-1284"><a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>    <span class="nd">@nobeartype</span>
</span><span id="__span-0-1285"><a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>    <span class="nd">@deprecated</span><span class="p">(</span>
</span><span id="__span-0-1286"><a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;^ is deprecated, please use | or _.merge(...) instead.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1287"><a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>        <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.8.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-1288"><a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>    <span class="p">)</span>
</span><span id="__span-0-1289"><a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1290"><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>        <span class="k">return</span> <span class="bp">self</span> <span class="o">|</span> <span class="n">other</span>
</span><span id="__span-0-1291"><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
</span><span id="__span-0-1292"><a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1293"><a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>        <span class="k">return</span> <span class="n">Or</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="__span-0-1294"><a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>
</span><span id="__span-0-1295"><a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1296"><a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selection</span><span class="p">())</span>
</span><span id="__span-0-1297"><a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
</span><span id="__span-0-1298"><a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1299"><a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>        <span class="k">return</span> <span class="bp">self</span> <span class="o">|</span> <span class="n">other</span>
</span><span id="__span-0-1300"><a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>
</span><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>        <span class="o">*</span><span class="n">addresses</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for `get_submap(*addresses)`.&quot;&quot;&quot;</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_submap</span><span class="p">(</span><span class="o">*</span><span class="n">addresses</span><span class="p">)</span>
</span><span id="__span-0-1307"><a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>
</span><span id="__span-0-1308"><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
</span><span id="__span-0-1309"><a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1310"><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>        <span class="n">addr</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
</span><span id="__span-0-1311"><a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>    <span class="p">):</span>
</span><span id="__span-0-1312"><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>        <span class="n">submap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_submap</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span><span id="__span-0-1313"><a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">submap</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
</span><span id="__span-0-1314"><a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1315"><a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>            <span class="k">raise</span> <span class="n">ChoiceMapNoValueAtAddress</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span><span id="__span-0-1316"><a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1317"><a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>            <span class="k">return</span> <span class="n">v</span>
</span><span id="__span-0-1318"><a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>
</span><span id="__span-0-1319"><a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span>
</span><span id="__span-0-1320"><a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1321"><a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>        <span class="n">addr</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
</span><span id="__span-0-1322"><a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-1323"><a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_submap</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="o">.</span><span class="n">has_value</span><span class="p">()</span>
</span><span id="__span-0-1324"><a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>
</span><span id="__span-0-1325"><a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>    <span class="nd">@property</span>
</span><span id="__span-0-1326"><a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ChoiceMapBuilder</span><span class="p">:</span>
</span><span id="__span-0-1327"><a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1328"><a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">        Returns a _ChoiceMapBuilder instance for constructing nested ChoiceMaps.</span>
</span><span id="__span-0-1329"><a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>
</span><span id="__span-0-1330"><a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">        This property allows for a fluent interface to build complex ChoiceMaps</span>
</span><span id="__span-0-1331"><a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">        by chaining address components and setting values.</span>
</span><span id="__span-0-1332"><a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
</span><span id="__span-0-1333"><a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1334"><a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">            A builder object for constructing ChoiceMaps.</span>
</span><span id="__span-0-1335"><a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>
</span><span id="__span-0-1336"><a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1337"><a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1338"><a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">            from genjax import ChoiceMap</span>
</span><span id="__span-0-1339"><a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>
</span><span id="__span-0-1340"><a id="__codelineno-0-1340" name="__codelineno-0-1340"></a><span class="sd">            chm = ChoiceMap.d({(&quot;x&quot;, &quot;y&quot;): 3.0, &quot;z&quot;: 12.0})</span>
</span><span id="__span-0-1341"><a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">            updated = chm.at[&quot;x&quot;, &quot;y&quot;].set(4.0)</span>
</span><span id="__span-0-1342"><a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>
</span><span id="__span-0-1343"><a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">            assert updated[&quot;x&quot;, &quot;y&quot;] == 4.0</span>
</span><span id="__span-0-1344"><a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><span class="sd">            assert updated[&quot;z&quot;] == chm[&quot;z&quot;]</span>
</span><span id="__span-0-1345"><a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">            ```</span>
</span><span id="__span-0-1346"><a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1347"><a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>        <span class="k">return</span> <span class="n">_ChoiceMapBuilder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-0-1348"><a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>
</span><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>    <span class="nd">@nobeartype</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>    <span class="nd">@deprecated</span><span class="p">(</span>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>        <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Acts as identity; filters are now automatically pushed down.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>        <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.8.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>    <span class="p">)</span>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Previously pushed down filters, now acts as identity.&quot;&quot;&quot;</span>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="__span-0-1357"><a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>
</span><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">invalid_subset</span><span class="p">(</span>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>        <span class="n">gen_fn</span><span class="p">:</span> <span class="s2">&quot;genjax.GenerativeFunction[Any]&quot;</span><span class="p">,</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>        <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap | None&quot;</span><span class="p">:</span>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">        Identifies the subset of choices that are invalid for a given generative function and its arguments.</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">        This method checks if all choices in the current ChoiceMap are valid for the given</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">        generative function and its arguments.</span>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
</span><span id="__span-0-1369"><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">            gen_fn: The generative function to check against.</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><span class="sd">            args: The arguments to the generative function.</span>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1374"><a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">            A ChoiceMap containing any extra choices not reachable in the course of `gen_fn`&#39;s execution, or None if no extra choices are found.</span>
</span><span id="__span-0-1375"><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>
</span><span id="__span-0-1376"><a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1378"><a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="sd">            @genjax.gen</span>
</span><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><span class="sd">            def model(x):</span>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">                y = bernoulli(0.5) @ &quot;y&quot;</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">                return x + y</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">            chm = ChoiceMap.d({&quot;y&quot;: 1, &quot;z&quot;: 2})</span>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">            extras = chm.invalid_subset(model, (1,))</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">            assert &quot;z&quot; in extras  # &quot;z&quot; is an extra choice not in the model</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">            ```</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>        <span class="n">shape_chm</span> <span class="o">=</span> <span class="n">gen_fn</span><span class="o">.</span><span class="n">get_zero_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span>
</span><span id="__span-0-1390"><a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>        <span class="n">shape_sel</span> <span class="o">=</span> <span class="n">_shape_selection</span><span class="p">(</span><span class="n">shape_chm</span><span class="p">)</span>
</span><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>        <span class="n">extras</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">~</span><span class="n">shape_sel</span><span class="p">)</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">extras</span><span class="o">.</span><span class="n">static_is_empty</span><span class="p">():</span>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>            <span class="k">return</span> <span class="n">extras</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="genjax.core.ChoiceMap.at" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">at</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.at" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">at</span><span class="p">:</span> <span class="n"><span title="genjax._src.core.generative.choice_map._ChoiceMapBuilder">_ChoiceMapBuilder</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a _ChoiceMapBuilder instance for constructing nested ChoiceMaps.</p>
<p>This property allows for a fluent interface to build complex ChoiceMaps
by chaining address components and setting values.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="genjax._src.core.generative.choice_map._ChoiceMapBuilder">_ChoiceMapBuilder</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A builder object for constructing ChoiceMaps.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMap</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">({(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">):</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mf">12.0</span><span class="p">})</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">updated</span> <span class="o">=</span> <span class="n">chm</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">assert</span> <span class="n">updated</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">4.0</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">assert</span> <span class="n">updated</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">chm</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="result">

</div>
</details>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.__call__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__call__</span>


<a href="#genjax.core.ChoiceMap.__call__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__call__</span><span class="p">(</span><span class="o">*</span><span class="n"><span title="genjax.core.ChoiceMap.__call__(*addresses)">addresses</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.generative.choice_map.Address">Address</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Alias for <code>get_submap(*addresses)</code>.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>    <span class="o">*</span><span class="n">addresses</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Alias for `get_submap(*addresses)`.&quot;&quot;&quot;</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_submap</span><span class="p">(</span><span class="o">*</span><span class="n">addresses</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.choice" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">choice</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.choice" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">choice</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;v&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.choice(v)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.choice(v)">v</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a ChoiceMap containing a single value.</p>
<p>This method creates and returns an instance of Choice, which represents
a ChoiceMap with a single value at the root level.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.choice(v)" class="doc doc-heading doc-heading-parameter">                  <code>v</code>
<a href="#genjax.core.ChoiceMap.choice(v)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to be stored in the ChoiceMap.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ChoiceMap containing the single value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMap</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">value_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">assert</span> <span class="n">value_chm</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">42</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span>
<span class="normal"><a href="#__codelineno-0-990">990</a></span>
<span class="normal"><a href="#__codelineno-0-991">991</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="k">def</span><span class="w"> </span><span class="nf">choice</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">    Creates a ChoiceMap containing a single value.</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">    This method creates and returns an instance of Choice, which represents</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">    a ChoiceMap with a single value at the root level.</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    Args:</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        v: The value to be stored in the ChoiceMap.</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">        A ChoiceMap containing the single value.</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a>
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">    Example:</span>
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        from genjax import ChoiceMap</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        value_chm = ChoiceMap.value(42)</span>
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">        assert value_chm.get_value() == 42</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        ```</span>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a>    <span class="k">return</span> <span class="n">Choice</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.d" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">d</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.d" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">d</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;d&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.d(d)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.d(d)">d</a></span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.choice_map.K_addr">K_addr</span></span><span class="p">,</span> <span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a ChoiceMap from a dictionary.</p>
<p>This method creates and returns a ChoiceMap based on the key-value pairs in the provided dictionary. Each key in the dictionary becomes an address in the ChoiceMap, and the corresponding value is stored at that address.</p>
<p>Dict-shaped values are recursively converted to ChoiceMap instances.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.d(d)" class="doc doc-heading doc-heading-parameter">                  <code>d</code>
<a href="#genjax.core.ChoiceMap.d(d)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="genjax._src.core.generative.choice_map.K_addr">K_addr</span>, <span title="genjax._src.core.typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary where keys are addresses and values are the corresponding data to be stored in the ChoiceMap.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ChoiceMap containing the key-value pairs from the input dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChoiceMap</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">dict_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}})</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">assert</span> <span class="n">dict_chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">assert</span> <span class="n">dict_chm</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="k">def</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">K_addr</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">    Creates a ChoiceMap from a dictionary.</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">    This method creates and returns a ChoiceMap based on the key-value pairs in the provided dictionary. Each key in the dictionary becomes an address in the ChoiceMap, and the corresponding value is stored at that address.</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">    Dict-shaped values are recursively converted to ChoiceMap instances.</span>
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">        d: A dictionary where keys are addresses and values are the corresponding data to be stored in the ChoiceMap.</span>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">        A ChoiceMap containing the key-value pairs from the input dictionary.</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">        from genjax import ChoiceMap</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">        dict_chm = ChoiceMap.d({&quot;x&quot;: 42, &quot;y&quot;: {&quot;z&quot;: [1, 2, 3]}})</span>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">        assert dict_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">        assert dict_chm[&quot;y&quot;, &quot;z&quot;] == [1, 2, 3]</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">        ```</span>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>    <span class="k">return</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">from_mapping</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.empty" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">empty</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.empty" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">empty</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a ChoiceMap with no values or submaps.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An empty ChoiceMap.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="k">def</span><span class="w"> </span><span class="nf">empty</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">    Returns a ChoiceMap with no values or submaps.</span>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">        An empty ChoiceMap.</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a>    <span class="k">return</span> <span class="n">_empty</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.entry" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">entry</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.entry" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">entry</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;v&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.entry(v)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.entry(v)">v</a></span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.choice_map.K_addr">K_addr</span></span><span class="p">,</span> <span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">]</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span> <span class="o">|</span> <span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="o">*</span><span class="n"><span title="genjax.core.ChoiceMap.entry(*addrs)">addrs</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.generative.choice_map.AddressComponent">AddressComponent</span></span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a ChoiceMap with a single value at a specified address.</p>
<p>This method creates and returns a ChoiceMap with a new ChoiceMap stored at
the given address.</p>
<ul>
<li>if the provided value is already a ChoiceMap, it will be used directly;</li>
<li><code>dict</code> values will be passed to <code>ChoiceMap.d</code>;</li>
<li>any other value will be passed to <code>ChoiceMap.value</code>.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.entry(v)" class="doc doc-heading doc-heading-parameter">                  <code>v</code>
<a href="#genjax.core.ChoiceMap.entry(v)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="genjax._src.core.generative.choice_map.K_addr">K_addr</span>, <span title="genjax._src.core.typing.Any">Any</span>] | <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a> | <span title="genjax._src.core.typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to be stored in the ChoiceMap. Can be any value, a dict or a ChoiceMap.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.entry(addrs)" class="doc doc-heading doc-heading-parameter">                  <code>addrs</code>
<a href="#genjax.core.ChoiceMap.entry(addrs)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.generative.choice_map.AddressComponent">AddressComponent</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address at which to store the value. Can be a static or dynamic address component.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ChoiceMap with the value stored at the specified address.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Using an existing ChoiceMap</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">nested_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="n">ChoiceMap</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">42</span><span class="p">),</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">assert</span> <span class="n">nested_chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># Using a dict generates a new `ChoiceMap.d` call</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">nested_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">entry</span><span class="p">({</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">},</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="k">assert</span> <span class="n">nested_chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1"># Static address</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">static_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="k">assert</span> <span class="n">static_chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Dynamic address</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">dynamic_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">]),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="p">)</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="k">assert</span> <span class="n">dynamic_chm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">genjax</span><span class="o">.</span><span class="n">Mask</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="k">def</span><span class="w"> </span><span class="nf">entry</span><span class="p">(</span>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>    <span class="n">v</span><span class="p">:</span> <span class="s2">&quot;dict[K_addr, Any] | ChoiceMap | Any&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">addrs</span><span class="p">:</span> <span class="n">AddressComponent</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">    Creates a ChoiceMap with a single value at a specified address.</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">    This method creates and returns a ChoiceMap with a new ChoiceMap stored at</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">    the given address.</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">    - if the provided value is already a ChoiceMap, it will be used directly;</span>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">    - `dict` values will be passed to `ChoiceMap.d`;</span>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">    - any other value will be passed to `ChoiceMap.value`.</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">        v: The value to be stored in the ChoiceMap. Can be any value, a dict or a ChoiceMap.</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">        addrs: The address at which to store the value. Can be a static or dynamic address component.</span>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        A ChoiceMap with the value stored at the specified address.</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">        import jax.numpy as jnp</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">        # Using an existing ChoiceMap</span>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">        nested_chm = ChoiceMap.entry(ChoiceMap.value(42), &quot;x&quot;)</span>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">        assert nested_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        # Using a dict generates a new `ChoiceMap.d` call</span>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        nested_chm = ChoiceMap.entry({&quot;y&quot;: 42}, &quot;x&quot;)</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        assert nested_chm[&quot;x&quot;, &quot;y&quot;] == 42</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">        # Static address</span>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">        static_chm = ChoiceMap.entry(42, &quot;x&quot;)</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        assert static_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">        # Dynamic address</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">        dynamic_chm = ChoiceMap.entry(</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">            jnp.array([1.1, 2.2, 3.3]), jnp.array([1, 2, 3])</span>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">        )</span>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">        assert dynamic_chm[1] == genjax.Mask(1.1, True)</span>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">        ```</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ChoiceMap</span><span class="p">):</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>        <span class="n">chm</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>        <span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>        <span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>    <span class="k">return</span> <span class="n">chm</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="o">*</span><span class="n">addrs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.extend" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">extend</span>


<a href="#genjax.core.ChoiceMap.extend" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">extend</span><span class="p">(</span><span class="o">*</span><span class="n"><span title="genjax.core.ChoiceMap.extend(*addrs)">addrs</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.generative.choice_map.AddressComponent">AddressComponent</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a new ChoiceMap with the given address component as its root.</p>
<p>This method creates a new ChoiceMap where the current ChoiceMap becomes a submap
under the specified address component. It effectively adds a new level of hierarchy
to the ChoiceMap structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.extend(addrs)" class="doc doc-heading doc-heading-parameter">                  <code>addrs</code>
<a href="#genjax.core.ChoiceMap.extend(addrs)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.generative.choice_map.AddressComponent">AddressComponent</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address components to use as the new root.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChoiceMap with the current ChoiceMap nested under the given address.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">original_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">indexed_chm</span> <span class="o">=</span> <span class="n">original_chm</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">assert</span> <span class="n">indexed_chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">addrs</span><span class="p">:</span> <span class="n">AddressComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">    Returns a new ChoiceMap with the given address component as its root.</span>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">    This method creates a new ChoiceMap where the current ChoiceMap becomes a submap</span>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">    under the specified address component. It effectively adds a new level of hierarchy</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="sd">    to the ChoiceMap structure.</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">        addrs: The address components to use as the new root.</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">        A new ChoiceMap with the current ChoiceMap nested under the given address.</span>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">        original_chm = ChoiceMap.value(42)</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">        indexed_chm = original_chm.extend(&quot;x&quot;)</span>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">        assert indexed_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">        ```</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>    <span class="n">acc</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>    <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">addrs</span><span class="p">):</span>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">StaticAddressComponent</span><span class="p">):</span>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>            <span class="n">acc</span> <span class="o">=</span> <span class="n">Static</span><span class="o">.</span><span class="n">build</span><span class="p">({</span><span class="n">addr</span><span class="p">:</span> <span class="n">acc</span><span class="p">})</span>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>            <span class="n">acc</span> <span class="o">=</span> <span class="n">Indexed</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>    <span class="k">return</span> <span class="n">acc</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.filter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">filter</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.filter" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">filter</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;selection&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.filter(selection)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.filter(selection)">selection</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></span> <span class="o">|</span> <span class="n"><span title="genjax._src.core.typing.Flag">Flag</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Filter the choice map on the <code>Selection</code>. The resulting choice map only contains the addresses that return True when presented to the selection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.filter(selection)" class="doc doc-heading doc-heading-parameter">                  <code>selection</code>
<a href="#genjax.core.ChoiceMap.filter(selection)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a> | <span title="genjax._src.core.typing.Flag">Flag</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Selection to filter the choice map with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChoiceMap containing only the addresses selected by the given Selection.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">bernoulli</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">SelectionBuilder</span> <span class="k">as</span> <span class="n">S</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">():</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;x&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;y&quot;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">314159</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">())</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">selection</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">filtered</span> <span class="o">=</span> <span class="n">chm</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="k">assert</span> <span class="s2">&quot;y&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filtered</span>
</span></code></pre></div>
<div class="result">

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="nd">@abstractmethod</span>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection</span><span class="p">:</span> <span class="n">Selection</span> <span class="o">|</span> <span class="n">Flag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">    Filter the choice map on the `Selection`. The resulting choice map only contains the addresses that return True when presented to the selection.</span>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">    Args:</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">        selection: The Selection to filter the choice map with.</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a>
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">        A new ChoiceMap containing only the addresses selected by the given Selection.</span>
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">        import jax</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">        from genjax import bernoulli</span>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">        from genjax import SelectionBuilder as S</span>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        def model():</span>
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">            x = bernoulli(0.3) @ &quot;x&quot;</span>
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">            y = bernoulli(0.3) @ &quot;y&quot;</span>
</span><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">            return x</span>
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        key = jax.random.key(314159)</span>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">        tr = model.simulate(key, ())</span>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        chm = tr.get_choices()</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        selection = S[&quot;x&quot;]</span>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">        filtered = chm.filter(selection)</span>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">        assert &quot;y&quot; not in filtered</span>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">        ```</span>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    &quot;&quot;&quot;</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.from_mapping" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_mapping</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.from_mapping" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_mapping</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;pairs&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.from_mapping(pairs)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.from_mapping(pairs)">pairs</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Iterable">Iterable</span></span><span class="p">[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.choice_map.K_addr">K_addr</span></span><span class="p">,</span> <span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">]]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a ChoiceMap from an iterable of address-value pairs.</p>
<p>This method constructs a ChoiceMap by iterating through the provided pairs,
where each pair consists of an address (or address component) and a corresponding value.
The resulting ChoiceMap will contain all the values at their respective addresses.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.from_mapping(pairs)" class="doc doc-heading doc-heading-parameter">                  <code>pairs</code>
<a href="#genjax.core.ChoiceMap.from_mapping(pairs)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.Iterable">Iterable</span>[<span title="tuple">tuple</span>[<span title="genjax._src.core.generative.choice_map.K_addr">K_addr</span>, <span title="genjax._src.core.typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterable of tuples, where each tuple contains an address (or address component) and its corresponding value. The address can be a single component or a tuple of components.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ChoiceMap containing all the address-value pairs from the input.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span> <span class="p">((</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">),</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])]</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">from_mapping</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">assert</span> <span class="n">chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">assert</span> <span class="n">chm</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">assert</span> <span class="n">chm</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></code></pre></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>If multiple pairs have the same address, later pairs will overwrite earlier ones.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_mapping</span><span class="p">(</span><span class="n">pairs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">K_addr</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">    Creates a ChoiceMap from an iterable of address-value pairs.</span>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">    This method constructs a ChoiceMap by iterating through the provided pairs,</span>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">    where each pair consists of an address (or address component) and a corresponding value.</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">    The resulting ChoiceMap will contain all the values at their respective addresses.</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">        pairs: An iterable of tuples, where each tuple contains an address (or address component) and its corresponding value. The address can be a single component or a tuple of components.</span>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1066"><a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">        A ChoiceMap containing all the address-value pairs from the input.</span>
</span><span id="__span-0-1067"><a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
</span><span id="__span-0-1068"><a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">        ```python</span>
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">        pairs = [(&quot;x&quot;, 42), ((&quot;y&quot;, &quot;z&quot;), 10), (&quot;w&quot;, [1, 2, 3])]</span>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">        chm = ChoiceMap.from_mapping(pairs)</span>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">        assert chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        assert chm[&quot;y&quot;, &quot;z&quot;] == 10</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">        assert chm[&quot;w&quot;] == [1, 2, 3]</span>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">        ```</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">        If multiple pairs have the same address, later pairs will overwrite earlier ones.</span>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>    <span class="n">acc</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>    <span class="k">for</span> <span class="n">addr</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>        <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">addr</span><span class="p">,)</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>        <span class="n">acc</span> <span class="o">|=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">*</span><span class="n">addr</span><span class="p">)</span>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>    <span class="k">return</span> <span class="n">acc</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.get_selection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_selection</span>


<a href="#genjax.core.ChoiceMap.get_selection" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_selection</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a Selection representing the structure of this ChoiceMap.</p>
<p>This method creates a Selection that matches the hierarchical structure
of the current ChoiceMap. The resulting Selection can be used to filter
or query other ChoiceMaps with the same structure.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Selection object representing the structure of this ChoiceMap.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">sel</span> <span class="o">=</span> <span class="n">chm</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">assert</span> <span class="n">sel</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">assert</span> <span class="n">sel</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Selection</span><span class="p">:</span>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">    Returns a Selection representing the structure of this ChoiceMap.</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">    This method creates a Selection that matches the hierarchical structure</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">    of the current ChoiceMap. The resulting Selection can be used to filter</span>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">    or query other ChoiceMaps with the same structure.</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">        A Selection object representing the structure of this ChoiceMap.</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>
</span><span id="__span-0-1264"><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        chm = ChoiceMap.value(5).extend(&quot;x&quot;)</span>
</span><span id="__span-0-1267"><a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">        sel = chm.get_selection()</span>
</span><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">        assert sel[&quot;x&quot;] == True</span>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">        assert sel[&quot;y&quot;] == False</span>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">        ```</span>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>    <span class="k">return</span> <span class="n">ChmSel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.invalid_subset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">invalid_subset</span>


<a href="#genjax.core.ChoiceMap.invalid_subset" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">invalid_subset</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;gen_fn&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.invalid_subset(gen_fn)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.invalid_subset(gen_fn)">gen_fn</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;args&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.invalid_subset(args)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.invalid_subset(args)">args</a></span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span> <span class="o">|</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Identifies the subset of choices that are invalid for a given generative function and its arguments.</p>
<p>This method checks if all choices in the current ChoiceMap are valid for the given
generative function and its arguments.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.invalid_subset(gen_fn)" class="doc doc-heading doc-heading-parameter">                  <code>gen_fn</code>
<a href="#genjax.core.ChoiceMap.invalid_subset(gen_fn)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.GenerativeFunction&lt;/span&gt; (&lt;code&gt;genjax.GenerativeFunction&lt;/code&gt;)" href="#genjax.core.GenerativeFunction">GenerativeFunction</a>[<span title="genjax._src.core.typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The generative function to check against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.invalid_subset(args)" class="doc doc-heading doc-heading-parameter">                  <code>args</code>
<a href="#genjax.core.ChoiceMap.invalid_subset(args)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="genjax._src.core.typing.Any">Any</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The arguments to the generative function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ChoiceMap containing any extra choices not reachable in the course of <code>gen_fn</code>'s execution, or None if no extra choices are found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@genjax</span><span class="o">.</span><span class="n">gen</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">@</span> <span class="s2">&quot;y&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">({</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">extras</span> <span class="o">=</span> <span class="n">chm</span><span class="o">.</span><span class="n">invalid_subset</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">assert</span> <span class="s2">&quot;z&quot;</span> <span class="ow">in</span> <span class="n">extras</span>  <span class="c1"># &quot;z&quot; is an extra choice not in the model</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="k">def</span><span class="w"> </span><span class="nf">invalid_subset</span><span class="p">(</span>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>    <span class="n">gen_fn</span><span class="p">:</span> <span class="s2">&quot;genjax.GenerativeFunction[Any]&quot;</span><span class="p">,</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap | None&quot;</span><span class="p">:</span>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">    Identifies the subset of choices that are invalid for a given generative function and its arguments.</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">    This method checks if all choices in the current ChoiceMap are valid for the given</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">    generative function and its arguments.</span>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
</span><span id="__span-0-1369"><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">        gen_fn: The generative function to check against.</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><span class="sd">        args: The arguments to the generative function.</span>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1374"><a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">        A ChoiceMap containing any extra choices not reachable in the course of `gen_fn`&#39;s execution, or None if no extra choices are found.</span>
</span><span id="__span-0-1375"><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>
</span><span id="__span-0-1376"><a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1378"><a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="sd">        @genjax.gen</span>
</span><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><span class="sd">        def model(x):</span>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">            y = bernoulli(0.5) @ &quot;y&quot;</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">            return x + y</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">        chm = ChoiceMap.d({&quot;y&quot;: 1, &quot;z&quot;: 2})</span>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">        extras = chm.invalid_subset(model, (1,))</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">        assert &quot;z&quot; in extras  # &quot;z&quot; is an extra choice not in the model</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">        ```</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>    <span class="n">shape_chm</span> <span class="o">=</span> <span class="n">gen_fn</span><span class="o">.</span><span class="n">get_zero_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">get_choices</span><span class="p">()</span>
</span><span id="__span-0-1390"><a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>    <span class="n">shape_sel</span> <span class="o">=</span> <span class="n">_shape_selection</span><span class="p">(</span><span class="n">shape_chm</span><span class="p">)</span>
</span><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>    <span class="n">extras</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">~</span><span class="n">shape_sel</span><span class="p">)</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">extras</span><span class="o">.</span><span class="n">static_is_empty</span><span class="p">():</span>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>        <span class="k">return</span> <span class="n">extras</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.kw" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">kw</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.kw" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">kw</span><span class="p">(</span><span class="o">**</span><span class="n"><span title="genjax.core.ChoiceMap.kw(**kwargs)">kwargs</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a ChoiceMap from keyword arguments.</p>
<p>This method creates and returns a ChoiceMap based on the provided keyword arguments.
Each keyword argument becomes an address in the ChoiceMap, and its value is stored at that address.</p>
<p>Dict-shaped values are recursively converted to ChoiceMap instances with calls to <code>ChoiceMap.d</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ChoiceMap containing the key-value pairs from the input keyword arguments.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">kw_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">kw</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">z</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">})</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">assert</span> <span class="n">kw_chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">assert</span> <span class="n">kw_chm</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">assert</span> <span class="n">kw_chm</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">10.0</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="k">def</span><span class="w"> </span><span class="nf">kw</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">    Creates a ChoiceMap from keyword arguments.</span>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">    This method creates and returns a ChoiceMap based on the provided keyword arguments.</span>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">    Each keyword argument becomes an address in the ChoiceMap, and its value is stored at that address.</span>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">    Dict-shaped values are recursively converted to ChoiceMap instances with calls to `ChoiceMap.d`.</span>
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">        A ChoiceMap containing the key-value pairs from the input keyword arguments.</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">        kw_chm = ChoiceMap.kw(x=42, y=[1, 2, 3], z={&quot;w&quot;: 10.0})</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">        assert kw_chm[&quot;x&quot;] == 42</span>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">        assert kw_chm[&quot;y&quot;] == [1, 2, 3]</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        assert kw_chm[&quot;z&quot;, &quot;w&quot;] == 10.0</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">        ```</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>    <span class="k">return</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">mask</span>


<a href="#genjax.core.ChoiceMap.mask" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">mask</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;flag&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.mask(flag)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.mask(flag)">flag</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Flag">Flag</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a new ChoiceMap with values masked by a boolean flag.</p>
<p>This method creates a new ChoiceMap where the values are conditionally
included based on the provided flag. If the flag is True, the original
values are retained; if False, the ChoiceMap behaves as if it's empty.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.mask(flag)" class="doc doc-heading doc-heading-parameter">                  <code>flag</code>
<a href="#genjax.core.ChoiceMap.mask(flag)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.Flag">Flag</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A boolean flag determining whether to include the values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChoiceMap with values conditionally masked.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">original_chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">masked_chm</span> <span class="o">=</span> <span class="n">original_chm</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">assert</span> <span class="n">masked_chm</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">42</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">masked_chm</span> <span class="o">=</span> <span class="n">original_chm</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">assert</span> <span class="n">masked_chm</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">Flag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">    Returns a new ChoiceMap with values masked by a boolean flag.</span>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">    This method creates a new ChoiceMap where the values are conditionally</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">    included based on the provided flag. If the flag is True, the original</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">    values are retained; if False, the ChoiceMap behaves as if it&#39;s empty.</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">        flag: A boolean flag determining whether to include the values.</span>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><span class="sd">        A new ChoiceMap with values conditionally masked.</span>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">        original_chm = ChoiceMap.value(42)</span>
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">        masked_chm = original_chm.mask(True)</span>
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">        assert masked_chm.get_value() == 42</span>
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">        masked_chm = original_chm.mask(False)</span>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">        assert masked_chm.get_value() is None</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">        ```</span>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.merge" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">merge</span>


<a href="#genjax.core.ChoiceMap.merge" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">merge</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;other&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.merge(other)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.merge(other)">other</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Merges this ChoiceMap with another ChoiceMap.</p>
<p>This method combines the current ChoiceMap with another ChoiceMap using the XOR operation (^). It creates a new ChoiceMap that contains all addresses from both input ChoiceMaps; any overlapping addresses will trigger an error on access at the address via <code>[&lt;addr&gt;]</code> or <code>get_value()</code>. Use <code>|</code> if you don't want this behavior.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.merge(other)" class="doc doc-heading doc-heading-parameter">                  <code>other</code>
<a href="#genjax.core.ChoiceMap.merge(other)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceMap to merge with the current one.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChoiceMap resulting from the merge operation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">chm1</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">chm2</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">merged_chm</span> <span class="o">=</span> <span class="n">chm1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">chm2</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">assert</span> <span class="n">merged_chm</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">assert</span> <span class="n">merged_chm</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>This method is equivalent to using the | operator between two ChoiceMaps.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">    Merges this ChoiceMap with another ChoiceMap.</span>
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">    This method combines the current ChoiceMap with another ChoiceMap using the XOR operation (^). It creates a new ChoiceMap that contains all addresses from both input ChoiceMaps; any overlapping addresses will trigger an error on access at the address via `[&lt;addr&gt;]` or `get_value()`. Use `|` if you don&#39;t want this behavior.</span>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">        other: The ChoiceMap to merge with the current one.</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">        A new ChoiceMap resulting from the merge operation.</span>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">        chm1 = ChoiceMap.value(5).extend(&quot;x&quot;)</span>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">        chm2 = ChoiceMap.value(10).extend(&quot;y&quot;)</span>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">        merged_chm = chm1.merge(chm2)</span>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">        assert merged_chm[&quot;x&quot;] == 5</span>
</span><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">        assert merged_chm[&quot;y&quot;] == 10</span>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">        ```</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">        This method is equivalent to using the | operator between two ChoiceMaps.</span>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>    <span class="k">return</span> <span class="bp">self</span> <span class="o">|</span> <span class="n">other</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.simplify" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">simplify</span>


<a href="#genjax.core.ChoiceMap.simplify" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">simplify</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Previously pushed down filters, now acts as identity.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="nd">@nobeartype</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="nd">@deprecated</span><span class="p">(</span>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>    <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Acts as identity; filters are now automatically pushed down.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>    <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.8.0&quot;</span><span class="p">,</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="p">)</span>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="k">def</span><span class="w"> </span><span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Previously pushed down filters, now acts as identity.&quot;&quot;&quot;</span>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>    <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.static_is_empty" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">static_is_empty</span>


<a href="#genjax.core.ChoiceMap.static_is_empty" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">static_is_empty</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns True if this ChoiceMap is equal to <code>ChoiceMap.empty()</code>, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="k">def</span><span class="w"> </span><span class="nf">static_is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">    Returns True if this ChoiceMap is equal to `ChoiceMap.empty()`, False otherwise.</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>    <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.ChoiceMap.switch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">switch</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.ChoiceMap.switch" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">switch</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;idx&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.switch(idx)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.switch(idx)">idx</a></span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="genjax._src.core.typing.IntArray">IntArray</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;chms&lt;/code&gt; (&lt;code&gt;genjax.core.ChoiceMap.switch(chms)&lt;/code&gt;)" href="#genjax.core.ChoiceMap.switch(chms)">chms</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Iterable">Iterable</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span><span class="p">]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a ChoiceMap that switches between multiple ChoiceMaps based on an index.</p>
<p>This method creates a new ChoiceMap that selectively includes values from a sequence of
input ChoiceMaps based on the provided index. The resulting ChoiceMap will contain
values from the ChoiceMap at the position specified by the index, while masking out
values from all other ChoiceMaps.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.switch(idx)" class="doc doc-heading doc-heading-parameter">                  <code>idx</code>
<a href="#genjax.core.ChoiceMap.switch(idx)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="int">int</span> | <span title="genjax._src.core.typing.IntArray">IntArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An index or array of indices specifying which ChoiceMap(s) to select from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.ChoiceMap.switch(chms)" class="doc doc-heading doc-heading-parameter">                  <code>chms</code>
<a href="#genjax.core.ChoiceMap.switch(chms)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterable of ChoiceMaps to switch between.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChoiceMap containing values from the selected ChoiceMap(s).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">chm1</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">chm2</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">chm3</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">d</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">switched</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="n">chm1</span><span class="p">,</span> <span class="n">chm2</span><span class="p">,</span> <span class="n">chm3</span><span class="p">])</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">assert</span> <span class="n">switched</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unmask</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">assert</span> <span class="n">switched</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unmask</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="k">def</span><span class="w"> </span><span class="nf">switch</span><span class="p">(</span><span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">IntArray</span><span class="p">,</span> <span class="n">chms</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ChoiceMap&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">    Creates a ChoiceMap that switches between multiple ChoiceMaps based on an index.</span>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">    This method creates a new ChoiceMap that selectively includes values from a sequence of</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">    input ChoiceMaps based on the provided index. The resulting ChoiceMap will contain</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">    values from the ChoiceMap at the position specified by the index, while masking out</span>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">    values from all other ChoiceMaps.</span>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">        idx: An index or array of indices specifying which ChoiceMap(s) to select from.</span>
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">        chms: An iterable of ChoiceMaps to switch between.</span>
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">        A new ChoiceMap containing values from the selected ChoiceMap(s).</span>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">        chm1 = ChoiceMap.d({&quot;x&quot;: 1, &quot;y&quot;: 2})</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">        chm2 = ChoiceMap.d({&quot;x&quot;: 3, &quot;y&quot;: 4})</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">        chm3 = ChoiceMap.d({&quot;x&quot;: 5, &quot;y&quot;: 6})</span>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">        switched = ChoiceMap.switch(jnp.array(1), [chm1, chm2, chm3])</span>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">        assert switched[&quot;x&quot;].unmask() == 3</span>
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">        assert switched[&quot;y&quot;].unmask() == 4</span>
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">        ```</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>    <span class="k">return</span> <span class="n">Switch</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">chms</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="genjax.core.Selection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.Selection</span>


<a href="#genjax.core.Selection" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt; (&lt;code&gt;genjax._src.core.pytree.Pytree&lt;/code&gt;)" href="#genjax.core.Pytree">Pytree</a></code></p>


        <p>A class representing a selection of addresses in a ChoiceMap.</p>
<p>Selection objects are used to filter and manipulate ChoiceMaps by specifying which addresses should be included or excluded.</p>
<p>Selection instances support various operations such as union (via <code>&amp;</code>), intersection (via <code>|</code>), and complement (via <code>~</code>), allowing for complex selection criteria to be constructed.</p>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;all&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Selection.all&lt;/code&gt;)" href="#genjax.core.Selection.all">all</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a Selection that includes all addresses.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;none&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Selection.none&lt;/code&gt;)" href="#genjax.core.Selection.none">none</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a Selection that includes no addresses.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;at&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Selection.at&lt;/code&gt;)" href="#genjax.core.Selection.at">at</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>A builder instance for creating Selection objects using indexing syntax.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Creating selections:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">genjax</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Selection</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Select all addresses</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">all_sel</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Select no addresses</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">none_sel</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">none</span><span class="p">()</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># Select specific addresses</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">specific_sel</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c1"># Match (&lt;wildcard&gt;, &quot;y&quot;)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">wildcard_sel</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Combine selections</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">combined_sel</span> <span class="o">=</span> <span class="n">specific_sel</span> <span class="o">|</span> <span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="result">

</div></p>
<p>Querying selections:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Create a selection</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">sel</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Querying the selection using () returns a sub-selection</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">assert</span> <span class="n">sel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">assert</span> <span class="n">sel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">Selection</span><span class="o">.</span><span class="n">none</span><span class="p">()</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># Querying the selection using [] returns a `bool` representing whether or not the input matches:</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">assert</span> <span class="n">sel</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="k">assert</span> <span class="n">sel</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1"># Querying the selection using &quot;in&quot; acts the same:</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="k">assert</span> <span class="ow">not</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">sel</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="k">assert</span> <span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sel</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Nested querying</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">nested_sel</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="k">assert</span> <span class="n">nested_sel</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="result">

</div></p>
        <p>Selection objects can passed to a <code>ChoiceMap</code> via the <code>filter</code> method to filter and manipulate data based on address patterns.</p>












<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;at&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Selection.at&lt;/code&gt;)" href="#genjax.core.Selection.at">at</a></code></td>
            <td>
                  <code><span title="genjax._src.core.typing.Final">Final</span>[<span title="genjax._src.core.generative.choice_map._SelectionBuilder">_SelectionBuilder</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A builder instance for creating Selection objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="k">class</span><span class="w"> </span><span class="nc">Selection</span><span class="p">(</span><span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    A class representing a selection of addresses in a ChoiceMap.</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    Selection objects are used to filter and manipulate ChoiceMaps by specifying which addresses should be included or excluded.</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    Selection instances support various operations such as union (via `&amp;`), intersection (via `|`), and complement (via `~`), allowing for complex selection criteria to be constructed.</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Methods:</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        all(): Creates a Selection that includes all addresses.</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        none(): Creates a Selection that includes no addresses.</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        at: A builder instance for creating Selection objects using indexing syntax.</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Creating selections:</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        import genjax</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        from genjax import Selection</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        # Select all addresses</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        all_sel = Selection.all()</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        # Select no addresses</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        none_sel = Selection.none()</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        # Select specific addresses</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        specific_sel = Selection.at[&quot;x&quot;, &quot;y&quot;]</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        # Match (&lt;wildcard&gt;, &quot;y&quot;)</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        wildcard_sel = Selection.at[..., &quot;y&quot;]</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        # Combine selections</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        combined_sel = specific_sel | Selection.at[&quot;z&quot;]</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        ```</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        Querying selections:</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        # Create a selection</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        sel = Selection.at[&quot;x&quot;, &quot;y&quot;]</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        # Querying the selection using () returns a sub-selection</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        assert sel(&quot;x&quot;) == Selection.at[&quot;y&quot;]</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        assert sel(&quot;z&quot;) == Selection.none()</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        # Querying the selection using [] returns a `bool` representing whether or not the input matches:</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        assert sel[&quot;x&quot;] == False</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        assert sel[&quot;x&quot;, &quot;y&quot;] == True</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        # Querying the selection using &quot;in&quot; acts the same:</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        assert not &quot;x&quot; in sel</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        assert (&quot;x&quot;, &quot;y&quot;) in sel</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        # Nested querying</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        nested_sel = Selection.at[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        assert nested_sel(&quot;a&quot;)(&quot;b&quot;) == Selection.at[&quot;c&quot;]</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        ```</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Selection objects can passed to a `ChoiceMap` via the `filter` method to filter and manipulate data based on address patterns.</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="c1">#################################################</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="c1"># Convenient syntax for constructing selections #</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="c1">#################################################</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">at</span><span class="p">:</span> <span class="n">Final</span><span class="p">[</span><span class="n">_SelectionBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">_SelectionBuilder</span><span class="p">()</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A builder instance for creating Selection objects.</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    `at` provides a convenient interface for constructing Selection objects</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    using a familiar indexing syntax. It allows for the creation of complex</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    selections by chaining multiple address components.</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        Creating a selection:</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        from genjax import Selection</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        Selection.at[&quot;x&quot;, &quot;y&quot;]</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        ```</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">all</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        Returns a Selection that selects all addresses.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            A Selection that selects everything.</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        Example:</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            from genjax import Selection</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">            all_selection = Selection.all()</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">            assert all_selection[&quot;any_address&quot;] == True</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            ```</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">return</span> <span class="n">AllSel</span><span class="p">()</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">none</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        Returns a Selection that selects no addresses.</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            A Selection that selects nothing.</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        Example:</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            none_selection = Selection.none()</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            assert none_selection[&quot;any_address&quot;] == False</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            ```</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="k">return</span> <span class="n">NoneSel</span><span class="p">()</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">leaf</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        Returns a Selection that selects only leaf addresses.</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        A leaf address is an address that doesn&#39;t have any sub-addresses.</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        This selection is useful when you want to target only the final elements in a nested structure.</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            A Selection that selects only leaf addresses.</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        Example:</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            leaf_selection = Selection.leaf().extend(&quot;a&quot;, &quot;b&quot;)</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            assert leaf_selection[&quot;a&quot;, &quot;b&quot;]</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            assert not leaf_selection[&quot;a&quot;, &quot;b&quot;, &quot;anything&quot;]</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            ```</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">return</span> <span class="n">LeafSel</span><span class="p">()</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="c1">######################</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="c1"># Combinator methods #</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="c1">######################</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Selection&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="k">return</span> <span class="n">OrSel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Selection&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="k">return</span> <span class="n">AndSel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="k">return</span> <span class="n">ComplementSel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">complement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="k">return</span> <span class="o">~</span><span class="bp">self</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        Returns a new ChoiceMap filtered with this Selection.</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        This method applies the current Selection to the given ChoiceMap, effectively filtering out addresses that are not matched.</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        Args:</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            sample: The ChoiceMap to be filtered.</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            A new ChoiceMap containing only the addresses selected by this Selection.</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        Example:</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            selection = Selection.at[&quot;x&quot;]</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            chm = ChoiceMap.kw(x=1, y=2)</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            filtered_chm = selection.filter(chm)</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            assert &quot;x&quot; in filtered_chm</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            assert &quot;y&quot; not in filtered_chm</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">            ```</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">return</span> <span class="n">sample</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">addrs</span><span class="p">:</span> <span class="n">ExtendedStaticAddressComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        Returns a new Selection that is prefixed by the given address components.</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        This method creates a new Selection that applies the current selection</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        to the specified address components. It handles both static and dynamic</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        address components.</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        Note that `...` as an address component will match any supplied address.</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        Args:</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            addrs: The address components under which to nest the selection.</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            A new Selection extended by the given address component.</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        Example:</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            base_selection = Selection.all()</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            indexed_selection = base_selection.extend(&quot;x&quot;)</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            assert indexed_selection[&quot;x&quot;, &quot;any_subaddress&quot;] == True</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            assert indexed_selection[&quot;y&quot;] == False</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            ```</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="n">acc</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">addrs</span><span class="p">):</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="n">acc</span> <span class="o">=</span> <span class="n">StaticSel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="k">return</span> <span class="n">acc</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">addr</span><span class="p">:</span> <span class="n">StaticAddress</span><span class="p">,</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">addr</span><span class="p">,)</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="n">subselection</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">addr</span><span class="p">:</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="n">subselection</span> <span class="o">=</span> <span class="n">subselection</span><span class="o">.</span><span class="n">get_subselection</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="k">return</span> <span class="n">subselection</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">addr</span><span class="p">:</span> <span class="n">StaticAddress</span><span class="p">,</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="n">addr</span><span class="p">:</span> <span class="n">StaticAddress</span><span class="p">,</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="k">pass</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="nd">@abstractmethod</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_subselection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">:</span> <span class="n">StaticAddressComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="k">pass</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="genjax.core.Selection.at" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">at</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#genjax.core.Selection.at" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">at</span><span class="p">:</span> <span class="n"><span title="genjax._src.core.typing.Final">Final</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.generative.choice_map._SelectionBuilder">_SelectionBuilder</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="genjax._src.core.generative.choice_map._SelectionBuilder">_SelectionBuilder</span></span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>A builder instance for creating Selection objects.</p>
<p><code>at</code> provides a convenient interface for constructing Selection objects
using a familiar indexing syntax. It allows for the creation of complex
selections by chaining multiple address components.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Creating a selection:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Selection</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="result">

</div></p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="genjax.core.Selection.all" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">all</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.Selection.all" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">all</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a Selection that selects all addresses.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Selection that selects everything.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Selection</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">all_selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">assert</span> <span class="n">all_selection</span><span class="p">[</span><span class="s2">&quot;any_address&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="k">def</span><span class="w"> </span><span class="nf">all</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Returns a Selection that selects all addresses.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        A Selection that selects everything.</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    Example:</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        from genjax import Selection</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        all_selection = Selection.all()</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        assert all_selection[&quot;any_address&quot;] == True</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        ```</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">return</span> <span class="n">AllSel</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Selection.extend" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">extend</span>


<a href="#genjax.core.Selection.extend" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">extend</span><span class="p">(</span><span class="o">*</span><span class="n"><span title="genjax.core.Selection.extend(*addrs)">addrs</span></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.generative.choice_map.ExtendedStaticAddressComponent">ExtendedStaticAddressComponent</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a new Selection that is prefixed by the given address components.</p>
<p>This method creates a new Selection that applies the current selection
to the specified address components. It handles both static and dynamic
address components.</p>
<p>Note that <code>...</code> as an address component will match any supplied address.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.Selection.extend(addrs)" class="doc doc-heading doc-heading-parameter">                  <code>addrs</code>
<a href="#genjax.core.Selection.extend(addrs)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.generative.choice_map.ExtendedStaticAddressComponent">ExtendedStaticAddressComponent</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address components under which to nest the selection.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new Selection extended by the given address component.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">base_selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">indexed_selection</span> <span class="o">=</span> <span class="n">base_selection</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">assert</span> <span class="n">indexed_selection</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;any_subaddress&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">assert</span> <span class="n">indexed_selection</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">addrs</span><span class="p">:</span> <span class="n">ExtendedStaticAddressComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Returns a new Selection that is prefixed by the given address components.</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    This method creates a new Selection that applies the current selection</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    to the specified address components. It handles both static and dynamic</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    address components.</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    Note that `...` as an address component will match any supplied address.</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    Args:</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        addrs: The address components under which to nest the selection.</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        A new Selection extended by the given address component.</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Example:</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        base_selection = Selection.all()</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        indexed_selection = base_selection.extend(&quot;x&quot;)</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        assert indexed_selection[&quot;x&quot;, &quot;any_subaddress&quot;] == True</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        assert indexed_selection[&quot;y&quot;] == False</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        ```</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="n">acc</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">addrs</span><span class="p">):</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="n">acc</span> <span class="o">=</span> <span class="n">StaticSel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="k">return</span> <span class="n">acc</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Selection.filter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">filter</span>


<a href="#genjax.core.Selection.filter" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">filter</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;sample&lt;/code&gt; (&lt;code&gt;genjax.core.Selection.filter(sample)&lt;/code&gt;)" href="#genjax.core.Selection.filter(sample)">sample</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a new ChoiceMap filtered with this Selection.</p>
<p>This method applies the current Selection to the given ChoiceMap, effectively filtering out addresses that are not matched.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.Selection.filter(sample)" class="doc doc-heading doc-heading-parameter">                  <code>sample</code>
<a href="#genjax.core.Selection.filter(sample)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceMap to be filtered.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.ChoiceMap&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.ChoiceMap&lt;/code&gt;)" href="#genjax.core.ChoiceMap">ChoiceMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChoiceMap containing only the addresses selected by this Selection.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">chm</span> <span class="o">=</span> <span class="n">ChoiceMap</span><span class="o">.</span><span class="n">kw</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">filtered_chm</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">chm</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">assert</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">filtered_chm</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">assert</span> <span class="s2">&quot;y&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filtered_chm</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChoiceMap&quot;</span><span class="p">:</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    Returns a new ChoiceMap filtered with this Selection.</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    This method applies the current Selection to the given ChoiceMap, effectively filtering out addresses that are not matched.</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    Args:</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        sample: The ChoiceMap to be filtered.</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        A new ChoiceMap containing only the addresses selected by this Selection.</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    Example:</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        selection = Selection.at[&quot;x&quot;]</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        chm = ChoiceMap.kw(x=1, y=2)</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        filtered_chm = selection.filter(chm)</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        assert &quot;x&quot; in filtered_chm</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        assert &quot;y&quot; not in filtered_chm</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        ```</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">return</span> <span class="n">sample</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Selection.leaf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">leaf</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.Selection.leaf" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">leaf</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a Selection that selects only leaf addresses.</p>
<p>A leaf address is an address that doesn't have any sub-addresses.
This selection is useful when you want to target only the final elements in a nested structure.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Selection that selects only leaf addresses.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">leaf_selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">leaf</span><span class="p">()</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">assert</span> <span class="n">leaf_selection</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">assert</span> <span class="ow">not</span> <span class="n">leaf_selection</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;anything&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="k">def</span><span class="w"> </span><span class="nf">leaf</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Returns a Selection that selects only leaf addresses.</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    A leaf address is an address that doesn&#39;t have any sub-addresses.</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    This selection is useful when you want to target only the final elements in a nested structure.</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        A Selection that selects only leaf addresses.</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Example:</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        leaf_selection = Selection.leaf().extend(&quot;a&quot;, &quot;b&quot;)</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        assert leaf_selection[&quot;a&quot;, &quot;b&quot;]</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        assert not leaf_selection[&quot;a&quot;, &quot;b&quot;, &quot;anything&quot;]</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        ```</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">return</span> <span class="n">LeafSel</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Selection.none" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">none</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.Selection.none" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">none</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a Selection that selects no addresses.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Selection&lt;/span&gt; (&lt;code&gt;genjax._src.core.generative.choice_map.Selection&lt;/code&gt;)" href="#genjax.core.Selection">Selection</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Selection that selects nothing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">none_selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">none</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">assert</span> <span class="n">none_selection</span><span class="p">[</span><span class="s2">&quot;any_address&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span>
</span></code></pre></div>
<div class="result">

</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/choice_map.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="k">def</span><span class="w"> </span><span class="nf">none</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;Selection&quot;</span><span class="p">:</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    Returns a Selection that selects no addresses.</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        A Selection that selects nothing.</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    Example:</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;choicemap&quot;</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        none_selection = Selection.none()</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        assert none_selection[&quot;any_address&quot;] == False</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        ```</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">return</span> <span class="n">NoneSel</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="jax-compatible-data-via-pytree">JAX compatible data via <code>Pytree</code><a class="headerlink" href="#jax-compatible-data-via-pytree" title="Permanent link">&para;</a></h2>
<p>JAX natively works with arrays, and with instances of Python classes which can be broken down into lists of arrays. JAX's <a href="https://jax.readthedocs.io/en/latest/pytrees.html"><code>Pytree</code></a> system provides a way to register a class with methods that can break instances of the class down into a list of arrays (canonically referred to as <em>flattening</em>), and build an instance back up given a list of arrays (canonically referred to as <em>unflattening</em>).</p>
<p>GenJAX provides an abstract class called <code>Pytree</code> which automates the implementation of the <code>flatten</code> / <code>unflatten</code> methods for a class. GenJAX's <code>Pytree</code> inherits from <a href="https://penzai.readthedocs.io/en/stable/_autosummary/leaf/penzai.core.struct.Struct.html"><code>penzai.Struct</code></a>, to support pretty printing, and some convenient methods to annotate what data should be part of the <code>Pytree</code> <em>type</em> (static fields, won't be broken down into a JAX array) and what data should be considered dynamic.</p>


<div class="doc doc-object doc-class">



<h2 id="genjax.core.Pytree" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.Pytree</span>


<a href="#genjax.core.Pytree" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="penzai.pz.Struct">Struct</span></code></p>


        <p><code>Pytree</code> is an abstract base class which registers a class with JAX's <code>Pytree</code>
system. JAX's <code>Pytree</code> system tracks how data classes should behave across JAX-transformed function boundaries, like <code>jax.jit</code> or <code>jax.vmap</code>.</p>
<p>Inheriting this class provides the implementor with the freedom to declare how the subfields of a class should behave:</p>
<ul>
<li><code>Pytree.static(...)</code>: the value of the field cannot be a JAX traced value, it must be a Python literal, or a constant). The values of static fields are embedded in the <code>PyTreeDef</code> of any instance of the class.</li>
<li><code>Pytree.field(...)</code> or no annotation: the value may be a JAX traced value, and JAX will attempt to convert it to tracer values inside of its transformations.</li>
</ul>
<p>If a field <em>points to another <code>Pytree</code></em>, it should not be declared as <code>Pytree.static()</code>, as the <code>Pytree</code> interface will automatically handle the <code>Pytree</code> fields as dynamic fields.</p>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;dataclass&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Pytree.dataclass&lt;/code&gt;)" href="#genjax.core.Pytree.dataclass">dataclass</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Denote that a class (which is inheriting <code>Pytree</code>) should be treated as a dataclass, meaning it can hold data in fields which are declared as part of the class.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;static&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Pytree.static&lt;/code&gt;)" href="#genjax.core.Pytree.static">static</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Declare a field of a <code>Pytree</code> dataclass to be static. Users can provide additional keyword argument options,</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;field&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-staticmethod&quot;&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;genjax.core.Pytree.field&lt;/code&gt;)" href="#genjax.core.Pytree.field">field</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Declare a field of a <code>Pytree</code> dataclass to be dynamic. Alternatively, one can leave the annotation off in the declaration.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/pytree.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="k">class</span><span class="w"> </span><span class="nc">Pytree</span><span class="p">(</span><span class="n">pz</span><span class="o">.</span><span class="n">Struct</span><span class="p">):</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;`Pytree` is an abstract base class which registers a class with JAX&#39;s `Pytree`</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    system. JAX&#39;s `Pytree` system tracks how data classes should behave across JAX-transformed function boundaries, like `jax.jit` or `jax.vmap`.</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Inheriting this class provides the implementor with the freedom to declare how the subfields of a class should behave:</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    * `Pytree.static(...)`: the value of the field cannot be a JAX traced value, it must be a Python literal, or a constant). The values of static fields are embedded in the `PyTreeDef` of any instance of the class.</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    * `Pytree.field(...)` or no annotation: the value may be a JAX traced value, and JAX will attempt to convert it to tracer values inside of its transformations.</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    If a field _points to another `Pytree`_, it should not be declared as `Pytree.static()`, as the `Pytree` interface will automatically handle the `Pytree` fields as dynamic fields.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="nd">@overload</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dataclass</span><span class="p">(</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">incoming</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]],</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]]:</span> <span class="o">...</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="nd">@overload</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dataclass</span><span class="p">(</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">incoming</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">],</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]:</span> <span class="o">...</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="nd">@dataclass_transform</span><span class="p">(</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">frozen_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="p">)</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dataclass</span><span class="p">(</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">incoming</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]],</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]]:</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        Denote that a class (which is inheriting `Pytree`) should be treated as a dataclass, meaning it can hold data in fields which are declared as part of the class.</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        A dataclass is to be distinguished from a &quot;methods only&quot; `Pytree` class, which does not have fields, but may define methods.</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        The latter cannot be instantiated, but can be inherited from, while the former can be instantiated:</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        the `Pytree.dataclass` declaration informs the system _how to instantiate_ the class as a dataclass,</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        and how to automatically define JAX&#39;s `Pytree` interfaces (`tree_flatten`, `tree_unflatten`, etc.) for the dataclass, based on the fields declared in the class, and possibly `Pytree.static(...)` or `Pytree.field(...)` annotations (or lack thereof, the default is that all fields are `Pytree.field(...)`).</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        All `Pytree` dataclasses support pretty printing, as well as rendering to HTML.</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            from genjax import Pytree</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            from genjax.typing import FloatArray</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            import jax.numpy as jnp</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            @Pytree.dataclass</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            # Enforces type annotations on instantiation.</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            class MyClass(Pytree):</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">                my_static_field: int = Pytree.static()</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">                my_dynamic_field: FloatArray</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            print(MyClass(10, jnp.array(5.0)).render_html())</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            ```</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">return</span> <span class="n">pz</span><span class="o">.</span><span class="n">pytree_dataclass</span><span class="p">(</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="n">incoming</span><span class="p">,</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">overwrite_parent_init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="p">)</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">static</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Declare a field of a `Pytree` dataclass to be static. Users can provide additional keyword argument options,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        like `default` or `default_factory`, to customize how the field is instantiated when an instance of</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        the dataclass is instantiated.` Fields which are provided with default values must come after required fields in the dataclass declaration.</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            @Pytree.dataclass</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            # Enforces type annotations on instantiation.</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            class MyClass(Pytree):</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">                my_dynamic_field: FloatArray</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">                my_static_field: int = Pytree.static(default=0)</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            print(MyClass(jnp.array(5.0)).render_html())</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            ```</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">return</span> <span class="n">field</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pytree_node&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">field</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="s2">&quot;Declare a field of a `Pytree` dataclass to be dynamic. Alternatively, one can leave the annotation off in the declaration.&quot;</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">return</span> <span class="n">field</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="c1">##############################</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="c1"># Utility class constructors #</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="c1">##############################</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">const</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="c1"># The value must be concrete!</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="c1"># It cannot be a JAX traced value.</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="k">assert</span> <span class="n">static_check_is_concrete</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Const</span><span class="p">):</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">return</span> <span class="n">v</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="k">return</span> <span class="n">Const</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="c1"># Safe: will not wrap a Const in another Const, and will not</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="c1"># wrap dynamic values.</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">tree_const</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_inner</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Const</span><span class="p">):</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>                <span class="k">return</span> <span class="n">v</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="k">elif</span> <span class="n">static_check_is_concrete</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="k">return</span> <span class="n">Const</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>                <span class="k">return</span> <span class="n">v</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="k">return</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="n">_inner</span><span class="p">,</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="n">v</span><span class="p">,</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="n">is_leaf</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Const</span><span class="p">),</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="p">)</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">tree_const_unwrap</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_inner</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Const</span><span class="p">):</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">val</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="k">return</span> <span class="n">v</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">return</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="n">_inner</span><span class="p">,</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="n">v</span><span class="p">,</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="n">is_leaf</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Const</span><span class="p">),</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="p">)</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">partial</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">R</span><span class="p">]],</span> <span class="s2">&quot;Closure[R]&quot;</span><span class="p">]:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Closure</span><span class="p">[</span><span class="n">R</span><span class="p">](</span><span class="n">args</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">treedef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="k">return</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="c1">#################</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="c1"># Static checks #</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="c1">#################</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">static_check_tree_structure_equivalence</span><span class="p">(</span><span class="n">trees</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]):</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">trees</span><span class="p">:</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">fst</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="o">=</span> <span class="n">trees</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="n">treedef</span> <span class="o">=</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_structure</span><span class="p">(</span><span class="n">fst</span><span class="p">)</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="n">check</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">treedef</span> <span class="o">==</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_structure</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">rest</span><span class="p">))</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="k">return</span> <span class="n">check</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">treescope_color</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes a CSS color to display for this object in treescope.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        This function can be overridden to change the color for a particular object</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        in treescope, without having to register a new handler.</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        (note that we are overriding the Penzai base class&#39;s implementation so that ALL structs receive colors, not just classes with `__call__` implemented.)</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">          A CSS color string to use as a background/highlight color for this object.</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">          Alternatively, a tuple of (border, fill) CSS colors.</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">type_string</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__qualname__</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="k">return</span> <span class="n">formatting_util</span><span class="o">.</span><span class="n">color_from_string</span><span class="p">(</span><span class="n">type_string</span><span class="p">)</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">render_html</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">return</span> <span class="n">treescope</span><span class="o">.</span><span class="n">render_to_html</span><span class="p">(</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">roundtrip_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="genjax.core.Pytree.dataclass" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">dataclass</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.Pytree.dataclass" class="headerlink" title="Permanent link">&para;</a></h3>
          <div class="doc-overloads">
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">dataclass</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax._src.core.pytree.Pytree.dataclass(incoming)">incoming</span></span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">**</span><span class="n"><span title="genjax._src.core.pytree.Pytree.dataclass(**kwargs)">kwargs</span></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="genjax._src.core.typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.pytree.R">R</span></span><span class="p">]],</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.pytree.R">R</span></span><span class="p">]]</span>
</span></code></pre></div><div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">dataclass</span><span class="p">(</span><span class="n"><span title="genjax._src.core.pytree.Pytree.dataclass(incoming)">incoming</span></span><span class="p">:</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.pytree.R">R</span></span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">**</span><span class="n"><span title="genjax._src.core.pytree.Pytree.dataclass(**kwargs)">kwargs</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.pytree.R">R</span></span><span class="p">]</span>
</span></code></pre></div>          </div>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">dataclass</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax.core.Pytree.dataclass(incoming)">incoming</span></span><span class="p">:</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.pytree.R">R</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">**</span><span class="n"><span title="genjax.core.Pytree.dataclass(**kwargs)">kwargs</span></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.pytree.R">R</span></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="genjax._src.core.typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.pytree.R">R</span></span><span class="p">]],</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.pytree.R">R</span></span><span class="p">]]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Denote that a class (which is inheriting <code>Pytree</code>) should be treated as a dataclass, meaning it can hold data in fields which are declared as part of the class.</p>
<p>A dataclass is to be distinguished from a "methods only" <code>Pytree</code> class, which does not have fields, but may define methods.
The latter cannot be instantiated, but can be inherited from, while the former can be instantiated:
the <code>Pytree.dataclass</code> declaration informs the system <em>how to instantiate</em> the class as a dataclass,
and how to automatically define JAX's <code>Pytree</code> interfaces (<code>tree_flatten</code>, <code>tree_unflatten</code>, etc.) for the dataclass, based on the fields declared in the class, and possibly <code>Pytree.static(...)</code> or <code>Pytree.field(...)</code> annotations (or lack thereof, the default is that all fields are <code>Pytree.field(...)</code>).</p>
<p>All <code>Pytree</code> dataclasses support pretty printing, as well as rendering to HTML.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pytree</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">FloatArray</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nd">@Pytree</span><span class="o">.</span><span class="n">dataclass</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Enforces type annotations on instantiation.</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">(</span><span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">my_static_field</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Pytree</span><span class="o">.</span><span class="n">static</span><span class="p">()</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">my_dynamic_field</span><span class="p">:</span> <span class="n">FloatArray</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">MyClass</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">5.0</span><span class="p">))</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_90808aad2a4f46fabb27e433951d2059" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_90808aad2a4f46fabb27e433951d2059")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_90808aad2a4f46fabb27e433951d2059")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/pytree.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="nd">@dataclass_transform</span><span class="p">(</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">frozen_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="p">)</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="k">def</span><span class="w"> </span><span class="nf">dataclass</span><span class="p">(</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">incoming</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]],</span> <span class="nb">type</span><span class="p">[</span><span class="n">R</span><span class="p">]]:</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Denote that a class (which is inheriting `Pytree`) should be treated as a dataclass, meaning it can hold data in fields which are declared as part of the class.</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    A dataclass is to be distinguished from a &quot;methods only&quot; `Pytree` class, which does not have fields, but may define methods.</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    The latter cannot be instantiated, but can be inherited from, while the former can be instantiated:</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    the `Pytree.dataclass` declaration informs the system _how to instantiate_ the class as a dataclass,</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    and how to automatically define JAX&#39;s `Pytree` interfaces (`tree_flatten`, `tree_unflatten`, etc.) for the dataclass, based on the fields declared in the class, and possibly `Pytree.static(...)` or `Pytree.field(...)` annotations (or lack thereof, the default is that all fields are `Pytree.field(...)`).</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    All `Pytree` dataclasses support pretty printing, as well as rendering to HTML.</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        from genjax import Pytree</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        from genjax.typing import FloatArray</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        import jax.numpy as jnp</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        @Pytree.dataclass</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        # Enforces type annotations on instantiation.</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        class MyClass(Pytree):</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            my_static_field: int = Pytree.static()</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            my_dynamic_field: FloatArray</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        print(MyClass(10, jnp.array(5.0)).render_html())</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        ```</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">return</span> <span class="n">pz</span><span class="o">.</span><span class="n">pytree_dataclass</span><span class="p">(</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">incoming</span><span class="p">,</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">overwrite_parent_init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Pytree.static" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">static</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.Pytree.static" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">static</span><span class="p">(</span><span class="o">**</span><span class="n"><span title="genjax.core.Pytree.static(**kwargs)">kwargs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Declare a field of a <code>Pytree</code> dataclass to be static. Users can provide additional keyword argument options,
like <code>default</code> or <code>default_factory</code>, to customize how the field is instantiated when an instance of
the dataclass is instantiated.` Fields which are provided with default values must come after required fields in the dataclass declaration.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@Pytree</span><span class="o">.</span><span class="n">dataclass</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c1"># Enforces type annotations on instantiation.</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">(</span><span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">my_dynamic_field</span><span class="p">:</span> <span class="n">FloatArray</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">my_static_field</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Pytree</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">MyClass</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">5.0</span><span class="p">))</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_220da2ab11274ad892ca6f3f88f862e7" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_220da2ab11274ad892ca6f3f88f862e7")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_220da2ab11274ad892ca6f3f88f862e7")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/pytree.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="k">def</span><span class="w"> </span><span class="nf">static</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Declare a field of a `Pytree` dataclass to be static. Users can provide additional keyword argument options,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    like `default` or `default_factory`, to customize how the field is instantiated when an instance of</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    the dataclass is instantiated.` Fields which are provided with default values must come after required fields in the dataclass declaration.</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        @Pytree.dataclass</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        # Enforces type annotations on instantiation.</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        class MyClass(Pytree):</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            my_dynamic_field: FloatArray</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            my_static_field: int = Pytree.static(default=0)</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        print(MyClass(jnp.array(5.0)).render_html())</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        ```</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">return</span> <span class="n">field</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pytree_node&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="genjax.core.Pytree.field" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">field</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#genjax.core.Pytree.field" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">field</span><span class="p">(</span><span class="o">**</span><span class="n"><span title="genjax.core.Pytree.field(**kwargs)">kwargs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Declare a field of a <code>Pytree</code> dataclass to be dynamic. Alternatively, one can leave the annotation off in the declaration.</p>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/pytree.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="k">def</span><span class="w"> </span><span class="nf">field</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="s2">&quot;Declare a field of a `Pytree` dataclass to be dynamic. Alternatively, one can leave the annotation off in the declaration.&quot;</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">return</span> <span class="n">field</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="genjax.core.Const" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.Const</span>


<a href="#genjax.core.Const" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="genjax._src.core.typing.Generic">Generic</span>[<span title="genjax._src.core.pytree.R">R</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt; (&lt;code&gt;genjax._src.core.pytree.Pytree&lt;/code&gt;)" href="#genjax.core.Pytree">Pytree</a></code></p>


        <p>JAX-compatible way to tag a value as a constant. Valid constants include Python literals, strings, essentially anything <strong>that won't hold JAX arrays</strong> inside of a computation.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Instances of <code>Const</code> can be created using a <code>Pytree</code> classmethod:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pytree</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">c</span> <span class="o">=</span> <span class="n">Pytree</span><span class="o">.</span><span class="n">const</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_0e3792b155d44b3389f6f7b1dbb2843b" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_0e3792b155d44b3389f6f7b1dbb2843b")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_0e3792b155d44b3389f6f7b1dbb2843b")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
<p>Constants can be freely used across <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.jit.html"><code>jax.jit</code></a> boundaries:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pytree</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="k">return</span> <span class="mf">10.0</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="k">return</span> <span class="mf">5.0</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">c</span> <span class="o">=</span> <span class="n">Pytree</span><span class="o">.</span><span class="n">const</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">r</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">f</span><span class="p">)(</span><span class="n">c</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></code></pre></div>
<div class="result">
10.0

</div></p>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;unwrap&lt;/span&gt; (&lt;code&gt;genjax.core.Const.unwrap&lt;/code&gt;)" href="#genjax.core.Const.unwrap">unwrap</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Unwrap a constant value from a <code>Const</code> instance.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/pytree.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="nd">@Pytree</span><span class="o">.</span><span class="n">dataclass</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="k">class</span><span class="w"> </span><span class="nc">Const</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    JAX-compatible way to tag a value as a constant. Valid constants include Python literals, strings, essentially anything **that won&#39;t hold JAX arrays** inside of a computation.</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        Instances of `Const` can be created using a `Pytree` classmethod:</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        from genjax import Pytree</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        c = Pytree.const(5)</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        print(c.render_html())</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        ```</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        Constants can be freely used across [`jax.jit`](https://jax.readthedocs.io/en/latest/_autosummary/jax.jit.html) boundaries:</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        from genjax import Pytree</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        def f(c):</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            if c.unwrap() == 5:</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">                return 10.0</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            else:</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">                return 5.0</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        c = Pytree.const(5)</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        r = jax.jit(f)(c)</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        print(r)</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        ```</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">val</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Pytree</span><span class="o">.</span><span class="n">static</span><span class="p">()</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">Callable</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="sa">f</span><span class="s2">&quot;Wrapped `val` </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="si">}</span><span class="s2"> is not Callable.&quot;</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="p">)</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unwrap</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Unwrap a constant value from a `Const` instance.</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        This method can be used as an instance method or as a static method. When used as a static method, it returns the input value unchanged if it is not a `Const` instance.</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            R: The unwrapped value if self is a `Const`, otherwise returns self unchanged.</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        Examples:</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            from genjax import Pytree, Const</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            c = Pytree.const(5)</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            val = c.unwrap()  # Returns 5</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            # Can also be used as static method</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            val = Const.unwrap(10)  # Returns 10 unchanged</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            ```</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Const</span><span class="p">):</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a>            <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="genjax.core.Const.unwrap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">unwrap</span>


<a href="#genjax.core.Const.unwrap" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">unwrap</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="genjax._src.core.pytree.R">R</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Unwrap a constant value from a <code>Const</code> instance.</p>
<p>This method can be used as an instance method or as a static method. When used as a static method, it returns the input value unchanged if it is not a <code>Const</code> instance.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>R</code></td>            <td>
                  <code><span title="genjax._src.core.pytree.R">R</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unwrapped value if self is a <code>Const</code>, otherwise returns self unchanged.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pytree</span><span class="p">,</span> <span class="n">Const</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">c</span> <span class="o">=</span> <span class="n">Pytree</span><span class="o">.</span><span class="n">const</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">val</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()</span>  <span class="c1"># Returns 5</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Can also be used as static method</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">val</span> <span class="o">=</span> <span class="n">Const</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Returns 10 unchanged</span>
</span></code></pre></div>
<div class="result">

</div>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/pytree.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="k">def</span><span class="w"> </span><span class="nf">unwrap</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Unwrap a constant value from a `Const` instance.</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    This method can be used as an instance method or as a static method. When used as a static method, it returns the input value unchanged if it is not a `Const` instance.</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        R: The unwrapped value if self is a `Const`, otherwise returns self unchanged.</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        from genjax import Pytree, Const</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        c = Pytree.const(5)</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        val = c.unwrap()  # Returns 5</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        # Can also be used as static method</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        val = Const.unwrap(10)  # Returns 10 unchanged</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        ```</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Const</span><span class="p">):</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="genjax.core.Closure" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.Closure</span>


<a href="#genjax.core.Closure" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="genjax._src.core.typing.Generic">Generic</span>[<span title="genjax._src.core.pytree.R">R</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt; (&lt;code&gt;genjax._src.core.pytree.Pytree&lt;/code&gt;)" href="#genjax.core.Pytree">Pytree</a></code></p>


        <p>JAX-compatible closure type. It's a closure <em>as a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt;" href="#genjax.core.Pytree"><code>Pytree</code></a></em> - meaning the static <em>source code</em> / <em>callable</em> is separated from dynamic data (which must be tracked by JAX).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Instances of <code>Closure</code> can be created using <code>Pytree.partial</code> -- note the order of the "closed over" arguments:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genjax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pytree</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="nd">@Pytree</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># dynamic values come first</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="c1"># v will be bound to the value of y</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="mf">5.0</span><span class="p">)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">return</span> <span class="n">f</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">clos</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">g</span><span class="p">)(</span><span class="mf">5.0</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">clos</span><span class="o">.</span><span class="n">render_html</span><span class="p">())</span>
</span></code></pre></div>
<div class="result">
<script> (()=>{ if (customElements.get('treescope-container') === undefined) { class TreescopeContainer extends HTMLElement { constructor() { super(); this.attachShadow({mode: "open"}); this.defns = {}; this.state = {}; } } customElements.define("treescope-container", TreescopeContainer); } if (customElements.get('treescope-run-here') === undefined) { class RunHere extends HTMLElement { constructor() { super() } connectedCallback() { const run = child => { const fn = new Function(child.textContent); child.textContent = ""; fn.call(this); this.remove(); }; const child = this.querySelector("script"); if (child) { run(child); } else { new MutationObserver(()=>{ run(this.querySelector("script")); }).observe(this, {childList: true}); } } } customElements.define("treescope-run-here", RunHere); } })(); </script> <treescope-container class="treescope_out_6a225a9184ae43368ac69be6c8bafe09" style="display:block"></treescope-container> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_6a225a9184ae43368ac69be6c8bafe09")) .filter((elt) => !elt.dataset.setup) )[0]; root.dataset.setup = 1; const msg = document.createElement("span"); msg.style = "color: #cccccc; font-family: monospace;"; msg.textContent = "(Loading...)"; root.state.loadingMsg = msg; root.shadowRoot.appendChild(msg); root.state.chain = new Promise((resolve, reject) => { const observer = new IntersectionObserver((entries) => { for (const entry of entries) { if (entry.isIntersecting) { resolve(); observer.disconnect(); return; } } }, {rootMargin: "1000px"}); window.setTimeout(() => { observer.observe(root); }, 0); }); root.state.deferring = false; const _insertNode = (node) => { for (let oldScript of node.querySelectorAll("script")) { let newScript = document.createElement("script"); newScript.type = oldScript.type; newScript.textContent = oldScript.textContent; oldScript.parentNode.replaceChild(newScript, oldScript); } if (root.state.loadingMsg) { root.state.loadingMsg.remove(); root.state.loadingMsg = null; } root.shadowRoot.appendChild(node); }; root.defns.insertContent = ((contentNode, compressed) => { if (compressed) { root.state.deferring = true; } if (root.state.deferring) { root.state.chain = (async () => { await root.state.chain; if (compressed) { const encoded = contentNode.textContent; const blob = new Blob([ Uint8Array.from(atob(encoded), (m) => m.codePointAt(0)) ]); const reader = blob.stream().pipeThrough( new DecompressionStream("deflate") ).pipeThrough( new TextDecoderStream("utf-8") ).getReader(); const parts = []; while (true) { const step = await reader.read(); if (step.done) { break; } parts.push(step.value); } const tpl = document.createElement('template'); tpl.innerHTML = parts.join(""); _insertNode(tpl.content); } else { _insertNode(contentNode.content); } })(); } else { _insertNode(contentNode.content); } }); </script></treescope-run-here><div style="display:none"> <script type="application/octet-stream" >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</script> <treescope-run-here><script type="application/octet-stream"> const root = ( Array.from(document.getElementsByClassName( "treescope_out_6a225a9184ae43368ac69be6c8bafe09")) .filter((elt) => !elt.dataset['step0']) )[0]; root.dataset['step0'] = 1; root.defns.insertContent( this.parentNode.querySelector('script[type="application/octet-stream"]'), true ); this.parentNode.remove(); </script></treescope-run-here> </div>

</div></p>
<p>Closures can be invoked / JIT compiled in other code:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">r</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">clos</span><span class="p">(</span><span class="n">x</span><span class="p">))(</span><span class="mf">3.0</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></code></pre></div>
<div class="result">
75.0

</div></p>











              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/pytree.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="nd">@Pytree</span><span class="o">.</span><span class="n">dataclass</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="k">class</span><span class="w"> </span><span class="nc">Closure</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    JAX-compatible closure type. It&#39;s a closure _as a [`Pytree`][genjax.core.Pytree]_ - meaning the static _source code_ / _callable_ is separated from dynamic data (which must be tracked by JAX).</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        Instances of `Closure` can be created using `Pytree.partial` -- note the order of the &quot;closed over&quot; arguments:</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        from genjax import Pytree</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        def g(y):</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            @Pytree.partial(y)  # dynamic values come first</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            def f(v, x):</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">                # v will be bound to the value of y</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">                return x * (v * 5.0)</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            return f</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        clos = jax.jit(g)(5.0)</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        print(clos.render_html())</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        ```</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        Closures can be invoked / JIT compiled in other code:</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        ```python exec=&quot;yes&quot; html=&quot;true&quot; source=&quot;material-block&quot; session=&quot;core&quot;</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        r = jax.jit(lambda x: clos(x))(3.0)</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        print(r)</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        ```</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">dyn_args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">R</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pytree</span><span class="o">.</span><span class="n">static</span><span class="p">()</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dyn_args</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h2 id="dynamism-in-jax-masks-and-sum-types">Dynamism in JAX: masks and sum types<a class="headerlink" href="#dynamism-in-jax-masks-and-sum-types" title="Permanent link">&para;</a></h2>
<p>The semantics of Gen are defined independently of any particular computational substrate or implementation - but JAX (and XLA through JAX) is a unique substrate, offering high performance, the ability to transformation code ahead-of-time via program transformations, and ... <em>a rather unique set of restrictions</em>.</p>
<h3 id="jax-is-a-two-phase-system">JAX is a two-phase system<a class="headerlink" href="#jax-is-a-two-phase-system" title="Permanent link">&para;</a></h3>
<p>While not yet formally modelled, it's appropriate to think of JAX as separating computation into two phases:</p>
<ul>
<li>The <em>statics</em> phase (which occurs at JAX tracing / transformation time).</li>
<li>The <em>runtime</em> phase (which occurs when a computation written in JAX is actually deployed via XLA and executed on a physical device somewhere in the world).</li>
</ul>
<p>JAX has different rules for handling values depending on which phase we are in.</p>
<p>For instance, JAX disallows usage of runtime values to resolve Python control flow at tracing time (intuition: we don't actually know the value yet!) and will error if the user attempts to trace through a Python program with incorrect usage of runtime values.</p>
<p>In GenJAX, we take advantage of JAX's tracing to construct code which, when traced, produces specialized code <em>depending on static information</em>. At the same time, we are careful to encode Gen's interfaces to respect JAX's rules which govern how static / runtime values can be used.</p>
<p>The most primitive way to encode <em>runtime uncertainty</em> about a piece of data is to attach a <code>bool</code> to it, which indicates whether the data is "on" or "off".</p>
<p>GenJAX contains a system for tagging data with flags, to indicate if the data is valid or invalid during inference interface computations <em>at runtime</em>. The key data structure which supports this system is <code>genjax.core.Mask</code>.</p>


<div class="doc doc-object doc-class">



<h2 id="genjax.core.Mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">genjax.core.Mask</span>


<a href="#genjax.core.Mask" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="genjax._src.core.typing.Generic">Generic</span>[<span title="genjax._src.core.generative.functional_types.R">R</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.core.Pytree&lt;/span&gt; (&lt;code&gt;genjax._src.core.pytree.Pytree&lt;/code&gt;)" href="#genjax.core.Pytree">Pytree</a></code></p>


        <p>The <code>Mask</code> datatype wraps a value in a Boolean flag which denotes whether the data is valid or invalid to use in inference computations.</p>
<p>Masks can be used in a variety of ways as part of generative computations - their primary role is to denote data which is valid under inference computations. Valid data can be used as <code>ChoiceMap</code> leaves, and participate in generative and inference computations (like scores, and importance weights or density ratios). A Mask with a False flag <strong>should</strong> be considered unusable, and should be handled with care.</p>
<p>If a <code>flag</code> has a non-scalar shape, that implies that the mask is vectorized, and that the <code>ArrayLike</code> value, or each leaf in the pytree, must have the flag's shape as its prefix (i.e., must have been created with a <code>jax.vmap</code> call or via a GenJAX <code>vmap</code> combinator).</p>
<h4 id="genjax.core.Mask--encountering-mask-in-your-computation">Encountering <code>Mask</code> in your computation<a class="headerlink" href="#genjax.core.Mask--encountering-mask-in-your-computation" title="Permanent link">&para;</a></h4>
<p>When users see <code>Mask</code> in their computations, they are expected to interact with them by either:</p>
<ul>
<li>
<p>Unmasking them using the <code>Mask.unmask</code> interface, a potentially unsafe operation.</p>
</li>
<li>
<p>Destructuring them manually, and handling the cases.</p>
</li>
</ul>
<h4 id="genjax.core.Mask--usage-of-invalid-data">Usage of invalid data<a class="headerlink" href="#genjax.core.Mask--usage-of-invalid-data" title="Permanent link">&para;</a></h4>
<p>If you use invalid <code>Mask(data, False)</code> data in inference computations, you may encounter silently incorrect results.</p>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;unmask&lt;/span&gt; (&lt;code&gt;genjax.core.Mask.unmask&lt;/code&gt;)" href="#genjax.core.Mask.unmask">unmask</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Unmask the <code>Mask</code>, returning the value within.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>src/genjax/_src/core/generative/functional_types.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="nd">@Pytree</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">match_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="k">class</span><span class="w"> </span><span class="nc">Mask</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">Pytree</span><span class="p">):</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The `Mask` datatype wraps a value in a Boolean flag which denotes whether the data is valid or invalid to use in inference computations.</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Masks can be used in a variety of ways as part of generative computations - their primary role is to denote data which is valid under inference computations. Valid data can be used as `ChoiceMap` leaves, and participate in generative and inference computations (like scores, and importance weights or density ratios). A Mask with a False flag **should** be considered unusable, and should be handled with care.</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    If a `flag` has a non-scalar shape, that implies that the mask is vectorized, and that the `ArrayLike` value, or each leaf in the pytree, must have the flag&#39;s shape as its prefix (i.e., must have been created with a `jax.vmap` call or via a GenJAX `vmap` combinator).</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    ## Encountering `Mask` in your computation</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    When users see `Mask` in their computations, they are expected to interact with them by either:</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    * Unmasking them using the `Mask.unmask` interface, a potentially unsafe operation.</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    * Destructuring them manually, and handling the cases.</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    ## Usage of invalid data</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    If you use invalid `Mask(data, False)` data in inference computations, you may encounter silently incorrect results.</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">value</span><span class="p">:</span> <span class="n">R</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">flag</span><span class="p">:</span> <span class="n">Flag</span> <span class="o">|</span> <span class="n">Diff</span><span class="p">[</span><span class="n">Flag</span><span class="p">]</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="c1">################</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="c1"># Constructors #</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="c1">################</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">Flag</span> <span class="o">|</span> <span class="n">Diff</span><span class="p">[</span><span class="n">Flag</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Mask</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="sa">f</span><span class="s2">&quot;Mask should not be instantiated with another Mask! found </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="p">)</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">Mask</span><span class="o">.</span><span class="n">_validate_init</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span> <span class="n">flag</span>  <span class="c1"># pyright: ignore[reportAttributeAccessIssue]</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_init</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">Flag</span> <span class="o">|</span> <span class="n">Diff</span><span class="p">[</span><span class="n">Flag</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates that non-scalar flags are only used with vectorized masks.</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        When a flag has a non-scalar shape (e.g. shape (3,)), this indicates the mask is vectorized.</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        In this case, each leaf value in the pytree must have the flag&#39;s shape as a prefix of its own shape.</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        For example, if flag has shape (3,), then array leaves must have shapes like (3,), (3,4), (3,2,1) etc.</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        This ensures that vectorized flags properly align with vectorized data.</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        Args:</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            value: The value to be masked, can be a pytree</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            flag: The flag to apply, either a scalar or array flag</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        Raises:</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            ValueError: If a non-scalar flag&#39;s shape is not a prefix of all leaf value shapes</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">get_primal</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">Diff</span><span class="p">)</span> <span class="k">else</span> <span class="n">flag</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="n">f_shape</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">if</span> <span class="n">f_shape</span> <span class="o">==</span> <span class="p">():</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">leaf_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span> <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_leaves</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">prefix_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_shape</span><span class="p">)</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">leaf_shapes</span><span class="p">:</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="k">if</span> <span class="n">shape</span><span class="p">[:</span><span class="n">prefix_len</span><span class="p">]</span> <span class="o">!=</span> <span class="n">f_shape</span><span class="p">:</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>                    <span class="sa">f</span><span class="s2">&quot;Vectorized flag </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&#39;s shape </span><span class="si">{</span><span class="n">f_shape</span><span class="si">}</span><span class="s2"> must be a prefix of all leaf shapes. Found </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="p">)</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_leaf_shapes</span><span class="p">(</span><span class="n">this</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">R</span><span class="p">):</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates that two values have matching shapes at each leaf.</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        Used by __or__, __xor__ etc. to ensure we only combine masks with values whose leaves have matching shapes.</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        Broadcasting is not supported - array shapes must match exactly.</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        Args:</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            this: First value to compare</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            other: Second value to compare</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        Raises:</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            ValueError: If any leaf shapes don&#39;t match exactly</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="c1"># Check array shapes match exactly (no broadcasting)</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">check_leaf_shapes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="n">x_shape</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="n">y_shape</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="k">if</span> <span class="n">x_shape</span> <span class="o">!=</span> <span class="n">y_shape</span><span class="p">:</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>                    <span class="sa">f</span><span class="s2">&quot;Cannot combine masks with different array shapes: </span><span class="si">{</span><span class="n">x_shape</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">y_shape</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>                <span class="p">)</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">jtu</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">check_leaf_shapes</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_mask_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Used by __or__, __xor__ etc. to ensure we only combine masks with matching pytree shape and matching leaf shapes.&quot;&quot;&quot;</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">if</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_structure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_structure</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot combine masks with different tree structures!&quot;</span><span class="p">)</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">Mask</span><span class="o">.</span><span class="n">_validate_leaf_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="s2">&quot;R | Mask[R]&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Flag</span> <span class="o">|</span> <span class="n">Diff</span><span class="p">[</span><span class="n">Flag</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        Create a Mask instance, potentially from an existing Mask or a raw value.</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        This method allows for the creation of a new Mask or the modification of an existing one. If the input is already a Mask, it combines the new flag with the existing one using a logical AND operation.</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        Args:</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            v: The value to be masked. Can be a raw value or an existing Mask.</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            f: The flag to be applied to the value.</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            A new Mask instance with the given value and flag.</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        Note:</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            If `v` is already a Mask, the new flag is combined with the existing one using a logical AND, ensuring that the resulting Mask is only valid if both input flags are valid.</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">match</span> <span class="n">v</span><span class="p">:</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="k">case</span> <span class="n">Mask</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Diff</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Diff</span><span class="p">)</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="k">assert</span> <span class="n">FlagOp</span><span class="o">.</span><span class="n">is_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span> <span class="p">(</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>                    <span class="sa">f</span><span class="s2">&quot;Can&#39;t build a Mask with non-matching Flag shapes </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="p">)</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="k">return</span> <span class="n">Mask</span><span class="p">[</span><span class="n">R</span><span class="p">](</span><span class="n">value</span><span class="p">,</span> <span class="n">FlagOp</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="k">return</span> <span class="n">Mask</span><span class="p">[</span><span class="n">R</span><span class="p">](</span><span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">maybe_mask</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="s2">&quot;R | Mask[R]&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Flag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;R | Mask[R] | None&quot;</span><span class="p">:</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        Create a Mask instance or return the original value based on the flag.</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        This method is similar to `build`, but it handles concrete flag values differently. For concrete True flags, it returns the original value without wrapping it in a Mask. For concrete False flags, it returns None. For non-concrete flags, it creates a new Mask instance.</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        Args:</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            v: The value to be potentially masked. Can be a raw value or an existing Mask.</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            f: The flag to be applied to the value.</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            - The original value `v` if `f` is concretely True.</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            - None if `f` is concretely False.</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            - A new Mask instance with the given value and flag if `f` is not concrete.</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="k">return</span> <span class="n">Mask</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="c1">#############</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="c1"># Accessors #</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="c1">#############</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">path</span><span class="p">,)</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">()</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="c1"># A non-scalar flag must have been produced via vectorization. Because a scalar flag can</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="c1"># wrap a non-scalar value, only use the vectorized components of the path to index into the flag...</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">path</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">)]]</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="c1"># but the use full path to index into the value.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">v_idx</span> <span class="o">=</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">path</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="c1"># Reconstruct Diff if needed</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flag</span><span class="p">,</span> <span class="n">Diff</span><span class="p">):</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">Diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span><span class="o">.</span><span class="n">tangent</span><span class="p">)</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">return</span> <span class="n">Mask</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">v_idx</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;R | Mask[R] | None&quot;</span><span class="p">:</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        Flatten a Mask instance into its underlying value or None.</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        &quot;Flattening&quot; occurs when the flag value is a concrete Boolean (True/False). In these cases, the Mask is simplified to either its raw value or None. If the flag is not concrete (i.e., a symbolic/traced value), the Mask remains intact.</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        This method evaluates the mask&#39;s flag and returns:</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        - None if the flag is concretely False or the value is None</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        - The raw value if the flag is concretely True</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        - The Mask instance itself if the flag is not concrete</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            The flattened result based on the mask&#39;s flag state.</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">()</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">if</span> <span class="n">FlagOp</span><span class="o">.</span><span class="n">concrete_false</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">elif</span> <span class="n">FlagOp</span><span class="o">.</span><span class="n">concrete_true</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unmask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">R</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        Unmask the `Mask`, returning the value within.</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        This operation is inherently unsafe with respect to inference semantics if no default value is provided. It is only valid if the `Mask` wraps valid data at runtime, or if a default value is supplied.</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        Args:</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            default: An optional default value to return if the mask is invalid.</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            The unmasked value if valid, or the default value if provided and the mask is invalid.</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">_check</span><span class="p">():</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>                <span class="n">checkify</span><span class="o">.</span><span class="n">check</span><span class="p">(</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>                    <span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">()),</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>                    <span class="s2">&quot;Attempted to unmask when a mask flag (or some flag in a vectorized mask) is False: the unmasked value is invalid.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>                <span class="p">)</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="n">optional_check</span><span class="p">(</span><span class="n">_check</span><span class="p">)</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">(</span><span class="n">true_v</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">false_v</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>                <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">(),</span> <span class="n">true_v</span><span class="p">,</span> <span class="n">false_v</span><span class="p">)</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="k">return</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">inner</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">primal_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Flag</span><span class="p">:</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        Returns the primal flag of the mask.</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        This method retrieves the primal (non-`Diff`-wrapped) flag value. If the flag</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        is a Diff type (which contains both primal and tangent components), it returns</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        the primal component. Otherwise, it returns the flag as is.</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            The primal flag value.</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span><span class="p">:</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="k">case</span><span class="w"> </span><span class="n">Diff</span><span class="p">(</span><span class="n">primal</span><span class="p">,</span> <span class="k">_</span><span class="p">):</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>                <span class="k">return</span> <span class="n">primal</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="k">case</span> <span class="n">flag</span><span class="p">:</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a>                <span class="k">return</span> <span class="n">flag</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="c1">###############</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="c1"># Combinators #</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="c1">###############</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_or_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">:</span> <span class="n">Flag</span><span class="p">,</span> <span class="n">second</span><span class="p">:</span> <span class="n">Flag</span><span class="p">):</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a pair of flag arrays into an array of indices for selecting between two values.</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        This function implements a truth table for selecting between two values based on their flags:</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        first | second | output | meaning</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        ------+--------+--------+------------------</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            0   |   0    |   -1   | neither valid</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">            1   |   0    |    0   | first valid only</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            0   |   1    |    1   | second valid only</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            1   |   1    |    0   | both valid for OR, invalid for XOR</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        The output index is used to select between the corresponding values:</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">           0 -&gt; select first value</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">           1 -&gt; select second value</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        Args:</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            first: The flag for the first value</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            second: The flag for the second value</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            An Array of indices (-1, 0, or 1) indicating which value to select from each side.</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="c1"># Note that the validation has already run to check that these flags have the same shape.</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="k">return</span> <span class="n">first</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">FlagOp</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">FlagOp</span><span class="o">.</span><span class="n">not_</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">second</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_mask_shapes</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">():</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="k">case</span><span class="w"> </span><span class="kc">True</span><span class="p">,</span> <span class="k">_</span><span class="p">:</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="k">case</span><span class="w"> </span><span class="kc">False</span><span class="p">,</span> <span class="k">_</span><span class="p">:</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a>                <span class="k">return</span> <span class="n">other</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="k">case</span> <span class="n">self_flag</span><span class="p">,</span> <span class="n">other_flag</span><span class="p">:</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>                <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_or_idx</span><span class="p">(</span><span class="n">self_flag</span><span class="p">,</span> <span class="n">other_flag</span><span class="p">)</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a>                <span class="k">return</span> <span class="n">tree_choose</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_mask_shapes</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">():</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>            <span class="k">case</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>                <span class="k">return</span> <span class="n">Mask</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="k">case</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">case</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>                <span class="k">return</span> <span class="n">other</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="k">case</span> <span class="n">self_flag</span><span class="p">,</span> <span class="n">other_flag</span><span class="p">:</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>                <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_or_idx</span><span class="p">(</span><span class="n">self_flag</span><span class="p">,</span> <span class="n">other_flag</span><span class="p">)</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>                <span class="c1"># note that `idx` above will choose the correct side for the FF, FT and TF cases,</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>                <span class="c1"># but will equal 0 for TT flags. We use `FlagOp.xor_` to override this flag to equal</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>                <span class="c1"># False, since neither side in the TT case will provide a `False` flag for us.</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>                <span class="n">chosen</span> <span class="o">=</span> <span class="n">tree_choose</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">])</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="k">return</span> <span class="n">Mask</span><span class="p">(</span><span class="n">chosen</span><span class="p">,</span> <span class="n">FlagOp</span><span class="o">.</span><span class="n">xor_</span><span class="p">(</span><span class="n">self_flag</span><span class="p">,</span> <span class="n">other_flag</span><span class="p">))</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="n">not_flag</span> <span class="o">=</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">FlagOp</span><span class="o">.</span><span class="n">not_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span><span class="p">)</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="k">return</span> <span class="n">Mask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">not_flag</span><span class="p">)</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">or_n</span><span class="p">(</span><span class="n">mask</span><span class="p">:</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">masks</span><span class="p">:</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs an n-ary OR operation on a sequence of Mask objects.</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        Args:</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">            mask: The first mask to combine</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">            *masks: Variable number of additional masks to combine with OR</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            A new Mask combining all inputs with OR operations</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">|</span> <span class="n">b</span><span class="p">,</span> <span class="n">masks</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="nd">@staticmethod</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">xor_n</span><span class="p">(</span><span class="n">mask</span><span class="p">:</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">masks</span><span class="p">:</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Mask[R]&quot;</span><span class="p">:</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs an n-ary XOR operation on a sequence of Mask objects.</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        Args:</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            mask: The first mask to combine</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            *masks: Variable number of additional masks to combine with XOR</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            A new Mask combining all inputs with XOR operations</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">^</span> <span class="n">b</span><span class="p">,</span> <span class="n">masks</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="genjax.core.Mask.unmask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">unmask</span>


<a href="#genjax.core.Mask.unmask" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">unmask</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code&gt;default&lt;/code&gt; (&lt;code&gt;genjax.core.Mask.unmask(default)&lt;/code&gt;)" href="#genjax.core.Mask.unmask(default)">default</a></span><span class="p">:</span> <span class="n"><span title="genjax._src.core.generative.functional_types.R">R</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="genjax._src.core.generative.functional_types.R">R</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Unmask the <code>Mask</code>, returning the value within.</p>
<p>This operation is inherently unsafe with respect to inference semantics if no default value is provided. It is only valid if the <code>Mask</code> wraps valid data at runtime, or if a default value is supplied.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="genjax.core.Mask.unmask(default)" class="doc doc-heading doc-heading-parameter">                  <code>default</code>
<a href="#genjax.core.Mask.unmask(default)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="genjax._src.core.generative.functional_types.R">R</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional default value to return if the mask is invalid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="genjax._src.core.generative.functional_types.R">R</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unmasked value if valid, or the default value if provided and the mask is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/genjax/_src/core/generative/functional_types.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="k">def</span><span class="w"> </span><span class="nf">unmask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">R</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Unmask the `Mask`, returning the value within.</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    This operation is inherently unsafe with respect to inference semantics if no default value is provided. It is only valid if the `Mask` wraps valid data at runtime, or if a default value is supplied.</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Args:</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        default: An optional default value to return if the mask is invalid.</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        The unmasked value if valid, or the default value if provided and the mask is invalid.</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_check</span><span class="p">():</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="n">checkify</span><span class="o">.</span><span class="n">check</span><span class="p">(</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">()),</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>                <span class="s2">&quot;Attempted to unmask when a mask flag (or some flag in a vectorized mask) is False: the unmasked value is invalid.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="p">)</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">optional_check</span><span class="p">(</span><span class="n">_check</span><span class="p">)</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">(</span><span class="n">true_v</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">false_v</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primal_flag</span><span class="p">(),</span> <span class="n">true_v</span><span class="p">,</span> <span class="n">false_v</span><span class="p">)</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="k">return</span> <span class="n">jtu</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="n">inner</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="static-typing-with-genjaxtyping-aka-beartype">Static typing with <code>genjax.typing</code> a.k.a 🐻<code>beartype</code>🐻<a class="headerlink" href="#static-typing-with-genjaxtyping-aka-beartype" title="Permanent link">&para;</a></h2>
<p>GenJAX uses <a href="https://github.com/beartype/beartype"><code>beartype</code></a> to perform type checking <em>during JAX tracing / compile time</em>. This means that <code>beartype</code>, normally a fast <em>runtime</em> type checker, operates <em>at JAX tracing time</em> to ensure that the arguments and return values are correct, with zero runtime cost.</p>
<h3 id="generative-interface-types">Generative interface types<a class="headerlink" href="#generative-interface-types" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-attribute">



<h2 id="genjax.core.Arguments" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">genjax.core.Arguments</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#genjax.core.Arguments" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">Arguments</span> <span class="o">=</span> <span class="n"><span title="tuple">tuple</span></span>
</span></code></pre></div>

    <div class="doc doc-contents first">

        <p><code>Arguments</code> is the type of argument values to generative functions. It is a type alias for <code>Tuple</code>, and is used to improve readability and parsing of interface specifications.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="genjax.core.Score" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">genjax.core.Score</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#genjax.core.Score" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">Score</span> <span class="o">=</span> <span class="n"><span title="genjax._src.core.typing.FloatArray">FloatArray</span></span>
</span></code></pre></div>

    <div class="doc doc-contents first">

        <p>A <em>score</em> is a density ratio, described fully in <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;simulate&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.simulate"><code>simulate</code></a>.</p>
<p>The type <code>Score</code> does not enforce any meaningful mathematical invariants, but is used to denote the type of scores in the GenJAX system, to improve readability and parsing of interface specifications.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="genjax.core.Weight" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">genjax.core.Weight</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#genjax.core.Weight" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">Weight</span> <span class="o">=</span> <span class="n"><span title="genjax._src.core.typing.FloatArray">FloatArray</span></span>
</span></code></pre></div>

    <div class="doc doc-contents first">

        <p>A <em>weight</em> is a density ratio which often occurs in the context of proper weighting for <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;genjax.inference.Target&lt;/span&gt;" href="inference.html#genjax.inference.Target"><code>Target</code></a> distributions, or in Gen's <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a> interface, whose mathematical content is described in <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a>.</p>
<p>The type <code>Weight</code> does not enforce any meaningful mathematical invariants, but is used to denote the type of weights in GenJAX, to improve readability and parsing of interface specifications / expectations.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="genjax.core.Retdiff" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">genjax.core.Retdiff</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#genjax.core.Retdiff" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">Retdiff</span> <span class="o">=</span> <span class="n"><span title="genjax._src.core.typing.Annotated">Annotated</span></span><span class="p">[</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="genjax._src.core.generative.concepts.R">R</span></span><span class="p">,</span> <span class="n"><span title="genjax._src.core.typing.Is">Is</span></span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n"><span title="genjax._src.core.compiler.interpreters.incremental.Diff.static_check_tree_diff">static_check_tree_diff</span></span><span class="p">(</span><span class="n"><span title="x">x</span></span><span class="p">)]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents first">

        <p><code>Retdiff</code> is the type of return values with an attached <code>ChangeType</code> (c.f. <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a>).</p>
<p>When used under type checking, <code>Retdiff</code> assumes that the return value is a <code>Pytree</code> (either, defined via GenJAX's <code>Pytree</code> interface or registered with JAX's system). It checks that <em>the leaves</em> are <code>Diff</code> type with attached <code>ChangeType</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="genjax.core.Argdiffs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">genjax.core.Argdiffs</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#genjax.core.Argdiffs" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">Argdiffs</span> <span class="o">=</span> <span class="n"><span title="genjax._src.core.typing.Annotated">Annotated</span></span><span class="p">[</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="genjax._src.core.typing.Any">Any</span></span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><span title="genjax._src.core.typing.Is">Is</span></span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n"><span title="genjax._src.core.compiler.interpreters.incremental.Diff.static_check_tree_diff">static_check_tree_diff</span></span><span class="p">(</span><span class="n"><span title="x">x</span></span><span class="p">)],</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents first">

        <p><code>Argdiffs</code> is the type of argument values with an attached <code>ChangeType</code> (c.f. <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;edit&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-abstractmethod&quot;&gt;&lt;code&gt;abstractmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#genjax.core.GenerativeFunction.edit"><code>edit</code></a>).</p>
<p>When used under type checking, <code>Retdiff</code> assumes that the argument values are <code>Pytree</code> (either, defined via GenJAX's <code>Pytree</code> interface or registered with JAX's system). For each argument, it checks that <em>the leaves</em> are <code>Diff</code> type with attached <code>ChangeType</code>.</p>

    </div>

</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="May 29, 2025 12:56:58 UTC">May 29, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="May 29, 2025 12:56:58 UTC">May 29, 2025</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../cookbook/inactive/library_author/dimap_combinator.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Dimap combinator">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Dimap combinator
              </div>
            </div>
          </a>
        
        
          
          <a href="generative_functions.html" class="md-footer__link md-footer__link--next" aria-label="Next: Generative functions">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Generative functions
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 MIT Probabilistic Computing Project
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["optimize", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "content.tabs.link", "navigation.footer", "navigation.expand", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.path", "navigation.prune", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>